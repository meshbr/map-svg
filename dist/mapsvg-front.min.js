var MapSVG=function(){};!function(t){MapSVG.templatesLoaded={},"undefined"!=typeof mapsvg_paths?MapSVG.urls=mapsvg_paths:MapSVG.urls={},MapSVG.instances=[],MapSVG.userAgent=navigator.userAgent.toLowerCase(),MapSVG.touchDevice="ontouchstart"in window||0<navigator.MaxTouchPoints||0<navigator.msMaxTouchPoints,MapSVG.ios=-1<MapSVG.userAgent.indexOf("ipad")||-1<MapSVG.userAgent.indexOf("iphone")||-1<MapSVG.userAgent.indexOf("ipod"),MapSVG.android=MapSVG.userAgent.indexOf("android"),MapSVG.isPhone=window.matchMedia("only screen and (max-width: 812px)").matches,MapSVG.browser={},MapSVG.browser.ie=(-1<MapSVG.userAgent.indexOf("msie")||-1<MapSVG.userAgent.indexOf("trident")||-1<MapSVG.userAgent.indexOf("edge"))&&{},MapSVG.browser.firefox=-1<MapSVG.userAgent.indexOf("firefox");var e=window.navigator.userAgent;MapSVG.device={},MapSVG.device.ios=!!e.match(/iPad/i)||!!e.match(/iPhone/i),MapSVG.device.android=!!e.match(/Android/i),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),MapSVG.mouseCoords=function(e){return e.clientX?{x:e.clientX+t(document).scrollLeft(),y:e.clientY+t(document).scrollTop()}:e.pageX?{x:e.pageX,y:e.pageY}:MapSVG.touchDevice?(e=e.originalEvent||e).touches&&e.touches[0]?{x:e.touches[0].pageX,y:e.touches[0].pageY}:{x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY}:void 0},MapSVG.addInstance=function(e){MapSVG.instances.push(e)},MapSVG.get=function(e){return MapSVG.instances[e]},MapSVG.getById=function(t){var e=MapSVG.instances.filter(function(e){return e.id==t});if(0<e.length)return e[0]},MapSVG.getByContainerId=function(t){var e=MapSVG.instances.filter(function(e){return e.$map.attr("id")==t});if(0<e.length)return e[0]},MapSVG.extend=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},MapSVG.ucfirst=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},MapSVG.parseBoolean=function(e){switch(String(e).toLowerCase()){case"on":case"true":case"1":case"yes":case"y":return!0;case"off":case"false":case"0":case"no":case"n":return!1;default:return}},MapSVG.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},MapSVG.safeURL=function(e){return(e=0==e.indexOf("http://")||0==e.indexOf("https://")?"//"+e.split("://").pop():e).replace(/^.*\/\/[^\/]+/,"")},MapSVG.convertToText=function(e){var t,o,i=[];if(null===e)return null;if(void 0===e)return'""';if("object"==typeof e&&null==e.join){for(o in e)e.hasOwnProperty(o)&&(t='"'+o.replace(/\"/g,'\\"')+'"',i.push(t+": "+MapSVG.convertToText(e[o])));return"{"+i.join(",")+"}"}if("object"!=typeof e||null==e.join)return"function"==typeof e?e.toString().replace("function anonymous","function"):JSON.stringify(e);for(o in e)i.push(MapSVG.convertToText(e[o]));return"["+i.join(",")+"]"},"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),Math.hypot=Math.hypot||function(){for(var e=0,t=arguments.length,o=0;o<t;o++){if(arguments[o]===1/0||arguments[o]===-1/0)return 1/0;e+=arguments[o]*arguments[o]}return Math.sqrt(e)},SVGElement.prototype.getTransformToElement=SVGElement.prototype.getTransformToElement||function(e){return e.getScreenCTM().inverse().multiply(this.getScreenCTM())},Object.values||(Object.values=function(t){return Object.keys(t).map(function(e){return t[e]})})}(jQuery),function(t){MapSVG.Controller=function(e){if(this.container=e.container,this.mapsvg=e.mapsvg,this.template=e.template,this.scrollable=void 0===e.scrollable||e.scrollable,this.withToolbar=void 0===e.withToolbar||e.withToolbar,this.autoresize=MapSVG.parseBoolean(e.autoresize),this.templates={toolbar:Handlebars.compile(this.getToolbarTemplate()),main:this.getMainTemplate()},this.data=e.data,this.width=e.width,this.color=e.color,this.events={},e.events)for(var t in e.events)"function"==typeof e.events[t]&&(this.events[t]=e.events[t]);this._init()},MapSVG.Controller.prototype.viewDidLoad=function(){this.updateScroll(),this.autoresize&&(this.adjustHeight(),this.resizeSensor.setScroll())},MapSVG.Controller.prototype.viewDidAppear=function(){},MapSVG.Controller.prototype._viewDidLoad=function(){this.updateScroll()},MapSVG.Controller.prototype.viewDidDisappear=function(){},MapSVG.Controller.prototype.updateScroll=function(){var e;this.scrollable&&((e=this).contentWrap.nanoScroller({preventPageScrolling:!0,iOSNativeScrolling:!0}),setTimeout(function(){e.contentWrap.nanoScroller({preventPageScrolling:!0,iOSNativeScrolling:!0})},300))},MapSVG.Controller.prototype.adjustHeight=function(){var e=this;e.container.height(e.container.find(".mapsvg-auto-height").outerHeight()+(e.toolbarView?e.toolbarView.outerHeight():0))},MapSVG.Controller.prototype._init=function(){this.render(),this.init()},MapSVG.Controller.prototype.init=function(){},MapSVG.Controller.prototype.getToolbarTemplate=function(){return""},MapSVG.Controller.prototype.getMainTemplate=function(){return this.template},MapSVG.Controller.prototype.render=function(){var e=this;this.view=t("<div />").attr("id","mapsvg-controller-"+this.name).addClass("mapsvg-controller-view"),this.contentWrap=t("<div />").addClass("mapsvg-controller-view-wrap"),this.contentWrap2=t("<div />"),this.contentSizer=t("<div />").addClass("mapsvg-auto-height"),this.contentView=t("<div />").addClass("mapsvg-controller-view-content"),this.contentSizer.append(this.contentView),this.scrollable&&(this.contentWrap.addClass("nano"),this.contentWrap2.addClass("nano-content")),this.contentWrap.append(this.contentWrap2),this.contentWrap2.append(this.contentSizer),this.withToolbar&&this.templates.toolbar&&(this.toolbarView=t("<div />").addClass("mapsvg-controller-view-toolbar"),this.view.append(this.toolbarView)),this.view.append(this.contentWrap),this.container.append(this.view),this.container.data("controller",this),this.width&&this.view.css({width:this.width}),this.color&&this.view.css({"background-color":this.color}),e.viewReadyToFill(),this.redraw(),setTimeout(function(){e._viewDidLoad(),e.viewDidLoad(),e.setEventHandlersCommon(),e.setEventHandlers()},1)},MapSVG.Controller.prototype.viewReadyToFill=function(){var e=this;e.autoresize&&(e.resizeSensor=new MapSVG.ResizeSensor(this.contentSizer[0],function(){e.adjustHeight(),e.updateScroll(),e.events.resize&&e.events.resize.call(e,e.mapsvg)}))},MapSVG.Controller.prototype.redraw=function(e){void 0!==e&&(this.data=e);try{this.contentView.html(this.templates.main(this.data))}catch(e){console.error(e),this.contentView.html("")}this.withToolbar&&this.templates.toolbar&&this.toolbarView.html(this.templates.toolbar(this.data)),this.updateTopShift(),this.noPadding&&this.contentView.css({padding:0}),this.updateScroll()},MapSVG.Controller.prototype.updateTopShift=function(){var e=this;this.withToolbar&&(e.contentWrap.css({top:e.toolbarView.outerHeight(!0)+"px"}),setTimeout(function(){e.contentWrap.css({top:e.toolbarView.outerHeight(!0)+"px"})},100),setTimeout(function(){e.contentWrap.css({top:e.toolbarView.outerHeight(!0)+"px"})},200),setTimeout(function(){e.contentWrap.css({top:e.toolbarView.outerHeight(!0)+"px"}),e.updateScroll()},500))},MapSVG.Controller.prototype.setEventHandlersCommon=function(){},MapSVG.Controller.prototype.setEventHandlers=function(){},MapSVG.Controller.prototype.destroy=function(){delete this.resizeSensor,this.view.empty().remove()}}(jQuery),function(c){MapSVG.DatabaseService=function(e,t){var o=this;this.mapsvg=t,this.map_id=e.map_id,this.table=e.table,this.perpage=parseInt(e.perpage)||0,this.sortBy=e.sortBy||null,this.sortDir=e.sortDir||null,this.type=e.type||"mysql",this.loaded=!1,"local"==this.type&&(this.dbObject=e.dbObject),this.server="mysql"==this.type?new MapSVG.ServerMySQL({map_id:this.map_id,table:this.table,perpage:this.perpage,mapsvg:this.mapsvg}):new MapSVG.ServerLocal({storage:this.dbObject}),this.lastChangeTime=Date.now(),this.cols=[],this.schemaDict={},this.index={},this.page=1,this.query=new MapSVG.DatabaseQuery,this.query.set({sort:[{field:this.sortBy,order:this.sortDir}],perpage:this.perpage}),this.events={create:[],update:[],change:[],schemaChange:[],dataLoaded:[],beforeLoad:[]},this.schema=new MapSVG.DatabaseSchema(e,t),this.schema.on("change",function(){o.getAll(),o.trigger("schemaChange")})},MapSVG.DatabaseService.setQuery=function(e){},MapSVG.DatabaseService.prototype.setPerpage=function(e){this.server.perpage=e},MapSVG.DatabaseService.prototype.lastChangeTime=function(){return this.lastChangeTime},MapSVG.DatabaseService.prototype.onFirstPage=function(){return 1===this.query.page},MapSVG.DatabaseService.prototype.onLastPage=function(){return!1===this.server.hasMoreRecords},MapSVG.DatabaseService.prototype.import=function(e,t){var o=this,i=o.getSchemaFieldByType("location"),s="en";return i&&i.language&&(s=i.language),e=this.formatCSV(e),this.server.import(e,s,t).done(function(){o.getAll()})},MapSVG.DatabaseService.prototype.create=function(e){var t=this;return this.server.create(e).done(function(){t.trigger("create",e),t.trigger("change",e)})},MapSVG.DatabaseService.prototype.update=function(e){var t=this;return this.server.update(e).done(function(){t.trigger("update",e),t.trigger("change",e)})},MapSVG.DatabaseService.prototype.delete=function(e){var t=this;return this.server.delete(e).done(function(){t.trigger("delete",e),t.trigger("change",e)})},MapSVG.DatabaseService.prototype.clear=function(e){var t=this;return this.server.clear().done(function(){t.getAll(),t.trigger("delete"),t.trigger("change")})},MapSVG.DatabaseService.prototype.getLoadedObject=function(e){return this.server.getLoadedObject(e)},MapSVG.DatabaseService.prototype.getAll=function(e){var t=this;if(t.trigger("beforeLoad",e),this.mapsvg.options.database.noFiltersNoLoad&&0===Object.keys(t.query.filters).length){defer=c.Deferred();var o=this.rows;return defer.promise(),defer.resolve(o),t.server.fill({objects:[]}),t.trigger("dataLoaded"),defer}"object"==typeof e&&Object.keys(e).length&&!e.page&&(t.query.page=1),t.query.set(e),this.page=e&&e.page?parseInt(e.page):this.page;e=t.query.get();return this.schema.loaded()||(e.with_schema=!0),this.mapsvg.editMode&&void 0!==e.filterout&&delete e.filterout,this.server.get(e).done(function(e){!t.schema.loaded()&&e.schema&&t.schema.set(e.schema),t.loaded=!0,t.trigger("dataLoaded")})},MapSVG.DatabaseService.prototype.fill=function(e){this.server.fill(e),!this.schema.loaded()&&e.schema&&this.schema.set(e.schema),this.loaded=!0,this.trigger("dataLoaded")},MapSVG.DatabaseService.prototype.getLoaded=function(){return this.server.rows},MapSVG.DatabaseService.prototype.formatData=function(e){return e},MapSVG.DatabaseService.prototype.formatCSV=function(r){var l=this;return r.forEach(function(e,t){var o,i={};for(o in e){var s,a=l.schema.getField(o);if(void 0!==(a="post"===o?{type:"post"}:a))switch(a.type){case"region":i[o]=e[o].split(",").map(function(e){return e.trim()}).filter(function(t){return void 0!==l.mapsvg.getRegion(t)||void 0!==l.mapsvg.regions.find(function(e){return e.title===t})}).map(function(t){var e=l.mapsvg.getRegion(t);return{id:(e=void 0===e?l.mapsvg.regions.find(function(e){return e.title===t}):e).id,title:e.title}});break;case"location":var n;e[o].match(/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)$/g)?2==(n=e[o].split(",").map(function(e){return parseFloat(e)})).length&&-90<n[0]&&n[0]<90&&-180<n[1]&&n[1]<180?i[o]={lat:n[0],lng:n[1]}:i[o]="":e[o]&&(i[o]={address:e[o]}),"object"==typeof i[o]&&(i[o].img=l.mapsvg.getData().options.defaultMarkerImage);break;case"select":(a=l.schema.getField(o)).multiselect?(s=l.schema.getField(o).options.map(function(e){return e.label}),i[o]=e[o].split(",").map(function(e){return e.trim()}).filter(function(e){return-1!==s.indexOf(e)}).map(function(t){return l.schema.getField(o).options.filter(function(e){return e.label==t})[0]})):i[o]=e[o];break;case"radio":case"text":case"textarea":case"status":default:i[o]=e[o]}}r[t]=i}),r},MapSVG.DatabaseService.prototype.on=function(e,t){this.lastChangeTime=Date.now(),this.events[e]||(this.events[e]=[]),this.events[e].push(t)},MapSVG.DatabaseService.prototype.trigger=function(e,t){this.events[e]&&this.events[e].length&&this.events[e].forEach(function(e){e&&e(t)})},MapSVG.DatabaseService.prototype.onSchemaChange=function(e){this.onSchemaChangeCallbacks.push(e)},MapSVG.DatabaseService.prototype.getSchema=function(e){return this.schema.get(e)},MapSVG.DatabaseService.prototype.getSchemaField=function(e){return this.schema.getField(e)},MapSVG.DatabaseService.prototype.getSchemaFieldByType=function(e){return this.schema.getFieldByType(e)},MapSVG.DatabaseService.prototype.setSchema=function(e){return this.schema.set(e)},MapSVG.DatabaseService.prototype.loadSchema=function(e){return this.schema.load(e)},MapSVG.DatabaseService.prototype.saveSchema=function(e){return this.schema.save(e)},MapSVG.DatabaseService.prototype.getColumns=function(e){return this.schema.getColumns(e)},MapSVG.DatabaseSchema=function(e,t){this.mapsvg=t,this.map_id=e.map_id,this.table=e.table,this.lastChangeTime=Date.now(),this.cols=[],this.schema=[],this.schemaDict={},this.events={create:[],update:[],change:[]}},MapSVG.DatabaseSchema.prototype.loaded=function(e){return 0!==this.schema.length},MapSVG.DatabaseSchema.prototype.set=function(e){var o=this;e&&(o.schema=e.map(function(t){return t.visible=MapSVG.parseBoolean(t.visible),"region"==t.type&&(t.options=[],t.optionsDict={},o.mapsvg.regions.forEach(function(e){t.options.push({id:e.id,title:e.title}),t.optionsDict[e.id]=e.title||e.id})),o.schemaDict[t.name]=t}))},MapSVG.DatabaseSchema.prototype.save=function(e){var t,o=this;for(t in this.set(e),this.schema)this.schema[t]||this.schema.splice(t,1);return e=(e=(e=(e=(e=JSON.stringify(e)).replace(/select/g,"!mapsvg-encoded-slct")).replace(/table/g,"!mapsvg-encoded-tbl")).replace(/database/g,"!mapsvg-encoded-db")).replace(/varchar/g,"!mapsvg-encoded-vc"),c.post(ajaxurl,{action:"mapsvg_save_schema",schema:e,map_id:this.map_id,table:this.table,_wpnonce:MapSVG.nonce}).done(function(){o.trigger("change")})},MapSVG.DatabaseSchema.prototype.get=function(e){return this.schema},MapSVG.DatabaseSchema.prototype.getField=function(e){return"id"==e?{name:"id",visible:!0,type:"id"}:this.schemaDict[e]},MapSVG.DatabaseSchema.prototype.getFieldByType=function(t){var o=null;return this.schema.forEach(function(e){e.type===t&&(o=e)}),o},MapSVG.DatabaseSchema.prototype.load=function(e){var t=this;return c.get(ajaxurl,{action:"mapsvg_get_schema",map_id:this.map_id,table:this.table},null,"json").done(function(e){t.set(e)})},MapSVG.DatabaseSchema.prototype.getColumns=function(o){o=o||{};var e=this.get().slice(0);"regions"==this.table&&e.unshift({name:"title",visible:!0,type:"title"});var t=!0;e.forEach(function(e){"id"==e.name&&(t=!1)}),t&&e.unshift({name:"id",visible:!0,type:"id"});var i,s=0!==Object.keys(o).length,a=[];return s?e.forEach(function(e){for(var t in i=!0,o)i=e[t]==o[t];i&&a.push(e)}):a=e,a},MapSVG.DatabaseSchema.prototype.on=function(e,t){this.lastChangeTime=Date.now(),this.events[e]||(this.events={}),this.events[e].push(t)},MapSVG.DatabaseSchema.prototype.trigger=function(e){this.events[e]&&this.events[e].length&&this.events[e].forEach(function(e){e&&e()})},MapSVG.Server=function(e){this.index={},this.hasMoreRecords=!1},MapSVG.Server.prototype.reindex=function(){var o=this;this.index={},this.rows&&this.rows.forEach(function(e,t){o.index[e.id]=t})},MapSVG.Server.prototype.getLoadedObject=function(e){e=this.index[e];return null!=e?this.rows[e]:null},MapSVG.ServerMySQL=function(e){this.map_id=e.map_id,this.table=e.table,this.perpage=e.perpage,this.rows=[],MapSVG.Server.call(this)},MapSVG.extend(MapSVG.ServerMySQL,MapSVG.Server),MapSVG.ServerMySQL.prototype.formatData=function(e){var t,o={};for(t in e)!e[t]||"object"!=typeof e[t]&&"function"!=typeof e[t]||null==e[t].getOptions?null===e[t]||void 0===e[t]||"object"==typeof e[t]&&0===e[t].length?o[t]="":o[t]=e[t]:o[t]=e[t].getOptions();return JSON.stringify(o)},MapSVG.ServerMySQL.prototype.actionData=function(e,t){return t.action=e,t.map_id=this.map_id,t.table=this.table,t.perpage=this.perpage,t._wpnonce=MapSVG.nonce,t},MapSVG.ServerMySQL.prototype.fill=function(e){var t=this;e.objects&&e.objects.length?(t.hasMoreRecords=!!(this.perpage&&e.objects.length>this.perpage),t.hasMoreRecords&&e.objects.pop(),t.rows=e.objects):(t.hasMoreRecords=!1,t.rows=[]),t.reindex()},MapSVG.ServerMySQL.prototype.get=function(e){var t=this;return void 0!==e.perpage&&(this.perpage=e.perpage),c.getJSON(ajaxurl,this.actionData("mapsvg_data_get_all",e)).done(function(e){t.fill(e)})},MapSVG.ServerMySQL.prototype.import=function(e,o,i){for(var t,s,a,n=this,r=[],l=0,p=e.length;l<p;l+=50)t=e.slice(l,l+50),r.push(t);return 0<r.length&&(a=r[s=0][0]&&r[0][0].location?1e3:0,defer=c.Deferred(),defer.promise(),n.completeChunks=0,r.forEach(function(t){s+=a,setTimeout(function(){var e=JSON.stringify(t);c.post(ajaxurl,n.actionData("mapsvg_data_import",{data:e,language:o,convertLatlngToAddress:i}),null,"json").done(function(e){n.completeChunk(r,defer)})},s)})),defer},MapSVG.ServerMySQL.prototype.completeChunk=function(e,t){this.completeChunks++,this.completeChunks===e.length&&t.resolve()},MapSVG.ServerMySQL.prototype.create=function(t){var o=this;this.rows.push(t);var e=c.extend({},t);e.post&&delete e.post;e=this.formatData(e);return c.post(ajaxurl,this.actionData("mapsvg_data_create",{data:e}),null,"json").done(function(e){}).then(function(e){return t.id=e.id,o.reindex(),t})},MapSVG.ServerMySQL.prototype.update=function(e){var t=this.index[e.id];if(void 0!==t){c.extend(this.rows[t],e);e=c.extend({},e);e.post&&delete e.post;e=this.formatData(e);return c.post(ajaxurl,this.actionData("mapsvg_data_update",{data:e}),null,"json")}},MapSVG.ServerMySQL.prototype.delete=function(e){var t=this,o=this.index[e];return this.rows.splice(o,1),c.post(ajaxurl,this.actionData("mapsvg_data_delete",{data:{id:e}}),null,"json").done(function(){t.reindex()})},MapSVG.ServerMySQL.prototype.clear=function(e){var t=this;return c.post(ajaxurl,this.actionData("mapsvg_data_clear",{data:{}}),null,"json").done(function(){this.rows=[],t.reindex()})},MapSVG.ServerLocal=function(e){this.rows=e.storage,MapSVG.Server.call(this,e),this.reindex()},MapSVG.extend(MapSVG.ServerLocal,MapSVG.Server),MapSVG.ServerLocal.prototype.get=function(e){defer=c.Deferred();var t=this.rows;return defer.promise(),defer.resolve(t),defer},MapSVG.ServerLocal.prototype.create=function(e){if(e.id){var t=this.index[e.id];if(this.rows[t])return this.update(e)}else e.id=this.getId();return this.rows.push(e),this.reindex(),defer=c.Deferred(),defer.promise(),defer.resolve(e),defer},MapSVG.ServerLocal.prototype.update=function(e){defer=c.Deferred();var t=this.index[e.id];if(this.rows[t]){for(var o in e)this.rows[t][o]=e[o];this.rows[t]=e}else this.rows.push(e);return this.reindex(),defer.promise(),defer.resolve(e),defer},MapSVG.ServerLocal.prototype.delete=function(e){e=this.index[e];return this.rows.splice(e,1),this.reindex(),defer=c.Deferred(),defer.promise(),defer.resolve(this.storage),defer},MapSVG.ServerLocal.prototype.getId=function(){var e=this.rows.map(function(e){return e.id});return(e=!e.length?[0]:e)?Math.max.apply(null,e)+1:1},MapSVG.Filters=function(e){this.schema={},this.schemaDict={},this.fields={},this.events={change:[]},this.setSchema(e)},MapSVG.Filters.prototype.set=function(e){this.fields=e},MapSVG.Filters.prototype.save=function(e){this.fields=e},MapSVG.Filters.prototype.reset=function(e){this.fields={}},MapSVG.Filters.prototype.get=function(e){return this.fields},MapSVG.Filters.prototype.getField=function(e){return this.schemaDict[e]},MapSVG.Filters.prototype.getSchema=function(e){return this.schema},MapSVG.Filters.prototype.setSchema=function(e){var o=this;return e&&e.forEach(function(e){var t=e.parameterName.split(".")[1];o.schemaDict[t]=e}),this.schema=e,this.schema},MapSVG.Filters.prototype.on=function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)},MapSVG.Filters.prototype.trigger=function(e){var t=this;this.events[e]&&this.events[e].length&&this.events[e].forEach(function(e){e&&e(t)})},MapSVG.DatabaseQuery=function(e){e=e||{},this.sort=e.sort||{},this.sortBy=e.sortBy||null,this.sortDir=e.sortDir||null,this.page=e.page||1,this.perpage=e.perpage||0,this.search=e.search,this.searchField=e.searchField,this.filters=e.filters||{},this.filterout=e.filterout||{}},MapSVG.DatabaseQuery.prototype.set=function(e){for(var t in e)"filters"==t?this.setFilters(e[t]):this[t]=e[t]},MapSVG.DatabaseQuery.prototype.get=function(){return{search:this.search,searchField:this.searchField,searchFallback:this.searchFallback,filters:this.filters,filterout:this.filterout,page:this.page,sort:this.sort,perpage:this.perpage}},MapSVG.DatabaseQuery.prototype.setFilters=function(e){for(var t in e)null===e[t]||""===e[t]||void 0===e[t]?this.filters[t]&&delete this.filters[t]:this.filters[t]=e[t]},MapSVG.DatabaseQuery.prototype.setFilterOut=function(e){for(var t in e)this.filterout[t]=e[t]},MapSVG.DatabaseQuery.prototype.resetFilters=function(e){this.filters={}},MapSVG.DatabaseQuery.prototype.setFilterField=function(e,t){this.filters[e]=t}}(jQuery),function(e){MapSVG.DetailsController=function(e){MapSVG.Controller.call(this,e),this.modal=e.modal},MapSVG.extend(MapSVG.DetailsController,MapSVG.Controller),MapSVG.DetailsController.prototype.getToolbarTemplate=function(){return this.withToolbar?'<div class="mapsvg-popover-close mapsvg-details-close"></div>':""},MapSVG.DetailsController.prototype.viewDidLoad=function(){this.events&&this.events.shown&&this.events.shown.call(this,this.mapsvg),this.modal&&MapSVG.isPhone&&this.mapsvg.getData().options.detailsView.mobileFullscreen&&!this.mobileCloseBtn&&(this.mobileCloseBtn=e('<button class="mapsvg-mobile-modal-close mapsvg-btn">'+this.mapsvg.getData().options.mobileView.labelClose+"</button>"),this.view.append(this.mobileCloseBtn))},MapSVG.DetailsController.prototype.setEventHandlers=function(){var t=this;this.view.on("click",".mapsvg-popover-close, .mapsvg-mobile-modal-close",function(e){e.stopPropagation(),t.destroy(),t.events&&t.events.closed&&t.events.closed.call(t,t.mapsvg)})}}(jQuery),function($){MapSVG.DirectoryController=function(e){this.database=e.database,this.noPadding=!0,this.position=e.position,this.search=e.search,this.filters=e.filters,MapSVG.Controller.call(this,e)},MapSVG.extend(MapSVG.DirectoryController,MapSVG.Controller),MapSVG.DirectoryController.prototype.getToolbarTemplate=function(){return'<div class="mapsvg-directory-search-wrap"><div class="mapsvg-directory-filter-wrap filter-wrap"></div></div></div>'},MapSVG.DirectoryController.prototype.viewDidLoad=function(){this.menuBtn=$('<div class="mapsvg-button-menu"><i class="mapsvg-icon-menu"></i> '+this.mapsvg.getData().options.mobileView.labelList+"</div>"),this.mapBtn=$('<div class="mapsvg-button-map"><i class="mapsvg-icon-map"></i> '+this.mapsvg.getData().options.mobileView.labelMap+"</div>"),MapSVG.isPhone&&this.mapsvg.options.menu.hideOnMobile&&("map"==this.mapsvg.getData().options.menu.showFirst?this.toggle(!1):this.toggle(!0)),this.mobileButtons=$('<div class="mapsvg-mobile-buttons"></div>'),this.mobileButtons.append(this.menuBtn,this.mapBtn),!1!==this.mapsvg.getData().options.menu.on&&this.mobileButtons.appendTo(this.mapsvg.getData().$wrapAll),this.events&&this.events.shown&&this.events.shown.call(this.view)},MapSVG.DirectoryController.prototype.setEventHandlers=function(){var _this=this,_data=_this.mapsvg.getData();$(window).on("resize",function(){_this.updateTopShift()}),this.menuBtn.on("click",function(){_this.toggle(!0)}),this.mapBtn.on("click",function(){_this.toggle(!1),_this.mapsvg.redraw()}),this.view.on("click.menu.mapsvg",".mapsvg-directory-item",function(e){e.preventDefault();var objID=$(this).data("object-id"),regions,marker,detailsViewObject,eventObject,skipPopover,events;_this.deselectItems(),_this.selectItems(objID),MapSVG.isPhone&&_this.mapsvg.getData().options.menu.showMapOnClick&&_this.toggle(!1),"regions"==_this.mapsvg.getData().options.menu.source?(regions=[_this.mapsvg.getRegion(objID)],eventObject=regions[0],detailsViewObject=regions[0]):(detailsViewObject=_this.database.getLoadedObject(objID),eventObject=detailsViewObject,detailsViewObject.regions&&(regions=detailsViewObject.regions.map(function(e){return _this.mapsvg.getRegion(e.id)}).filter(function(e){return void 0!==e}))),detailsViewObject.location&&detailsViewObject.location.marker&&(marker=detailsViewObject.location.marker),_this.mapsvg.getData().options.actions.directoryItem.click.showDetails&&_this.mapsvg.loadDetailsView(detailsViewObject),regions&&0<regions.length&&(_this.mapsvg.getData().options.actions.directoryItem.click.zoom&&_this.mapsvg.zoomTo(regions,_this.mapsvg.getData().options.actions.directoryItem.click.zoomToLevel),1<regions.length&&_this.mapsvg.setMultiSelect(!0),regions.forEach(function(t){var o=t.getCenter();e.clientX=o[0],e.clientY=o[1],_this.mapsvg.getData().options.actions.directoryItem.click.selectRegion&&_this.mapsvg.selectRegion(t,!0),_this.mapsvg.getData().options.actions.directoryItem.click.showRegionPopover&&(_this.mapsvg.getData().options.actions.directoryItem.click.zoom?setTimeout(function(){_this.mapsvg.showPopover(t)},500):_this.mapsvg.showPopover(t)),!_this.mapsvg.getData().options.actions.directoryItem.click.fireRegionOnClick||(o=_this.mapsvg.getData().events)&&o["click.region"]&&o&&o["click.region"].call(t,e,_this.mapsvg)}),1<regions.length&&_this.mapsvg.setMultiSelect(!1,!1)),marker&&(_this.mapsvg.getData().options.actions.directoryItem.click.zoomToMarker&&_this.mapsvg.zoomTo(marker,_this.mapsvg.getData().options.actions.directoryItem.click.zoomToMarkerLevel),_this.mapsvg.getData().options.actions.directoryItem.click.showMarkerPopover&&(_this.mapsvg.getData().options.actions.directoryItem.click.zoomToMarker?setTimeout(function(){_this.mapsvg.showPopover(detailsViewObject)},500):_this.mapsvg.showPopover(detailsViewObject)),_this.mapsvg.getData().options.actions.directoryItem.click.fireMarkerOnClick&&(events=_this.mapsvg.getData().events,events&&events["click.marker"]&&events&&events["click.marker"].call(marker,e,_this.mapsvg)),_this.mapsvg.selectMarker(marker)),_this.events.click&&_this.events.click.call($(this),e,eventObject,_this.mapsvg);var actions=_this.mapsvg.getData().options.actions,linkParts,url,obj,attr,win;if(actions.directoryItem.click.goToLink&&(linkParts=actions.directoryItem.click.linkField.split("."),1<linkParts.length&&(obj=linkParts.shift(),attr="."+linkParts.join("."),"Region"==obj?regions[0]&&regions[0].data&&(url=eval("regions[0].data"+attr)):detailsViewObject&&(url=eval("detailsViewObject"+attr)),url&&(actions.directoryItem.click.newTab?(win=window.open(url,"_blank"),win.focus()):window.location.href=url))),actions.directoryItem.click.showAnotherMap){if(_data.editMode)return alert('"Show another map" action is disabled in the preview'),!0;var linkParts=actions.directoryItem.click.showAnotherMapField.split("."),url,obj,attr,map_id,container;1<linkParts.length&&(obj=linkParts.shift(),attr="."+linkParts.join("."),"Region"==obj?regions[0]&&regions[0].data&&(map_id=eval("regions[0].data"+attr)):detailsViewObject&&(map_id=eval("detailsViewObject"+attr)),map_id&&(container=actions.directoryItem.click.showAnotherMapContainerId?$("#"+actions.directoryItem.click.showAnotherMapContainerId):_data.$map,jQuery.get(ajaxurl,{action:"mapsvg_get",id:map_id},function(data){container.find("svg").length&&container.mapSvg().destroy(),eval("var options = "+data),container.mapSvg(options)})))}}).on("mouseover.menu.mapsvg",".mapsvg-directory-item",function(t){var e,o,i,s,a=$(this).data("object-id");"regions"==_this.mapsvg.getData().options.menu.source?(i=(e=[_this.mapsvg.getRegion(a)])[0],o=e[0]):((i=o=_this.database.getLoadedObject(a)).regions&&(e=o.regions.map(function(e){return _this.mapsvg.getRegion(e.id)})),o.location&&(s=o.location.marker)),e&&e.length&&(_this.mapsvg.highlightRegions(e),e.forEach(function(e){e&&!e.disabled&&_this.mapsvg.getData().options.mouseOver&&_this.mapsvg.getData().options.mouseOver.call(e,t,_this)})),s&&(_this.mapsvg.highlightMarker(s),_this.mapsvg.options.actions.directoryItem.hover.centerOnMarker&&_this.mapsvg.centerOn(s)),_this.events.mouseover&&_this.events.mouseover.call($(this),t,i,_this.mapsvg)}).on("mouseout.menu.mapsvg",".mapsvg-directory-item",function(t){var e,o,i,s,a=$(this).data("object-id");"regions"==_this.mapsvg.getData().options.menu.source?(i=(e=[_this.mapsvg.getRegion(a)])[0],o=e[0]):((i=o=_this.database.getLoadedObject(a)).regions&&(e=o.regions.map(function(e){return _this.mapsvg.getRegion(e.id)})),o.location&&(s=o.location.marker)),e&&e.length&&(_this.mapsvg.unhighlightRegions(e),e.forEach(function(e){e&&!e.disabled&&_this.mapsvg.getData().options.mouseOut&&_this.mapsvg.getData().options.mouseOut.call(e,t,_this)})),s&&_this.mapsvg.unhighlightMarker(s),_this.events.mouseout&&_this.events.mouseout.call($(this),t,i,_this.mapsvg)}),this.contentView.on("click",".mapsvg-category-item",function(){var e=$(this).next(".mapsvg-category-block");e[0].style.maxHeight||e.hasClass("active")?e[0].style.maxHeight=null:e[0].style.maxHeight=e[0].scrollHeight+"px",$(this).hasClass("active")?($(this).toggleClass("active",!1),$(this).next(".mapsvg-category-block").addClass("collapsed").removeClass("active")):(_this.mapsvg.options.menu.categories.collapseOther&&($(this).parent().find(".mapsvg-category-item.active").removeClass("active"),$(this).parent().find(".mapsvg-category-block.active").removeClass("active").addClass("collapsed")),$(this).toggleClass("active",!0),$(this).next(".mapsvg-category-block").removeClass("collapsed").addClass("active")),$(".mapsvg-category-block.collapsed").each(function(e,t){t.style.maxHeight=null})})},MapSVG.DirectoryController.prototype.highlightItems=function(e){var t=this;(e="object"!=typeof e?[e]:e).forEach(function(e){t.view.find("#mapsvg-directory-item-"+e).addClass("hover")})},MapSVG.DirectoryController.prototype.unhighlightItems=function(){this.view.find(".mapsvg-directory-item").removeClass("hover")},MapSVG.DirectoryController.prototype.selectItems=function(e){var t=this;(e="object"!=typeof e?[e]:e).forEach(function(e){t.view.find("#mapsvg-directory-item-"+e).addClass("selected")}),t.scrollable&&t.contentWrap.nanoScroller({scrollTo:t.view.find("#mapsvg-directory-item-"+e[0])})},MapSVG.DirectoryController.prototype.deselectItems=function(){this.view.find(".mapsvg-directory-item").removeClass("selected")},MapSVG.DirectoryController.prototype.removeItems=function(e){this.view.find("#mapsvg-directory-item-"+e).remove()},MapSVG.DirectoryController.prototype.addFilter=function(e){},MapSVG.DirectoryController.prototype.filterOut=function(e){var i,s=this;return"regions"==this.database.table&&(i={},s.mapsvg.getData().options.menu.filterout.field&&(i.field=s.mapsvg.getData().options.menu.filterout.field,i.val=s.mapsvg.getData().options.menu.filterout.val),e=e.filter(function(e){var t=!0,o=s.mapsvg.getData().options.regionStatuses;return t=(t=o[e.status]?!o[e.status].disabled:t)&&i.field?e[i.field]!=i.val:t})),e},MapSVG.DirectoryController.prototype.loadItemsToDirectory=function(){var e,o=this;if(!o.database.loaded)return!1;if(o.mapsvg.options.menu.categories&&o.mapsvg.options.menu.categories.on&&o.mapsvg.options.menu.categories.groupBy){var i=o.mapsvg.options.menu.categories.groupBy;if(void 0===o.database.getSchemaField(i)||void 0===o.database.getSchemaField(i).options)return!1;var t=o.database.getSchemaField(i).options.map(function(t){var e=o.database.getLoaded(),e=(e=o.filterOut(e)).filter(function(e){return"regions"!==i?e[i]==t.value:-1!==(void 0!==e[i]&&e[i].length?e[i]:[]).map(function(e){return e.id}).indexOf(t.id)});return t.counter=e.length,"regions"===i&&(t.label=t.title,t.value=t.id),{category:t,items:e}});o.mapsvg.options.menu.categories.hideEmpty&&(t=t.filter(function(e){return 0<e.category.counter}))}else t=this.database.getLoaded();try{this.contentView.html(this.templates.main({items:t}))}catch(e){console.error('MapSVG: Error in the "Directory item" template'),console.error(e)}0==t.length&&this.contentView.html('<div class="mapsvg-no-results">'+this.mapsvg.getData().options.menu.noResultsText+"</div>"),o.mapsvg.options.menu.categories.on&&(o.mapsvg.options.menu.categories.collapse&&1<t.length?this.contentView.find(".mapsvg-category-block").addClass("collapsed"):o.mapsvg.options.menu.categories.collapse&&1===t.length?(this.contentView.find(".mapsvg-category-item").addClass("active"),this.contentView.find(".mapsvg-category-block").addClass("active"),0<(e=this.contentView.find(".mapsvg-category-block")).length&&(e[0].style.maxHeight=e.scrollHeight+"px")):o.mapsvg.options.menu.categories.collapse||(this.contentView.find(".mapsvg-category-item").addClass("active"),this.contentView.find(".mapsvg-category-block").addClass("active"),this.contentView.find(".mapsvg-category-block").each(function(e,t){t.style.maxHeight=t.scrollHeight+"px"}))),this.setFilters(),this.updateScroll()},MapSVG.DirectoryController.prototype.getRegion=function(e){var t;return"regions"==this.mapsvg.getData().options.menu.source?t=this.mapsvg.getRegion(e):(e=this.database.getLoadedObject(e)).region_id&&(t=this.mapsvg.getRegion(e.region_id)),t},MapSVG.DirectoryController.prototype.setFilters=function(){this.updateTopShift()},MapSVG.DirectoryController.prototype.toggle=function(e){var t=this;e?(this.container.parent().show(),t.mapsvg.getData().$mapContainer.hide(),this.menuBtn.addClass("active"),this.mapBtn.removeClass("active")):(this.container.parent().hide(),t.mapsvg.getData().$mapContainer.show(),this.menuBtn.removeClass("active"),this.mapBtn.addClass("active")),this.container.parent().is(":visible")?MapSVG.isPhone&&this.container.height()<parseInt(this.mapsvg.getData().options.menu.minHeight)&&(t.mapsvg.getData().$wrap.css("height",parseInt(this.mapsvg.getData().options.menu.minHeight)+"px"),t.updateScroll()):MapSVG.isPhone&&(t.mapsvg.getData().$wrap.css("height","auto"),t.updateScroll()),this.updateTopShift()},MapSVG.DirectoryController.prototype.addPagination=function(e){this.contentView.append('<div class="mapsvg-pagination-container"></div>'),this.contentView.find(".mapsvg-pagination-container").html(e)}}(jQuery),jQuery,MapSVG.FiltersController=function(e){MapSVG.DetailsController.call(this,e)},MapSVG.extend(MapSVG.FiltersController,MapSVG.DetailsController),jQuery,MapSVG.Location=function(e,t){this.img=e.img,this.setImage(this.img),this.lat=void 0!==e.lat?parseFloat(e.lat):void 0,this.lng=void 0!==e.lng?parseFloat(e.lng):void 0,this.x=void 0!==e.x?parseFloat(e.x):void 0,this.y=void 0!==e.y?parseFloat(e.y):void 0,this.address=new MapSVG.LocationAddress(e.address)},MapSVG.Location.prototype.setImage=function(e){var t=e.split("/").pop();-1!==e.indexOf("uploads")&&(t="uploads/"+t),this.img=t},MapSVG.Location.prototype.setLatLng=function(e){this.lat=e.lat,this.lng=e.lng},MapSVG.Location.prototype.__defineGetter__("markerImageUrl",function(){return this.img&&0===this.img.indexOf("uploads/")?MapSVG.urls.uploads+"markers/"+this.img.replace("uploads/",""):MapSVG.urls.root+"markers/"+(this.img||"_pin_default.png")}),MapSVG.Location.prototype.toJSON=function(){return{img:this.img,lat:this.lat,lng:this.lng,x:this.x,y:this.y,address:this.address}},jQuery,MapSVG.LocationAddress=function(e){for(var t in e)this[t]=e[t]},MapSVG.LocationAddress.prototype.__defineGetter__("state",function(){return"US"===this.country_short?this.administrative_area_level_1:null}),MapSVG.LocationAddress.prototype.__defineGetter__("state_short",function(){return"US"===this.country_short?this.administrative_area_level_1_short:null}),MapSVG.LocationAddress.prototype.__defineGetter__("county",function(){return"US"===this.country_short?this.administrative_area_level_2:null}),MapSVG.LocationAddress.prototype.__defineGetter__("zip",function(){return this.postal_code}),function($){MapSVG.Map=function(e,t){var o='<div>\n  <p>This is the demo content of the <strong>Region %templateType%</strong>.</p>\n  <p>Click on the following link to edit the content of this window: <a href="#" class="mapsvg-template-link" data-template="%templateTypeSnake%Region">Menu > Templates > Region %templateType%</a>.</p>\n  <p>More information about templates: <a href="https://mapsvg.com/docs/map-editor/templates" target="_blank">mapsvg.com/docs/map-editor/templates</a></p>\n</div>\n<hr />\n\n\x3c!-- Region fields are available in this template --\x3e\n<h5>{{#if title}} {{title}} {{else}} {{id}} {{/if}}</h5>\n<p>Status: {{status_text}}</p>\n\n\x3c!-- Show all linked Database Objects: --\x3e\n{{#each objects}}\n\n  \x3c!-- DB Object are available inside of this block --\x3e\n\n  <h5>{{title}}</h5>\n  \x3c!-- When you need to render a field as HTML, use 3 curly braces instead of 2:--\x3e\n  <p>{{{description}}}</p>\n  <p><em>{{location.address.formatted}}</em></p>\n\n  \x3c!-- Show all images: --\x3e\n  {{#each images}}\n    \x3c!-- Image fields "thumbnail", "medium", "full" --\x3e\n    \x3c!-- are available in this block                --\x3e\n    <img src="{{thumbnail}}" />\n  {{/each}}\n\n{{/each}}',i='<div>\n  <p>This is the demo content of the <strong>DB Object %templateType%</strong>.</p>\n  <p>Click on the following link to edit the content of this window: <a href="#" class="mapsvg-template-link" data-template="%templateTypeSnake%Region">Menu > Templates > Region %templateType%</a>.</p>\n  <p>More information about templates: <a href="https://mapsvg.com/docs/map-editor/templates" target="_blank">mapsvg.com/docs/map-editor/templates</a></p>\n</div>\n<hr />\n\n\x3c!-- DB Object fields are available in this template. --\x3e\n<h5>{{title}}</h5>\n\x3c!-- When you need to render a fields as HTML, use 3 curly braces instead of 2:--\x3e\n<p>{{{description}}}</p>\n<p><em>{{location.address.formatted}}</em></p>\n\n\x3c!-- Show all images: --\x3e\n{{#each images}}\n  \x3c!-- Image fields "thumbnail", "medium", "full" --\x3e\n  \x3c!-- are available in this block                --\x3e\n  <img src="{{thumbnail}}" />\n{{/each}}\n\n\x3c!-- Show all linked Regions, comma-separated: --\x3e\n<p> Regions: \n  {{#each regions}}\n    \x3c!-- Region fields are available in this block --\x3e\n    {{#if title}}\n      {{title}}\n    {{else}}\n      {{id}}\n    {{/if}}{{#unless @last}}, {{/unless}}\n  {{/each}}\n</p>';this.defaults={markerLastID:0,regionLastID:0,dataLastID:1,disableAll:!1,width:null,height:null,lockAspectRatio:!1,padding:{top:0,left:0,right:0,bottom:0},maxWidth:null,maxHeight:null,minWidth:null,minHeight:null,loadingText:"Loading map...",colorsIgnore:!1,colors:{baseDefault:"#000000",background:"#eeeeee",selected:40,hover:20,directory:"#fafafa",detailsView:"",status:{},clusters:"",clustersBorders:"",clustersText:"",clustersHover:"",clustersHoverBorders:"",clustersHoverText:"",markers:{base:{opacity:100,saturation:100},hovered:{opacity:100,saturation:100},unhovered:{opacity:40,saturation:100},active:{opacity:100,saturation:100},inactive:{opacity:40,saturation:100}}},regions:{},clustering:{on:!1},viewBox:[],cursor:"default",manualRegions:!1,onClick:null,mouseOver:null,mouseOut:null,menuOnClick:null,beforeLoad:null,afterLoad:null,zoom:{on:!0,limit:[0,10],delta:2,buttons:{on:!0,location:"right"},mousewheel:!0,fingers:!0},scroll:{on:!0,limit:!1,background:!1,spacebar:!1},responsive:!0,tooltips:{on:!1,position:"bottom-right",template:"",maxWidth:"",minWidth:100},popovers:{on:!1,position:"top",template:"",centerOn:!0,width:300,maxWidth:50,maxHeight:50},multiSelect:!1,regionStatuses:{1:{label:"Enabled",value:"1",color:"",disabled:!1},0:{label:"Disabled",value:"0",color:"",disabled:!0}},events:{afterLoad:"function(){\n  // var mapsvg = this;\n  // var regions = mapsvg.regions;\n  // var dbObjects = mapsvg.database.getLoaded();\n}",beforeLoad:"function(){\n  // var mapsvg = this;\n  // var settings = mapsvg.options;\n  // console.log(settings);\n}",databaseLoaded:"function (){\n  // var mapsvg = this;\n  // var dbObjects = mapsvg.database.getLoaded();\n}","click.region":"function (e, mapsvg){\n  // var region = this;\n  // console.log(region);\n}","mouseover.region":"function (e, mapsvg){\n  // var region = this;\n  // console.log(region);\n}","mouseout.region":"function (e, mapsvg){\n  // var region = this;\n  // console.log(region);\n}","click.marker":"function (e, mapsvg){\n  // var marker = this;\n  // console.log(marker);\n}","mouseover.marker":"function (e, mapsvg){\n  // var marker = this;\n  // console.log(marker);\n}","mouseout.marker":"function (e, mapsvg){\n  // var marker = this;\n  // console.log(marker);\n}","click.directoryItem":"function (e, regionOrObject, mapsvg){\n  // var itemjQueryObject = this;\n}","mouseover.directoryItem":"function (e, regionOrObject, mapsvg){\n  // var itemjQueryObject = this;\n}","mouseout.directoryItem":"function (e, regionOrObject, mapsvg){\n  // var itemjQueryObject = this;\n}","shown.popover":"function (mapsvg){\n  // var popoverjQueryObject = this;\n}","closed.popover":"function (mapsvg){\n  // var popoverjQueryObject = this;\n}","closed.detailsView":"function (mapsvg){\n  // var detailsjQueryObject = this;\n}","shown.detailsView":"function (mapsvg){\n  // var detailsjQueryObject = this;\n}"},css:"#mapsvg-map-%id% .mapsvg-tooltip {\n\n}\n#mapsvg-map-%id% .mapsvg-popover {\n\n}\n#mapsvg-map-%id% .mapsvg-details-container {\n\n}\n#mapsvg-map-%id% .mapsvg-directory-item {\n\n}\n#mapsvg-map-%id% .mapsvg-region-label {\n  /* background-color: rgba(255,255,255,.6); */\n  font-size: 11px;\n  padding: 3px 5px;\n  border-radius: 4px;\n}\n#mapsvg-map-%id% .mapsvg-marker-label {\n  padding: 3px 5px;\n  /*\n  border-radius: 4px;\n  background-color: white;\n  margin-top: -4px;\n  */\n}\n#mapsvg-map-%id% .mapsvg-filters-wrap {\n\n}\n\n\n\n\n\n\n",templates:{popoverRegion:o.replace(/%templateType%/g,"Popover").replace(/%templateTypeSnake%/g,"popover"),popoverMarker:i.replace(/%templateType%/g,"Popover").replace(/%templateTypeSnake%/g,"popover"),tooltipRegion:"\x3c!-- Region fields are available in this template --\x3e\n{{id}} - {{title}}",tooltipMarker:"\x3c!-- DB Object fields are available in this template --\x3e\n{{title}}",directoryItem:"\x3c!-- If Directory Source = Database: DB Object fields are available in this template --\x3e\n\x3c!-- If Directory Source = Regions: Region fields are available in this template --\x3e\n{{title}}",directoryCategoryItem:'\x3c!-- Available fields: "label", "value", "counter" --\x3e\n<span class="mapsvg-category-label">{{label}}</span>\n<span class="mapsvg-category-counter">{{counter}}</span>\n<span class="mapsvg-chevron"></span>',detailsView:i.replace(/%templateType%/g,"Details View").replace(/%templateTypeSnake%/g,"detailsView"),detailsViewRegion:o.replace(/%templateType%/g,"Details View").replace(/%templateTypeSnake%/g,"detailsView"),labelMarker:"\x3c!-- DB Object fields are available in this template --\x3e\n{{title}}",labelRegion:"\x3c!-- Region fields are available in this template --\x3e\n{{title}}",labelLocation:"You are here!"},gauge:{on:!1,labels:{low:"low",high:"high"},colors:{lowRGB:null,highRGB:null,low:"#550000",high:"#ee0000"},min:0,max:0},filters:{on:!0,source:"database",location:"header",modalLocation:"mapContainer",width:"100%",hide:!1,buttonText:"Filters",clearButtonText:"Clear all",clearButton:!1,padding:""},menu:{on:!1,hideOnMobile:!0,location:"leftSidebar",locationMobile:"leftSidebar",search:!1,containerId:"",searchPlaceholder:"Search...",searchFallback:!1,source:"database",showFirst:"map",showMapOnClick:!0,minHeight:"400",sortBy:"id",sortDirection:"desc",categories:{on:!1,groupBy:"",hideEmpty:!0,collapse:!0,collapseOther:!0},clickActions:{region:"default",marker:"default",directoryItem:{triggerClick:!0,showPopover:!1,showDetails:!0}},detailsViewLocation:"overDirectory",noResultsText:"No results found",filterout:{field:"",cond:"=",val:""}},database:{pagination:{on:!0,perpage:30,next:"Next",prev:"Prev.",showIn:"directory"},loadOnStart:!0,table:""},actions:{map:{afterLoad:{selectRegion:!1}},region:{click:{addIdToUrl:!1,showDetails:!0,showDetailsFor:"region",filterDirectory:!1,loadObjects:!1,showPopover:!1,showPopoverFor:"region",goToLink:!1,linkField:"Region.link"},touch:{showPopover:!1}},marker:{click:{showDetails:!0,showPopover:!1,goToLink:!1,linkField:"Object.link"},touch:{showPopover:!1}},directoryItem:{click:{showDetails:!0,showPopover:!1,goToLink:!1,selectRegion:!0,fireRegionOnClick:!0,linkField:"Object.link"},hover:{centerOnMarker:!1}}},detailsView:{location:"mapContainer",containerId:"",width:"100%",mobileFullscreen:!0},mobileView:{labelMap:"Map",labelList:"List",labelClose:"Close"},googleMaps:{on:!1,apiKey:"",loaded:!1,center:"auto",type:"roadmap",minZoom:1,style:"default",styleJSON:[]},groups:[],floors:[],layersControl:{on:!1,position:"top-left",label:"Show on map",expanded:!0,maxHeight:"100%"},floorsControl:{on:!1,position:"top-left",label:"Floors",expanded:!1,maxHeight:"100%"},containers:{leftSidebar:{on:!1,width:"250px"},rightSidebar:{on:!1,width:"250px"},header:{on:!0,height:"auto"},footer:{on:!1,height:"auto"}},labelsMarkers:{on:!1},labelsRegions:{on:!1},svgFileVersion:1,fitMarkers:!1,fitMarkersOnStart:!1,controls:{location:"right",zoom:!0,zoomReset:!1,userLocation:!1}},this.markerOptions={src:MapSVG.urls.root+"markers/pin1_red.png"},this.init(t,$("#"+e))},MapSVG.Map.prototype={setMarkersClickAsLink:function(){var t=this;this.database.loadSchema().done(function(e){e&&e.forEach(function(e){"marker"==e.type&&(t.markerIsLink=MapSVG.parseBoolean(e.isLink),t.markerUrlField=e.urlField)})})},setGroups:function(){var o=this;o.groups=o.options.groups,o.groups.forEach(function(t){t.objects&&t.objects.length&&t.objects.forEach(function(e){o.$svg.find("#"+e.value).toggle(t.visible)})})},setLayersControl:function(e){var o=this;e&&$.extend(!0,o.options.layersControl,e),o.options.layersControl.on?(o.$layersControl||(o.$layersControl=$('<div class="mapsvg-layers-control"></div>'),o.$layersControlLabel=$('<div class="mapsvg-layers-label"></div>').appendTo(o.$layersControl),o.$layersControlListWrap=$('<div class="mapsvg-layers-list-wrap"></div>').appendTo(o.$layersControl),o.$layersControlListNano=$('<div class="nano"></div>').appendTo(o.$layersControlListWrap),o.$layersControlList=$('<div class="mapsvg-layers-list nano-content"></div>').appendTo(o.$layersControlListNano),o.$layersControl.appendTo(o.$mapContainer)),o.$layersControl.show(),o.$layersControlLabel.html(o.options.layersControl.label),o.$layersControlList.empty(),o.$layersControl.removeClass("mapsvg-top-left mapsvg-top-right mapsvg-bottom-left mapsvg-bottom-right"),o.$layersControl.addClass("mapsvg-"+o.options.layersControl.position),o.options.menu.on&&!o.options.menu.customContainer&&-1!==o.options.layersControl.position.indexOf("left")&&o.$layersControl.css("left",o.options.menu.width),o.$layersControl.css({"max-height":o.options.layersControl.maxHeight}),o.options.groups.forEach(function(e){$('<div class="mapsvg-layers-item" data-group-id="'+e.id+'"><input type="checkbox" class="ios8-switch ios8-switch-sm" '+(e.visible?"checked":"")+" /><label>"+e.title+"</label> </div>").appendTo(o.$layersControlList)}),o.$layersControlListNano.nanoScroller({preventPageScrolling:!0,iOSNativeScrolling:!0}),o.$layersControl.off(),o.$layersControl.on("click",".mapsvg-layers-item",function(){var t=$(this).data("group-id"),e=$(this).find("input");e.prop("checked",!e.prop("checked")),o.options.groups.forEach(function(e){e.id===t&&(e.visible=!e.visible)}),o.setGroups()}),o.$layersControlLabel.on("click",function(){o.$layersControl.toggleClass("closed")}),o.$layersControl.toggleClass("closed",!o.options.layersControl.expanded)):o.$layersControl&&o.$layersControl.hide()},setFloorsControl:function(e){var t=this;e&&$.extend(!0,t.options.floorsControl,e),t.options.floorsControl.on?(t.$floorsControl||(t.$floorsControl=$('<div class="mapsvg-floors-control"></div>'),t.$floorsControlLabel=$('<div class="mapsvg-floors-label"></div>').appendTo(t.$floorsControl),t.$floorsControlListWrap=$('<div class="mapsvg-floors-list-wrap"></div>').appendTo(t.$floorsControl),t.$floorsControlListNano=$('<div class="nano"></div>').appendTo(t.$floorsControlListWrap),t.$floorsControlList=$('<div class="mapsvg-floors-list nano-content"></div>').appendTo(t.$floorsControlListNano),t.$floorsControl.appendTo(t.$map)),t.$floorsControlLabel.html(t.options.floorsControl.label),t.$floorsControlList.empty(),t.$floorsControl.removeClass("mapsvg-top-left mapsvg-top-right mapsvg-bottom-left mapsvg-bottom-right"),t.$floorsControl.addClass("mapsvg-"+t.options.floorsControl.position),t.$floorsControl.css({"max-height":t.options.floorsControl.maxHeight}),t.options.floors.forEach(function(e){$('<div class="mapsvg-floors-item" data-floor-id="'+e.object_id+'"><label>'+e.title+"</label> </div>").appendTo(t.$floorsControlList)}),t.$floorsControlListNano.nanoScroller({preventPageScrolling:!0,iOSNativeScrolling:!0}),t.$floorsControl.off(),t.$floorsControl.on("click",".mapsvg-floors-item",function(){var e=$(this).data("floor-id");t.setFloor(e)}),t.$floorsControlLabel.on("click",function(){t.$floorsControl.toggleClass("closed")}),t.$floorsControl.toggleClass("closed",!t.options.floorsControl.expanded)):t.$floorsControl&&t.$floorsControl.hide()},setFloor:function(e){var t=this;t.$floorsControl.find(".mapsvg-floors-item").toggleClass("active",!1),t.$floorsControl.find('[data-floor-id="'+e+'"]').toggleClass("active",!0),t.options.floors.forEach(function(e){t.$svg.find("#"+e.object_id).hide()});var o=t.$svg.find("#"+e);o.show();e=(o=new MapObject(o,t)).getBBox();t._viewBox=e,t.setViewBox(t._viewBox),t.zoomLevels=null,t.zoomLevel=1,t.setZoom(),o=null},getGroupSelectOptions:function(){var t,e=[],o=[],i=[];return this.$svg.find("g").each(function(e){(t=$(this)[0].getAttribute("id"))&&o.push({label:t,value:t})}),e.push({title:"SVG Layers / Groups",options:o}),this.$svg.find("path,ellipse,circle,polyline,polygon,rectangle,img,text").each(function(e){(t=$(this)[0].getAttribute("id"))&&i.push({label:t,value:t})}),e.push({title:"Other SVG objects",options:i}),e},loadDataObjects:function(e){return this.database.getAll(e)},loadDirectory:function(){var e=this;if("database"===e.options.menu.source&&!e.database.loaded)return!1;e.options.menu.on&&e.controllers.directory.loadItemsToDirectory(),e.setPagination()},setPagination:function(){var e=this;e.$pagerMap&&e.$pagerMap.empty().remove(),e.$pagerDir&&e.$pagerDir.empty().remove(),e.options.database.pagination.on&&0!==e.options.database.pagination.perpage&&(e.$directory.toggleClass("mapsvg-with-pagination",-1!==["directory","both"].indexOf(e.options.database.pagination.showIn)),e.$map.toggleClass("mapsvg-with-pagination",-1!==["map","both"].indexOf(e.options.database.pagination.showIn)),e.options.menu.on&&(e.$pagerDir=e.getPagination(),e.controllers.directory.addPagination(e.$pagerDir)),e.$pagerMap=e.getPagination(),e.$map.append(e.$pagerMap))},getPagination:function(t){var o=this,e=$('<nav class="mapsvg-pagination"><ul class="pager">\x3c!--<li class="mapsvg-first"><a href="#">First</a></li>--\x3e<li class="mapsvg-prev"><a href="#">&larr; '+o.options.database.pagination.prev+" "+o.options.database.pagination.perpage+'</a></li><li class="mapsvg-next"><a href="#">'+o.options.database.pagination.next+" "+o.options.database.pagination.perpage+' &rarr;</a></li>\x3c!--<li class="mapsvg-last"><a href="#">Last</a></li>--\x3e</ul></nav>');return o.database.onFirstPage()&&o.database.onLastPage()?e.hide():(e.find(".mapsvg-prev").removeClass("disabled"),e.find(".mapsvg-first").removeClass("disabled"),e.find(".mapsvg-last").removeClass("disabled"),e.find(".mapsvg-next").removeClass("disabled"),o.database.onLastPage()&&e.find(".mapsvg-next").addClass("disabled")&&e.find(".mapsvg-last").addClass("disabled"),o.database.onFirstPage()&&e.find(".mapsvg-prev").addClass("disabled")&&e.find(".mapsvg-first").addClass("disabled")),e.on("click",".mapsvg-next:not(.disabled)",function(e){e.preventDefault(),o.database.onLastPage()||o.database.getAll({page:o.database.query.page+1}).done(function(){t&&t()})}).on("click",".mapsvg-prev:not(.disabled)",function(e){e.preventDefault(),o.database.onFirstPage()||o.database.getAll({page:o.database.query.page-1}).done(function(){t&&t()})}).on("click",".mapsvg-first:not(.disabled)",function(e){e.preventDefault(),o.database.onFirstPage()||o.database.getAll({page:1}).done(function(){t&&t()})}).on("click",".mapsvg-last:not(.disabled)",function(e){e.preventDefault(),o.database.onLastPage()||o.database.getAll({lastpage:!0}).done(function(){t&&t()})}),e},deleteMarkers:function(){for(;this.markers.length;)this.markers[0].delete&&this.markers[0].delete()},deleteClusters:function(){var e=this;if(e.markersClusters)for(;e.markersClusters.length;)e.markersClusters[0].destroy&&e.markersClusters[0].destroy(),e.markersClusters.splice(0,1);e.clusters={},e.markersClusters=[],e.markersClustersDict={}},addLocations:function(){var t=this;t.firstDataLoad=void 0===t.firstDataLoad;var e=this.database.getLoaded(),o=this.database.getSchemaFieldByType("location");if(!o)return!1;(o=o.name)&&(t.firstDataLoad&&t.setMarkerImagesDependency(),t.deleteMarkers(),t.deleteClusters(),t.clusters={},t.clustersByZoom=[],t.markersClusters=[],t.markersClustersDict={},e&&0<e.length&&(e.forEach(function(e){!e[o]||e[o]instanceof Location||!(e[o].lat&&e[o].lng||e[o].x&&e[o].y)||(e[o].img=t.getMarkerImage(e,e[o]),e[o]=new MapSVG.Location(e[o]),(e[o].lat&&e[o].lng||e[o].x&&e[o].y)&&new MapSVG.Marker({location:e[o],object:e,mapsvg:t}))}),t.options.clustering.on?t.startClusterizer():(e.forEach(function(e){e.location&&e.location.marker&&t.markerAdd(e.location.marker)}),t.mayBeFitMarkers())))},addClustersFromWorker:function(e,t){var o,i=this;for(o in i.clustersByZoom[e]=[],t){var s=t[o].markers.map(function(e){return i.database.getLoadedObject(e.id).location.marker});i.clustersByZoom[e].push(new MapSVG.MarkersCluster({mapsvg:i,markers:s,x:t[o].x,y:t[o].y,cellX:t[o].cellX,cellY:t[o].cellY}))}i.zoomLevel===e&&i.clusterizeMarkers()},startClusterizer:function(){var t=this;if(t.database&&0!==t.database.getLoaded().length){if(!t.database.getSchemaFieldByType("location"))return!1;t.clusterizerWorker||(t.clusterizerWorker=new Worker(MapSVG.urls.root+"js/clustering.js"),t.clusterizerWorker.onmessage=function(e){e.data.clusters&&t.addClustersFromWorker(e.data.zoomLevel,e.data.clusters)}),t.clusterizerWorker.postMessage({objects:t.database.getLoaded().filter(function(e){return e.location&&e.location.marker}).map(function(e){return{id:e.id,x:e.location.marker.x,y:e.location.marker.y}}),cellSize:50,mapWidth:t.$map.width(),zoomLevels:t.zoomLevels,zoomLevel:t.zoomLevel,zoomDelta:t.zoomDelta,svgViewBox:t.svgDefault.viewBox}),t.on("zoom",function(){t.clusterizerWorker.postMessage({message:"zoom",zoomLevel:t.zoomLevel})})}},clusterizeMarkers:function(e){var t=this;t.layers.markers.children().each(function(e,t){$(t).detach()}),t.markers=[],t.markersDict={},t.markersClusters=[],t.markersClustersDict={},t.clustersByZoom&&t.clustersByZoom[t.zoomLevel]&&t.clustersByZoom[t.zoomLevel].forEach(function(e){!(t.options.googleMaps.on&&t.googleMaps.map&&17<=t.googleMaps.map.getZoom())&&1<e.markers.length?t.markersClusterAdd(e):t.markerAdd(e.markers[0])}),t.editingMarker&&t.markerAdd(t.editingMarker),e||t.mayBeFitMarkers(),t.options.labelsMarkers.on&&t.setLabelsMarkers()},getCssUrl:function(){return MapSVG.urls.root+"css/mapsvg.css"},isGeo:function(){return this.mapIsGeo},functionFromString:function(e){var t,o=!1,e=e.trim();if(-1==e.indexOf("{")||0!==e.indexOf("function")||-1==e.indexOf("("))return{error:"MapSVG user function error: no function body."};var i=e.substring(e.indexOf("{")+1,e.lastIndexOf("}")),s=e.substring(e.indexOf("(")+1,e.indexOf(")"));try{t=new Function(s,i)}catch(e){o=e}return o||t},getOptions:function(e,t,o){var i=this,s=$.extend(!0,{},i.options);return $.extend(!0,s,o),s.viewBox=i._viewBox,s.filtersSchema=i.filtersSchema.getSchema(),s.filtersSchema&&(0===s.filtersSchema.length?s.filtersSchema=null:s.filtersSchema.forEach(function(e){"distance"==e.type&&(e.value="")})),delete s.markers,e&&(s.svgFilename=s.source.split("/").pop(),s.svgFiles=MapSVG.svgFiles),t&&$.each(s,function(e,t){JSON.stringify(t)==JSON.stringify(i.defaults[e])&&delete s[e]}),delete s.backend,s},on:function(e,t){this.lastChangeTime=Date.now(),this.events[e]||(this.events[e]=[]),this.events[e].push(t)},off:function(e){for(var t in this.events)this.events[t]&&0<this.events[t].length&&0===t.indexOf(e)&&e.length<=t&&(this.events[t]=[])},trigger:function(e){var t,o=this;for(t in o.events)o.events[t]&&0<o.events[t].length&&0===t.split(".")[0].indexOf(e)&&o.events[t].forEach(function(e){try{e&&e.call(o)}catch(e){console.log(e)}});$(window).trigger(e,o)},setEvents:function(e){var t,o,i=this;for(t in i.events=i.events||{},e)"string"==typeof e[t]?!(o=""!=e[t]?this.functionFromString(e[t]):null)||o.error||o instanceof TypeError||o instanceof SyntaxError?i.events[t]=null:i.events[t]=o:"function"==typeof e[t]&&(i.events[t]=e[t]),-1!==t.indexOf("directory")&&(o=t.split(".")[0],i.controllers&&i.controllers.directory&&(i.controllers.directory.events[o]=i.events[t]));$.extend(!0,i.options.events,e)},setActions:function(e){$.extend(!0,this.options.actions,e)},setDetailsView:function(e){var t=this;e=e||t.options.detailsView,$.extend(!0,t.options.detailsView,e),"top"===t.options.detailsView.location&&"left"===t.options.menu.position?t.options.detailsView.location="leftSidebar":"top"===t.options.detailsView.location&&"right"===t.options.menu.position&&(t.options.detailsView.location="rightSidebar"),"near"===t.options.detailsView.location&&(t.options.detailsView.location="map"),t.$details||(t.$details=$('<div class="mapsvg-details-container"></div>')),t.$details.toggleClass("mapsvg-details-container-relative",!(MapSVG.isPhone&&t.options.detailsView.mobileFullscreen||t.shouldBeScrollable(t.options.detailsView.location))),"custom"===t.options.detailsView.location?$("#"+t.options.detailsView.containerId).append(t.$details):(MapSVG.isPhone&&t.options.detailsView.mobileFullscreen?($("body").append(t.$details),t.$details.addClass("mapsvg-container-fullscreen")):t["$"+t.options.detailsView.location].append(t.$details),t.options.detailsView.margin&&t.$details.css("margin",t.options.detailsView.margin),t.$details.css("width",t.options.detailsView.width))},setMobileView:function(e){$.extend(!0,this.options.mobileView,e)},attachDataToRegions:function(e){var o=this;o.regions.forEach(function(e){e.objects=[]}),o.database.getLoaded().forEach(function(t,e){t.regions&&t.regions.length&&"object"==typeof t.regions&&t.regions.forEach(function(e){e=o.getRegion(e.id);e&&e.objects.push(t)})})},setTemplates:function(e){var t,o=this;for(t in o.templates=o.templates||{},e)if(null!=t){o.options.templates[t]=e[t];var i=o.options.templates[t];"directoryItem"!=t&&"directoryCategoryItem"!=t||(i='{{#each items}}<div id="mapsvg-directory-item-{{id}}" class="mapsvg-directory-item" data-object-id="{{id}}">'+o.options.templates.directoryItem+"</div>{{/each}}",o.options.menu.categories&&o.options.menu.categories.on&&o.options.menu.categories.groupBy&&(i='{{#each items}}{{#with category}}<div id="mapsvg-category-item-{{value}}" class="mapsvg-category-item" data-category-value="{{value}}">'+o.options.templates.directoryCategoryItem+'</div><div class="mapsvg-category-block" data-category-id="{{value}}">{{/with}}'+i+"</div>{{/each}}"),t="directory");try{o.templates[t]=Handlebars.compile(i,{strict:!1})}catch(e){console.error(e),o.templates[t]=Handlebars.compile("",{strict:!1})}o.editMode&&("directory"==t||"directoryCategoryItem"==t)&&o.controllers&&o.controllers.directory&&(o.controllers.directory.templates.main=o.templates[t],o.loadDirectory())}},setRegionStatus:function(e,t){(t=this.regionsDatabase.getSchemaField("status").optionsDict[t]).disabled?e.setDisabled(!0):e.setDisabled(!1),t.color?e.setFill(t.color):e.setFill()},update:function(e){var t,o,i=this;for(t in e)"regions"==t?$.each(e.regions,function(e,t){var o=i.getRegion(e);o&&o.update(t),null!=t.gaugeValue&&(i.updateGaugeMinMax(),i.regionsRedrawColors()),null!=t.disabled&&(i.deselectRegion(o),i.options.regions[e]=i.options.regions[e]||{},i.options.regions[e].disabled=o.disabled)}):"markers"==t?$.each(e.markers,function(e,t){e=i.getMarker(e);e&&e.update(t)}):(o="set"+MapSVG.ucfirst(t),"function"==typeof i[o]?this[o](e[t]):i.options[t]=e[t])},setTitle:function(e){e&&(this.options.title=e)},setExtension:function(e){e?this.options.extension=e:delete this.options.extension},setDisableLinks:function(e){(e=MapSVG.parseBoolean(e))?this.$map.on("click.a.mapsvg","a",function(e){e.preventDefault()}):this.$map.off("click.a.mapsvg"),this.disableLinks=e},setLoadingText:function(e){this.options.loadingText=e},setLockAspectRatio:function(e){this.options.lockAspectRatio=MapSVG.parseBoolean(e)},setOnClick:function(e){this.options.onClick=e||void 0},setMouseOver:function(e){this.options.mouseOver=e||void 0},setMouseOut:function(e){this.options.mouseOut=e||void 0},setBeforeLoad:function(e){this.options.beforeLoad=e||void 0},setAfterLoad:function(e){this.options.afterLoad=e||void 0},setPopoverShown:function(e){this.options.popoverShown=e||void 0},setMarkerEditHandler:function(e){this.markerEditHandler=e},setRegionChoroplethField:function(e){this.options.regionChoroplethField=e,this.redrawGauge()},setRegionEditHandler:function(e){this.regionEditHandler=e},setDisableAll:function(e){e=MapSVG.parseBoolean(e),$.extend(!0,this.options,{disableAll:e}),this.$map.toggleClass("mapsvg-disabled-regions",e)},setRegionStatuses:function(e){var t=this;t.options.regionStatuses=e;var o,i={};for(o in t.options.regionStatuses)i[o]=t.options.regionStatuses[o].color.length?t.options.regionStatuses[o].color:void 0;t.setColors({status:i})},setColorsIgnore:function(e){this.options.colorsIgnore=MapSVG.parseBoolean(e),this.regionsRedrawColors()},fixColorHash:function(e){var t=new RegExp(/^([0-9a-f]{3}|[0-9a-f]{6})$/i);return e=e&&null!==e.match(t)?"#"+e:e},setColors:function(e){var t,o=this;for(t in e)if("status"===t)for(var i in e[t])o.fixColorHash(e[t][i]);else"string"==typeof e[t]&&o.fixColorHash(e[t]);if($.extend(!0,o.options,{colors:e}),e&&e.status&&(o.options.colors.status=e.status),o.options.colors.markers)for(var s in o.options.colors.markers)for(var a in o.options.colors.markers[s])o.options.colors.markers[s][a]=parseInt(o.options.colors.markers[s][a]);o.options.colors.background&&o.$map.css({background:o.options.colors.background}),o.options.colors.hover&&(o.options.colors.hover=o.options.colors.hover==""+parseInt(o.options.colors.hover)?parseInt(o.options.colors.hover):o.options.colors.hover),o.options.colors.selected&&(o.options.colors.selected=o.options.colors.selected==""+parseInt(o.options.colors.selected)?parseInt(o.options.colors.selected):o.options.colors.selected),o.$leftSidebar.css({"background-color":o.options.colors.leftSidebar}),o.$rightSidebar.css({"background-color":o.options.colors.rightSidebar}),o.$header.css({"background-color":o.options.colors.header}),o.$footer.css({"background-color":o.options.colors.footer}),o.$details&&void 0!==o.options.colors.detailsView&&o.$details.css({"background-color":o.options.colors.detailsView}),o.$directory&&void 0!==o.options.colors.directory&&o.$directory.css({"background-color":o.options.colors.directory}),o.$filtersModal&&void 0!==o.options.colors.modalFilters&&o.$filtersModal.css({"background-color":o.options.colors.modalFilters}),o.$filters&&o.options.colors.directorySearch?o.$filters.css({"background-color":o.options.colors.directorySearch}):o.$filters&&o.$filters.css({"background-color":""}),o.clusterCSS=o.clusterCSS||$("<style></style>").appendTo("body");var n="";o.options.colors.clusters&&(n+="background-color: "+o.options.colors.clusters+";"),o.options.colors.clustersBorders&&(n+="border-color: "+o.options.colors.clustersBorders+";"),o.options.colors.clustersText&&(n+="color: "+o.options.colors.clustersText+";"),o.clusterCSS.html(".mapsvg-marker-cluster {"+n+"}"),o.clusterHoverCSS=o.clusterHoverCSS||$("<style></style>").appendTo("head");n="";o.options.colors.clustersHover&&(n+="background-color: "+o.options.colors.clustersHover+";"),o.options.colors.clustersHoverBorders&&(n+="border-color: "+o.options.colors.clustersHoverBorders+";"),o.options.colors.clustersHoverText&&(n+="color: "+o.options.colors.clustersHoverText+";"),o.clusterHoverCSS.html(".mapsvg-marker-cluster:hover {"+n+"}"),o.markersCSS=o.markersCSS||$("<style></style>").appendTo("head");n=".mapsvg-with-marker-active .mapsvg-marker {\n  opacity: "+o.options.colors.markers.inactive.opacity/100+";\n  -webkit-filter: grayscale("+(100-o.options.colors.markers.inactive.saturation)+"%);\n  filter: grayscale("+(100-o.options.colors.markers.inactive.saturation)+"%);\n}\n.mapsvg-with-marker-active .mapsvg-marker-active {\n  opacity: "+o.options.colors.markers.active.opacity/100+";\n  -webkit-filter: grayscale("+(100-o.options.colors.markers.active.saturation)+"%);\n  filter: grayscale("+(100-o.options.colors.markers.active.saturation)+"%);\n}\n.mapsvg-with-marker-hover .mapsvg-marker {\n  opacity: "+o.options.colors.markers.unhovered.opacity/100+";\n  -webkit-filter: grayscale("+(100-o.options.colors.markers.unhovered.saturation)+"%);\n  filter: grayscale("+(100-o.options.colors.markers.unhovered.saturation)+"%);\n}\n.mapsvg-with-marker-hover .mapsvg-marker-hover {\n  opacity: "+o.options.colors.markers.hovered.opacity/100+";\n  -webkit-filter: grayscale("+(100-o.options.colors.markers.hovered.saturation)+"%);\n  filter: grayscale("+(100-o.options.colors.markers.hovered.saturation)+"%);\n}\n";o.markersCSS.html(n),$.each(o.options.colors,function(e,t){null!==t&&""!=t||delete o.options.colors[e]}),o.regionsRedrawColors()},setTooltips:function(e){var i=this;void 0!==e.on&&(e.on=MapSVG.parseBoolean(e.on)),$.extend(!0,i.options,{tooltips:e}),i.tooltip=i.tooltip||{posOriginal:{},posShifted:{},posShiftedPrev:{},mirror:{}},i.tooltip.posOriginal={},i.tooltip.posShifted={},i.tooltip.posShiftedPrev={},i.tooltip.mirror={},i.tooltip.container?i.tooltip.container[0].className=i.tooltip.container[0].className.replace(/(^|\s)mapsvg-tt-\S+/g,""):(i.tooltip.container=$("<div />").addClass("mapsvg-tooltip"),i.$map.append(i.tooltip.container));e=i.options.tooltips.position.split("-");-1==e[0].indexOf("top")&&-1==e[0].indexOf("bottom")||(i.tooltip.posOriginal.topbottom=e[0]),-1==e[0].indexOf("left")&&-1==e[0].indexOf("right")||(i.tooltip.posOriginal.leftright=e[0]),e[1]&&(i.tooltip.posOriginal.leftright=e[1]);e="mousemove.tooltip.mapsvg-"+i.$map.attr("id");i.tooltip.container.addClass("mapsvg-tt-"+i.options.tooltips.position),i.tooltip.container.css({"min-width":i.options.tooltips.minWidth+"px","max-width":i.options.tooltips.maxWidth+"px"}),$("body").off(e).on(e,function(e){MapSVG.mouse=MapSVG.mouseCoords(e),i.tooltip.container[0].style.left=e.clientX+$(window).scrollLeft()-i.$map.offset().left+"px",i.tooltip.container[0].style.top=e.clientY+$(window).scrollTop()-i.$map.offset().top+"px";var t={x:e.clientX+$(window).scrollLeft(),y:e.clientY+$(window).scrollTop()},o=i.tooltip.container[0].getBoundingClientRect(),e=i.$wrap[0].getBoundingClientRect(),o={top:o.top+$(window).scrollTop(),bottom:o.bottom+$(window).scrollTop(),left:o.left+$(window).scrollLeft(),right:o.right+$(window).scrollLeft(),width:o.width,height:o.height};(e={top:e.top+$(window).scrollTop(),bottom:e.bottom+$(window).scrollTop(),left:e.left+$(window).scrollLeft(),right:e.right+$(window).scrollLeft(),width:e.width,height:e.height}).right<t.x||e.bottom<t.y||t.x<e.left||t.y<e.top||(i.tooltip.mirror.top||i.tooltip.mirror.bottom?i.tooltip.mirror.top&&t.y>i.tooltip.mirror.top?(i.tooltip.mirror.top=!1,delete i.tooltip.posShifted.topbottom):i.tooltip.mirror.bottom&&t.y<i.tooltip.mirror.bottom&&(i.tooltip.mirror.bottom=!1,delete i.tooltip.posShifted.topbottom):o.bottom<e.top+o.height?(i.tooltip.posShifted.topbottom="bottom",i.tooltip.mirror.top=t.y):e.bottom-o.height<o.top&&(i.tooltip.posShifted.topbottom="top",i.tooltip.mirror.bottom=t.y),i.tooltip.mirror.right||i.tooltip.mirror.left?i.tooltip.mirror.left&&t.x>i.tooltip.mirror.left?(i.tooltip.mirror.left=!1,delete i.tooltip.posShifted.leftright):i.tooltip.mirror.right&&t.x<i.tooltip.mirror.right&&(i.tooltip.mirror.right=!1,delete i.tooltip.posShifted.leftright):o.right<e.left+o.width?(i.tooltip.posShifted.leftright="right",i.tooltip.mirror.left=t.x):e.right-o.width<o.left&&(i.tooltip.posShifted.leftright="left",i.tooltip.mirror.right=t.x),o=[],(t=$.extend({},i.tooltip.posOriginal,i.tooltip.posShifted)).topbottom&&o.push(t.topbottom),t.leftright&&o.push(t.leftright),t=o.join("-"),i.tooltip.posShifted.topbottom==i.tooltip.posOriginal.topbottom&&i.tooltip.posShifted.leftright==i.tooltip.posOriginal.leftright||(i.tooltip.container[0].className=i.tooltip.container[0].className.replace(/(^|\s)mapsvg-tt-\S+/g,""),i.tooltip.container.addClass("mapsvg-tt-"+t),i.tooltip.posShiftedPrev=t))})},setPopovers:function(e){var t=this;void 0!==e.on&&(e.on=MapSVG.parseBoolean(e.on)),$.extend(t.options.popovers,e),t.$popover||(t.$popover=$("<div />").addClass("mapsvg-popover"),t.layers.popovers.append(t.$popover)),t.$popover.css({width:t.options.popovers.width+("auto"==t.options.popovers.width?"":"px"),"max-width":t.options.popovers.maxWidth+"%","max-height":t.options.popovers.maxHeight*t.$wrap.outerHeight()/100+"px"}),t.options.popovers.mobileFullscreen&&MapSVG.isPhone&&($("body").toggleClass("mapsvg-fullscreen-popovers",!0),t.$popover.appendTo("body"))},setRegionPrefix:function(e){this.options.regionPrefix=e},setInitialViewBox:function(e){var t=this;"string"==typeof e&&(e=e.trim().split(" ")),t._viewBox=[parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])],t.options.googleMaps.on&&(t.options.googleMaps.center=t.googleMaps.map.getCenter().toJSON(),t.options.googleMaps.zoom=t.googleMaps.map.getZoom()),t.zoomLevel=0},setViewBoxOnStart:function(){var e=this;e.viewBoxFull=e.svgDefault.viewBox,e.viewBoxFake=e.viewBox,e.whRatioFull=e.viewBoxFull[2]/e.viewBox[2],e.$svg[0].setAttribute("viewBox",e.viewBoxFull.join(" ")),(MapSVG.device.ios||MapSVG.device.android)&&1500<e.svgDefault.viewBox[2]?(e.iosDownscaleFactor=9999<e.svgDefault.viewBox[2]?100:10,e.$svg.css({width:e.svgDefault.viewBox[2]/e.iosDownscaleFactor})):e.$svg.css({width:e.svgDefault.viewBox[2]}),e.vbstart=1},setViewBox:function(e,t){var o=this,i=(e="string"==typeof e?e.trim().split(" "):e)&&4==e.length?e:o.svgDefault.viewBox,s=parseFloat(i[2])!=o.viewBox[2]||parseFloat(i[3])!=o.viewBox[3];o.viewBox=[parseFloat(i[0]),parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3])],o.whRatio=o.viewBox[2]/o.viewBox[3],o.vbstart||o.setViewBoxOnStart(),e||(o._viewBox=o.viewBox,o._scale=1);e=o.options.padding;e.top&&(o.viewBox[1]-=e.top,o.viewBox[3]+=e.top),e.right&&(o.viewBox[2]+=e.right),e.bottom&&(o.viewBox[3]+=e.bottom),e.left&&(o.viewBox[0]-=e.left,o.viewBox[2]+=e.left),o.scale=o.getScale(),o.superScale=o.whRatioFull*o.svgDefault.viewBox[2]/o.viewBox[2];e=o.svgDefault.viewBox[2]/o.$map.width();return o.superScale=o.superScale/e,(MapSVG.device.ios||MapSVG.device.android)&&1500<o.svgDefault.viewBox[2]&&(o.superScale*=o.iosDownscaleFactor),o.scroll=o.scroll||{},o.scroll.tx=Math.round((o.svgDefault.viewBox[0]-o.viewBox[0])*o.scale),o.scroll.ty=Math.round((o.svgDefault.viewBox[1]-o.viewBox[1])*o.scale),s&&(o.options.googleMaps.on||o.enableMarkersAnimation()),o.$scrollpane.css({transform:"translate("+o.scroll.tx+"px,"+o.scroll.ty+"px)"}),o.$svg.css({transform:"scale("+o.superScale+")"}),s&&!t&&o.updateSize(),s&&(o.options.googleMaps.on||setTimeout(function(){o.disableMarkersAnimation()},400),o.options.clustering.on?o.throttle(o.clusterizeOnZoom,400,o):o.trigger("zoom")),!0},enableMarkersAnimation:function(){this.$map.removeClass("no-transitions-markers")},disableMarkersAnimation:function(){this.$map.addClass("no-transitions-markers")},clusterizeOnZoom:function(){this.options.googleMaps.on&&this.googleMaps.map&&this.zoomDelta&&(this.zoomLevel=this.googleMaps.map.getZoom()-this.zoomDelta),this.trigger("zoom"),this.clusterizeMarkers(!0)},throttle:function(e,t,o,i){clearTimeout(e._tId),e._tId=setTimeout(function(){e.call(o,i)},t)},setViewBoxReal:function(e){var t=this;t.viewBoxFull=e,t.viewBoxFake=e,t.whRatioFull=t.viewBoxFull[2]/t.viewBox[2],t.viewBox=e,t.svgDefault.viewBox=t.viewBox,t.viewBoxFull=e,t.viewBoxFake=t.viewBox,t.whRatioFull=t.viewBoxFull[2]/t.viewBox[2],t.$svg[0].setAttribute("viewBox",t.viewBoxFull.join(" ")),t.scale=t.getScale();var o=-e[0]*t.scale,i=-e[1]*t.scale;t.$layers.css({transform:"translate("+o+"px,"+i+"px)"}),t.zoomLevel=0,t.setViewBox(e)},setViewBoxByGoogleMapBounds:function(){var e,t,o,i=this,s=i.googleMaps.map.getBounds();s&&(-180==(t=s.toJSON()).west&&180==t.east&&i.googleMaps.map.getCenter().toJSON(),e=[s.getNorthEast().lat(),s.getNorthEast().lng()],t=[s.getSouthWest().lat(),s.getSouthWest().lng()],s=i.convertGeoToSVG(e),e=i.convertGeoToSVG(t),s[0]<e[0]&&(o=i.svgDefault.viewBox[2]/i.mapLonDelta*360,e[0]=-(o-e[0])),t=s[0]-e[0],o=e[1]-s[1],i.setViewBox([e[0],s[1],t,o]))},redraw:function(){var e=this;MapSVG.browser.ie&&e.$svg.css({height:e.svgDefault.viewBox[3]}),e.options.googleMaps.on&&e.googleMaps.map?google.maps.event.trigger(e.googleMaps.map,"resize"):e.setViewBox(e.viewBox),e.$popover&&e.$popover.css({"max-height":e.options.popovers.maxHeight*e.$wrap.outerHeight()/100+"px"}),this.controllers&&this.controllers.directory&&(this.controllers.directory.updateTopShift(),this.controllers.directory.updateScroll()),e.updateSize()},setPadding:function(e){for(var t in e=e||this.options.padding)e[t]=e[t]?parseInt(e[t]):0;$.extend(this.options.padding,e),this.setViewBox(),this.trigger("sizeChange")},setSize:function(e,t,o){var i=this;return i.options.width=parseFloat(e),i.options.height=parseFloat(t),i.options.responsive=null!=o&&null!=o?MapSVG.parseBoolean(o):i.options.responsive,i.options.width||i.options.height?!i.options.width&&i.options.height?i.options.width=parseInt(i.options.height*i.svgDefault.width/i.svgDefault.height):i.options.width&&!i.options.height&&(i.options.height=parseInt(i.options.width*i.svgDefault.height/i.svgDefault.width)):(i.options.width=i.svgDefault.width,i.options.height=i.svgDefault.height),i.whRatio=i.options.width/i.options.height,i.scale=i.getScale(),i.setResponsive(o),i.markers&&i.markersAdjustPosition(),i.options.labelsRegions.on&&i.labelsRegionsAdjustPosition(),[i.options.width,i.options.height]},setResponsive:function(e){var t=this;e=null!=e?MapSVG.parseBoolean(e):t.options.responsive,t.$map.css({width:"100%",height:"0","padding-bottom":100*t.viewBox[3]/t.viewBox[2]+"%"}),e?t.$wrap.css({width:"100%",height:"auto"}):t.$wrap.css({width:t.options.width+"px",height:t.options.height+"px"}),$.extend(!0,t.options,{responsive:e}),t.resizeSensor||(t.resizeSensor=new MapSVG.ResizeSensor(t.$map[0],function(){t.redraw()})),t.redraw()},setScroll:function(e,t){null!=e.on&&(e.on=MapSVG.parseBoolean(e.on)),null!=e.limit&&(e.limit=MapSVG.parseBoolean(e.limit)),$.extend(!0,this.options,{scroll:e}),t||this.setEventHandlers()},setZoom:function(e){var s=this;null!=(e=e||{}).on&&(e.on=MapSVG.parseBoolean(e.on)),null!=e.fingers&&(e.fingers=MapSVG.parseBoolean(e.fingers)),null!=e.mousewheel&&(e.mousewheel=MapSVG.parseBoolean(e.mousewheel)),e.delta=2,e.limit&&("string"==typeof e.limit&&(e.limit=e.limit.split(";")),e.limit=[parseInt(e.limit[0]),parseInt(e.limit[1])]),s.zoomLevels||s.setZoomLevels(),$.extend(!0,s.options,{zoom:e}),s.$map.off("mousewheel.mapsvg"),s.options.zoom.mousewheel&&(MapSVG.browser.firefox&&(s.firefoxScroll={insideIframe:!1},s.$map.on("mouseenter",function(){s.firefoxScroll.insideIframe=!0,s.firefoxScroll.scrollX=window.scrollX,s.firefoxScroll.scrollY=window.scrollY}).on("mouseleave",function(){s.firefoxScroll.insideIframe=!1}),$(document).scroll(function(){s.firefoxScroll.insideIframe&&window.scrollTo(s.firefoxScroll.scrollX,s.firefoxScroll.scrollY)})),s.$map.on("mousewheel.mapsvg",function(e,t,o,i){if(!$(e.target).hasClass("mapsvg-popover")&&!$(e.target).closest(".mapsvg-popover").length){e.preventDefault();t=0<t?1:-1,e=MapSVG.mouseCoords(e);e.x=e.x-s.$svg.offset().left,e.y=e.y-s.$svg.offset().top;e=s.convertPixelToSVG([e.x,e.y]);return 0<t?s.zoomIn(e):s.zoomOut(e),!1}})),s.canZoom=!0},setControls:function(e){var t=this;e=e||{},$.extend(!0,t.options,{controls:e}),t.options.controls.zoom=MapSVG.parseBoolean(t.options.controls.zoom),t.options.controls.zoomReset=MapSVG.parseBoolean(t.options.controls.zoomReset),t.options.controls.userLocation=MapSVG.parseBoolean(t.options.controls.userLocation);var o,i,s,a,n=t.options.controls.location||"right";t.$controls||(o=$("<div />").addClass("mapsvg-buttons"),i=$("<div />").addClass("mapsvg-btn-group").appendTo(o),(s=$("<div />").addClass("mapsvg-btn-map mapsvg-in")).on("touchend click",function(e){e.cancelable&&e.preventDefault(),e.stopPropagation(),t.zoomIn()}),(a=$("<div />").addClass("mapsvg-btn-map mapsvg-out")).on("touchend click",function(e){e.cancelable&&e.preventDefault(),e.stopPropagation(),t.zoomOut()}),i.append(s).append(a),(e=$("<div />").addClass("mapsvg-btn-map mapsvg-btn-location")).on("touchend click",function(e){e.cancelable&&e.preventDefault(),e.stopPropagation(),t.showUserLocation(function(e){t.options.scroll.on&&t.centerOn(e.marker)})}),e.html('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 447.342 447.342" style="enable-background:new 0 0 447.342 447.342;" xml:space="preserve"><path d="M443.537,3.805c-3.84-3.84-9.686-4.893-14.625-2.613L7.553,195.239c-4.827,2.215-7.807,7.153-7.535,12.459 c0.254,5.305,3.727,9.908,8.762,11.63l129.476,44.289c21.349,7.314,38.125,24.089,45.438,45.438l44.321,129.509 c1.72,5.018,6.325,8.491,11.63,8.762c5.306,0.271,10.244-2.725,12.458-7.535L446.15,18.429 C448.428,13.491,447.377,7.644,443.537,3.805z"/></svg>'),(s=$("<div />").addClass("mapsvg-btn-group").appendTo(o)).append(e),(a=$("<div />").html('<svg height="14px" version="1.1" viewBox="0 0 14 14" width="14px" xmlns="http://www.w3.org/2000/svg" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns" xmlns:xlink="http://www.w3.org/1999/xlink"><g fill="none" fill-rule="evenodd" id="Page-1" stroke="none" stroke-width="1"><g fill="#000000" transform="translate(-215.000000, -257.000000)"><g id="fullscreen" transform="translate(215.000000, 257.000000)"><path d="M2,9 L0,9 L0,14 L5,14 L5,12 L2,12 L2,9 L2,9 Z M0,5 L2,5 L2,2 L5,2 L5,0 L0,0 L0,5 L0,5 Z M12,12 L9,12 L9,14 L14,14 L14,9 L12,9 L12,12 L12,12 Z M9,0 L9,2 L12,2 L12,5 L14,5 L14,0 L9,0 L9,0 Z" /></g></g></g></svg>').addClass("mapsvg-btn-map mapsvg-btn-zoom-reset")).on("touchend click",function(e){e.cancelable&&e.preventDefault(),e.stopPropagation(),t.viewBoxReset(!0)}),(e=$("<div />").addClass("mapsvg-btn-group").appendTo(o)).append(a),t.$controls=o,t.controls={zoom:i,userLocation:s,zoomReset:e},t.$map.append(t.$controls)),t.controls.zoom.toggle(t.options.controls.zoom),t.controls.userLocation.toggle(t.options.controls.userLocation),t.controls.zoomReset.toggle(t.options.controls.zoomReset),t.$controls.removeClass("left"),t.$controls.removeClass("right"),"right"==n&&t.$controls.addClass("right")||"left"==n&&t.$controls.addClass("left")},setZoomLevels:function(){var e=this;e.zoomLevels={};for(var t=1,o=0;o<=20;o++)e.zoomLevels[o+""]={_scale:t,viewBox:[0,0,e._viewBox[2]/t,e._viewBox[3]/t]},t*=e.options.zoom.delta;for(t=1,o=0;-20<=o;o--)e.zoomLevels[o+""]={_scale:t,viewBox:[0,0,e._viewBox[2]/t,e._viewBox[3]/t]},t/=e.options.zoom.delta},setZoomButtons:function(){var e,t,o=this,i=o.options.zoom.buttons.location||"hide";o.zoomButtons||(e=$("<div />").addClass("mapsvg-buttons"),t=$("<div />").addClass("mapsvg-btn-group").appendTo(e),e.zoomIn=$("<div />").addClass("mapsvg-btn-map mapsvg-in"),e.zoomIn.on("touchend click",function(e){e.stopPropagation(),o.zoomIn()}),e.zoomOut=$("<div />").addClass("mapsvg-btn-map mapsvg-out"),e.zoomOut.on("touchend click",function(e){e.stopPropagation(),o.zoomOut()}),t.append(e.zoomIn).append(e.zoomOut),e.location=$("<div />").addClass("mapsvg-btn-map mapsvg-btn-location"),e.location.on("touchend click",function(e){e.stopPropagation(),o.showUserLocation(function(){o.options.scroll.on&&o.centerOn(location.marker)})}),e.append(e.location),e.location.html('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 447.342 447.342" style="enable-background:new 0 0 447.342 447.342;" xml:space="preserve"><path d="M443.537,3.805c-3.84-3.84-9.686-4.893-14.625-2.613L7.553,195.239c-4.827,2.215-7.807,7.153-7.535,12.459 c0.254,5.305,3.727,9.908,8.762,11.63l129.476,44.289c21.349,7.314,38.125,24.089,45.438,45.438l44.321,129.509 c1.72,5.018,6.325,8.491,11.63,8.762c5.306,0.271,10.244-2.725,12.458-7.535L446.15,18.429 C448.428,13.491,447.377,7.644,443.537,3.805z"/></svg>'),o.zoomButtons=e,o.$map.append(o.zoomButtons)),o.zoomButtons.removeClass("left"),o.zoomButtons.removeClass("right"),"right"==i&&o.zoomButtons.addClass("right")||"left"==i&&o.zoomButtons.addClass("left"),o.options.zoom.on&&"hide"!=i?o.zoomButtons.show():o.zoomButtons.hide()},setManualRegions:function(e){this.options.manualRegions=MapSVG.parseBoolean(e)},setCursor:function(e){e="pointer"==e?"pointer":"default","pointer"==(this.options.cursor=e)?this.$map.addClass("mapsvg-cursor-pointer"):this.$map.removeClass("mapsvg-cursor-pointer")},setMultiSelect:function(e,t){this.options.multiSelect=MapSVG.parseBoolean(e),!1!==t&&this.deselectAllRegions()},setGauge:function(e){var t=this;null!=(e=e||t.options.gauge).on&&(e.on=MapSVG.parseBoolean(e.on)),$.extend(!0,t.options,{gauge:e});var o,i=!1;t.$gauge||(t.$gauge={},t.$gauge.gradient=$("<td>&nbsp;</td>").addClass("mapsvg-gauge-gradient"),t.setGaugeGradientCSS(),t.$gauge.container=$("<div />").addClass("mapsvg-gauge").hide(),t.$gauge.table=$("<table />"),o=$("<tr />"),t.$gauge.labelLow=$("<td>"+t.options.gauge.labels.low+"</td>"),t.$gauge.labelHigh=$("<td>"+t.options.gauge.labels.high+"</td>"),o.append(t.$gauge.labelLow),o.append(t.$gauge.gradient),o.append(t.$gauge.labelHigh),t.$gauge.table.append(o),t.$gauge.container.append(t.$gauge.table),t.$map.append(t.$gauge.container)),!t.options.gauge.on&&t.$gauge.container.is(":visible")?(t.$gauge.container.hide(),i=!0):t.options.gauge.on&&!t.$gauge.container.is(":visible")&&(t.$gauge.container.show(),i=!0,t.regionsDatabase.on("change",function(){t.redrawGauge()})),e.colors&&(t.options.gauge.colors.lowRGB=MapSVG.tinycolor(t.options.gauge.colors.low).toRgb(),t.options.gauge.colors.highRGB=MapSVG.tinycolor(t.options.gauge.colors.high).toRgb(),t.options.gauge.colors.diffRGB={r:t.options.gauge.colors.highRGB.r-t.options.gauge.colors.lowRGB.r,g:t.options.gauge.colors.highRGB.g-t.options.gauge.colors.lowRGB.g,b:t.options.gauge.colors.highRGB.b-t.options.gauge.colors.lowRGB.b,a:t.options.gauge.colors.highRGB.a-t.options.gauge.colors.lowRGB.a},i=!0,t.$gauge&&t.setGaugeGradientCSS()),e.labels&&(t.$gauge.labelLow.html(t.options.gauge.labels.low),t.$gauge.labelHigh.html(t.options.gauge.labels.high)),i&&t.redrawGauge()},redrawGauge:function(){this.updateGaugeMinMax(),this.regionsRedrawColors()},updateGaugeMinMax:function(){var t=this;t.options.gauge.min=0,t.options.gauge.max=!1;var o=[];t.regions.forEach(function(e){e=e.data&&e.data[t.options.regionChoroplethField];null!=e&&parseFloat(o.push(e))}),0<o.length&&(t.options.gauge.min=1==o.length?0:Math.min.apply(null,o),t.options.gauge.max=Math.max.apply(null,o),t.options.gauge.maxAdjusted=t.options.gauge.max-t.options.gauge.min)},setGaugeGradientCSS:function(){var e=this;e.$gauge.gradient.css({background:e.options.gauge.colors.low,background:"-moz-linear-gradient(left, "+e.options.gauge.colors.low+" 1%,"+e.options.gauge.colors.high+" 100%)",background:"-webkit-gradient(linear, left top, right top, color-stop(1%,"+e.options.gauge.colors.low+"), color-stop(100%,"+e.options.gauge.colors.high+"))",background:"-webkit-linear-gradient(left, "+e.options.gauge.colors.low+" 1%,"+e.options.gauge.colors.high+" 100%)",background:"-o-linear-gradient(left, "+e.options.gauge.colors.low+" 1%,"+e.options.gauge.colors.high+" 100% 100%)",background:"-ms-linear-gradient(left,  "+e.options.gauge.colors.low+" 1%,"+e.options.gauge.colors.high+" 100% 100%)",background:"linear-gradient(to right,"+e.options.gauge.colors.low+" 1%,"+e.options.gauge.colors.high+" 100%)",filter:'progid:DXImageTransform.Microsoft.gradient( startColorstr="'+e.options.gauge.colors.low+'", endColorstr="'+e.options.gauge.colors.high+'",GradientType=1 )'})},setCss:function(e){var t=this;t.options.css=e||t.options.css.replace(/%id%/g,this.id),t.liveCSS=t.liveCSS||$("<style></style>").appendTo("head"),t.liveCSS.html(t.options.css)},setFilters:function(e){var t=this;null!=(e=e||t.options.filters).on&&(e.on=MapSVG.parseBoolean(e.on)),null!=e.hide&&(e.hide=MapSVG.parseBoolean(e.hide)),$.extend(!0,t.options,{filters:e});-1===["leftSidebar","rightSidebar","header","footer","custom","mapContainer"].indexOf(t.options.filters.location)&&(t.options.filters.location="leftSidebar"),t.options.filters.on?(t.formBuilder&&t.formBuilder.destroy(),t.$filters||(t.$filters=$('<div class="mapsvg-filters-wrap"></div>')),t.$filters.empty(),t.$filters.show(),t.$filters.css({"background-color":t.options.colors.directorySearch}),t.$filtersModal&&t.$filtersModal.css({width:t.options.filters.width}),"custom"===t.options.filters.location?(t.$filters.removeClass("mapsvg-filter-container-custom").addClass("mapsvg-filter-container-custom"),$("#"+t.options.filters.containerId).length?$("#"+t.options.filters.containerId).append(t.$filters):(t.$filters.hide(),console.error("MapSVG: filter container #"+t.options.filters.containerId+" does not exists"))):MapSVG.isPhone?(t.$header.append(t.$filters),t.setContainers({header:{on:!0}})):(e="$"+(MapSVG.isPhone?"header":t.options.filters.location),t.options.menu.on&&t.controllers.directory&&t.options.menu.location===t.options.filters.location?(t.controllers.directory.view.find(".mapsvg-directory-filter-wrap").append(t.$filters),t.controllers.directory.updateTopShift()):(t[e].append(t.$filters),t.controllers.directory&&t.controllers.directory.updateTopShift())),t.loadFiltersController(t.$filters,!1),t.updateFiltersState()):t.$filters&&(t.$filters.empty(),t.$filters.hide()),t.options.menu.on&&t.controllers.directory&&t.options.menu.location===t.options.filters.location&&t.controllers.directory.updateTopShift()},updateFiltersState:function(){var o=this;if(o.$filterTags&&o.$filterTags.empty(),o.options.filters&&o.options.filters.on||o.database.query.filters&&0<Object.keys(o.database.query.filters).length)for(var e in o.database.query.filters){var t=o.database.query.filters[e],i=e,s=o.filtersSchema.getField(i);o.options.filters.on&&s?o.$filters.find('select[data-parameter-name="'+i+'"],radio[data-parameter-name="\'+_field_name+\'"]').data("ignoreSelect2Change",!0).val(t).trigger("change"):("regions"==e?(i="",t=o.getRegion(t).title||t):i=s&&s.label,"distance"!==e&&(o.$filterTags||(o.$filterTags=$('<div class="mapsvg-filter-tags"></div>'),o.$filters||(o.options.menu.on&&o.controllers.directory?(o.controllers.directory.toolbarView.append(o.$filterTags),o.controllers.directory.updateTopShift()):(o.$map.append(o.$filterTags),o.options.zoom.buttons.on&&(o.options.layersControl.on?"top-left"==o.options.layersControl.position?o.$filterTags.css({right:0,bottom:0}):o.$filterTags.css({bottom:0}):"left"==o.options.zoom.buttons.location&&o.$filterTags.css({right:0})))),o.$filterTags.on("click",".mapsvg-filter-delete",function(e){var t=$(this).data("filter");$(this).parent().remove(),o.database.query.filters[t]=null,delete o.database.query.filters[t],o.deselectAllRegions(),o.loadDataObjects()})),o.$filterTags.append('<div class="mapsvg-filter-tag">'+(i?i+": ":"")+t+' <span class="mapsvg-filter-delete" data-filter="'+e+'">×</span></div>')))}},setContainers:function(e){var t,o=this;for(t in o.containersCreated||(o.$wrapAll=$('<div class="mapsvg-wrap-all"></div>').attr("id","mapsvg-map-"+this.id).attr("data-map-id",this.id),o.$wrap=$('<div class="mapsvg-wrap"></div>'),o.$containers={},o.$mapContainer=$('<div class="mapsvg-map-container"></div>'),o.$leftSidebar=$('<div class="mapsvg-sidebar mapsvg-top-container mapsvg-sidebar-left"></div>'),o.$rightSidebar=$('<div class="mapsvg-sidebar mapsvg-top-container mapsvg-sidebar-right"></div>'),o.$header=$('<div class="mapsvg-header mapsvg-top-container"></div>'),o.$footer=$('<div class="mapsvg-footer mapsvg-top-container"></div>'),o.$wrapAll.insertBefore(o.$map),o.$wrapAll.append(o.$header),o.$wrapAll.append(o.$wrap),o.$wrapAll.append(o.$footer),o.$mapContainer.append(o.$map),o.$wrap.append(o.$leftSidebar),o.$wrap.append(o.$mapContainer),o.$wrap.append(o.$rightSidebar),o.containersCreated=!0),e=e||o.options){void 0!==e[t].on&&(e[t].on=MapSVG.parseBoolean(e[t].on)),$contName="$"+t,e[t].width&&(("string"!=typeof e[t].width||-1===e[t].width.indexOf("px")&&-1===e[t].width.indexOf("%")&&"auto"!==e[t].width)&&(e[t].width=e[t].width+"px"),o[$contName].css({"flex-basis":e[t].width})),e[t].height&&(("string"!=typeof e[t].height||-1===e[t].height.indexOf("px")&&-1===e[t].height.indexOf("%")&&"auto"!==e[t].height)&&(e[t].height=e[t].height+"px"),o[$contName].css({"flex-basis":e[t].height,height:e[t].height})),$.extend(!0,o.options,{containers:e});var i=o.options.containers[t].on;MapSVG.isPhone&&o.options.menu.hideOnMobile&&o.options.menu.location===t&&-1!==["leftSidebar","rightSidebar"].indexOf(t)?i=!1:MapSVG.isPhone&&"custom"===o.options.menu.location&&-1!==["leftSidebar","rightSidebar"].indexOf(t)?(i=!1,o.$wrapAll.addClass("mapsvg-hide-map-list-buttons")):MapSVG.isPhone&&!o.options.menu.hideOnMobile&&o.options.menu.location===t&&-1!==["leftSidebar","rightSidebar"].indexOf(t)&&(o.$wrapAll.addClass("mapsvg-hide-map-list-buttons"),o.$wrapAll.addClass("mapsvg-directory-visible")),o[$contName].toggle(i)}o.setDetailsView()},shouldBeScrollable:function(e){switch(e){case"mapContainer":case"leftSidebar":case"rightSidebar":return!0;case"custom":return!1;case"header":case"footer":return!(!this.options.containers[e].height||"auto"===this.options.containers[e].height||"100%"===this.options.containers[e].height);default:return!1}},setDirectory:function(e){return this.setMenu(e)},setMenu:function(e){var t,o=this;null!=(e=e||o.options.menu).on&&(e.on=MapSVG.parseBoolean(e.on)),null!=e.search&&(e.search=MapSVG.parseBoolean(e.search)),null!=e.showMapOnClick&&(e.showMapOnClick=MapSVG.parseBoolean(e.showMapOnClick)),null!=e.searchFallback&&(e.searchFallback=MapSVG.parseBoolean(e.searchFallback)),null!=e.customContainer&&(e.customContainer=MapSVG.parseBoolean(e.customContainer)),$.extend(!0,o.options,{menu:e}),o.controllers=o.controllers||{},o.$directory||(o.$directory=$('<div class="mapsvg-directory"></div>')),o.$directory.toggleClass("flex",o.shouldBeScrollable(o.options.menu.location)),o.options.menu.on?(o.controllers.directory?(o.controllers.directory.database="regions"===o.options.menu.source?o.regionsDatabase:o.database,o.controllers.directory.database.query.set({sort:[{field:o.options.menu.sortBy,order:o.options.menu.sortDirection}]}),o.controllers.directory.scrollable=o.shouldBeScrollable(o.options.menu.location),e.filterout&&((t={})[o.options.menu.filterout.field]=o.options.menu.filterout.val,o.controllers.directory.database.query.setFilterOut(t))):o.controllers.directory=new MapSVG.DirectoryController({container:o.$directory,data:o.getData(),template:o.templates.directory,mapsvg:o,filters:o.filters,database:"regions"===o.options.menu.source?o.regionsDatabase:o.database,scrollable:o.shouldBeScrollable(o.options.menu.location),events:{click:o.events["click.directoryItem"],mouseover:o.events["mouseover.directoryItem"],mouseout:o.events["mouseout.directoryItem"]}}),(MapSVG.isPhone&&o.options.menu.hideOnMobile?o.$leftSidebar:"custom"!==o.options.menu.location?o["$"+o.options.menu.location]:$("#"+o.options.menu.containerId)).append(o.$directory),o.options.colors.directory&&o.$directory.css({"background-color":o.options.colors.directory}),o.setFilters(),o.setTemplates({directoryItem:o.options.templates.directoryItem}),("regions"===o.options.menu.source&&o.regionsDatabase.loaded||"database"===o.options.menu.source&&o.database.loaded)&&(o.editMode&&(e.sortBy||e.sortDirection||e.filterout)&&o.controllers.directory.database.getAll(),o.loadDirectory())):(o.controllers.directory&&o.controllers.directory.destroy(),o.controllers.directory=null)},setDatabase:function(e){var t=this;(e=e||t.options.database).pagination&&(null!=e.pagination.on&&(e.pagination.on=MapSVG.parseBoolean(e.pagination.on)),null!=e.pagination.perpage&&(e.pagination.perpage=parseInt(e.pagination.perpage))),$.extend(!0,t.options,{database:e}),e.pagination&&(void 0!==e.pagination.on||e.pagination.perpage?(e={perpage:t.options.database.pagination.on?t.options.database.pagination.perpage:0},t.database.getAll(e)):t.setPagination())},setGoogleMaps:function(e){var t,o,a=this;function i(e,t){this.bounds_=e,this.map_=t,this.setMap(t),this.prevCoords={sw:{x:0,y:0},sw2:{x:0,y:0},ne:{x:0,y:0},ne2:{x:0,y:0}}}null!=(e=e||a.options.googleMaps).on&&(e.on=MapSVG.parseBoolean(e.on)),a.googleMaps||(a.googleMaps={loaded:!1,initialized:!1,map:null}),$.extend(!0,a.options,{googleMaps:e}),a.options.googleMaps.on?(a.$map.toggleClass("mapsvg-with-google-map",!0),MapSVG.googleMapsApiLoaded?a.googleMaps.map?(a.$map.toggleClass("mapsvg-with-google-map",!0),a.$googleMaps&&a.$googleMaps.show(),e.type&&a.googleMaps.map.setMapTypeId(e.type)):(a.$googleMaps=$('<div class="mapsvg-layer mapsvg-layer-gm" id="mapsvg-google-maps-'+a.id+'"></div>').prependTo(a.$map),a.$googleMaps.css({position:"absolute",top:0,left:0,bottom:0,right:0,"z-index":"0"}),a.googleMaps.map=new google.maps.Map(a.$googleMaps[0],{mapTypeId:e.type,fullscreenControl:!1,keyboardShortcuts:!1,mapTypeControl:!1,scaleControl:!1,scrollwheel:!1,streetViewControl:!1,zoomControl:!1,styles:e.styleJSON}),(i.prototype=new google.maps.OverlayView).onAdd=function(){var e=document.createElement("div");e.style.borderStyle="none",e.style.borderWidth="0px",e.style.position="absolute",this.div_=e,this.getPanes().overlayLayer.appendChild(e)},i.prototype.draw=function(e){if(!a.isScrolling){var t=this.getProjection();if(t){var o=this.bounds_.getSouthWest(),i=this.bounds_.getNorthEast(),s={};s.sw=t.fromLatLngToDivPixel(o),s.ne=t.fromLatLngToDivPixel(i),s.sw2=t.fromLatLngToContainerPixel(o),s.ne2=t.fromLatLngToContainerPixel(i);t=t.getWorldWidth();this.prevCoords.sw&&s.ne.x<s.sw.x&&(Math.abs(this.prevCoords.sw.x-s.sw.x)>Math.abs(this.prevCoords.ne.x-s.ne.x)?s.sw.x=s.sw.x-t:s.ne.x=s.ne.x+t,Math.abs(this.prevCoords.sw2.x-s.sw2.x)>Math.abs(this.prevCoords.ne2.x-s.ne2.x)?s.sw2.x=s.sw2.x-t:s.ne2.x=s.ne2.x+t),this.prevCoords;t=((this.prevCoords=s).ne2.x-s.sw2.x)/a.svgDefault.viewBox[2],t=[a.svgDefault.viewBox[0]-s.sw2.x/t,a.svgDefault.viewBox[1]-s.ne2.y/t,a.$map.width()/t,a.$map.outerHeight()/t];a.setViewBox(t)}}},t=new google.maps.LatLng(a.geoViewBox.bottomLat,a.geoViewBox.leftLon),o=new google.maps.LatLng(a.geoViewBox.topLat,a.geoViewBox.rightLon),e=new google.maps.LatLngBounds(t,o),a.googleMaps.overlay=new i(e,a.googleMaps.map),a.options.googleMaps.center&&a.options.googleMaps.zoom?(a.googleMaps.map.setZoom(a.options.googleMaps.zoom),a.options.googleMaps.center.lat=parseFloat(a.options.googleMaps.center.lat),a.options.googleMaps.center.lng=parseFloat(a.options.googleMaps.center.lng),a.googleMaps.map.setCenter(a.options.googleMaps.center)):(t=new google.maps.LatLng(a.geoViewBox.bottomLat,a.geoViewBox.leftLon),o=new google.maps.LatLng(a.geoViewBox.topLat,a.geoViewBox.rightLon),e=new google.maps.LatLngBounds(t,o),a.googleMaps.map.fitBounds(e,0)),a.options.googleMaps.initialized=!0,a.googleMaps.map.addListener("idle",function(){a.isZooming=!1}),google.maps.event.addListenerOnce(a.googleMaps.map,"idle",function(){setTimeout(function(){a.$map.addClass("mapsvg-fade-in"),setTimeout(function(){a.$map.removeClass("mapsvg-google-map-loading"),a.$map.removeClass("mapsvg-fade-in"),a.options.googleMaps.center&&a.options.googleMaps.zoom||(a.options.googleMaps.center=a.googleMaps.map.getCenter().toJSON(),a.options.googleMaps.zoom=a.googleMaps.map.getZoom()),a.zoomDelta=a.options.googleMaps.zoom-a.zoomLevel,a.trigger("googleMapsLoaded")},300)},1)})):a.loadGoogleMapsAPI(function(){a.setGoogleMaps()},function(){a.setGoogleMaps({on:!1})})):(a.$map.toggleClass("mapsvg-with-google-map",!1),a.$googleMaps&&a.$googleMaps.hide(),a.googleMaps.initialized=!1)},loadGoogleMapsAPI:function(t,e){var o,i,s=this;void 0!==window.google&&google.maps&&(MapSVG.googleMapsApiLoaded=!0),MapSVG.googleMapsApiLoaded?"function"==typeof t&&t():(MapSVG.googleMapsLoadCallbacks=MapSVG.googleMapsLoadCallbacks||[],"function"==typeof t&&MapSVG.googleMapsLoadCallbacks.push(t),MapSVG.googleMapsApiIsLoading||(MapSVG.googleMapsApiIsLoading=!0,window.gm_authFailure=function(){MapSVG.GoogleMapBadApiKey?MapSVG.GoogleMapBadApiKey():s.editMode?alert("Google maps API key is incorrect."):console.error("MapSVG: Google maps API key is incorrect.")},s.googleMapsScript=document.createElement("script"),s.googleMapsScript.onload=function(){MapSVG.googleMapsApiLoaded=!0,MapSVG.googleMapsLoadCallbacks.forEach(function(e){"function"==typeof t&&e()})},o=[],s.options.googleMaps.drawingTools&&o.push("drawing"),s.options.googleMaps.geometry&&o.push("geometry"),i="",0<o.length&&(i="&libraries="+o.join(",")),s.googleMapsScript.src="https://maps.googleapis.com/maps/api/js?language=en&key="+s.options.googleMaps.apiKey+i,document.head.appendChild(s.googleMapsScript)))},loadDetailsView:function(e){var t=this;t.popover&&t.popover.close(),t.detailsController&&t.detailsController.destroy(),t.detailsController=new MapSVG.DetailsController({autoresize:(!MapSVG.isPhone||!t.options.detailsView.mobileFullscreen||"custom"===t.options.detailsView.location)&&t.options.detailsView.autoresize,container:t.$details,template:e instanceof MapSVG.Region?t.templates.detailsViewRegion:t.templates.detailsView,mapsvg:t,data:e instanceof MapSVG.Region?e.forTemplate():e,modal:MapSVG.isPhone&&t.options.detailsView.mobileFullscreen&&"custom"!==t.options.detailsView.location,scrollable:MapSVG.isPhone&&t.options.detailsView.mobileFullscreen&&"custom"!==t.options.detailsView.location||t.shouldBeScrollable(t.options.detailsView.location),withToolbar:!(MapSVG.isPhone&&t.options.detailsView.mobileFullscreen&&"custom"!==t.options.detailsView.location)&&t.shouldBeScrollable(t.options.detailsView.location),events:{shown:function(e){if(t.events["shown.detailsView"])try{t.events["shown.detailsView"].call(this,t)}catch(e){console.log(e)}t.trigger("detailsShown")},closed:function(e){if(t.deselectAllRegions(),t.deselectAllMarkers(),t.controllers&&t.controllers.directory&&t.controllers.directory.deselectItems(),t.events["closed.detailsView"])try{t.events["closed.detailsView"].call(this,t)}catch(e){console.log(e)}t.trigger("detailsClosed")}}})},loadFiltersModal:function(){var e=this;"custom"!=e.options.filters.modalLocation?(e.$filtersModal=e.$filtersModal||$('<div class="mapsvg-details-container mapsvg-filters-wrap"></div>'),e.setColors(),e.$filtersModal.css({width:e.options.filters.width}),MapSVG.isPhone?($("body").append(e.$filtersModal),e.$filtersModal.css({width:""})):e["$"+e.options.filters.modalLocation].append(e.$filtersModal)):(e.$filtersModal=$("#"+e.options.filters.containerId),e.$filtersModal.css({width:""})),e.loadFiltersController(e.$filtersModal,!0)},loadFiltersController:function(e,t){var a,n,o,r=this;r.filtersSchema.getSchema()&&(a="regions"===r.options.filters.source?r.regionsDatabase:r.database,t=void 0!==t&&t,n=MapSVG.isPhone?(o=!0,r.options.filters.hideOnMobile):(o=r.options.menu.on&&r.controllers.directory&&r.options.menu.location===r.options.filters.location,r.options.filters.hide),o=t||!o&&-1!==["leftSidebar","rightSidebar"].indexOf(r.options.filters.location),new MapSVG.FiltersController({container:e,template:Handlebars.compile('<div class="mapsvg-filters-container"></div>'),mapsvg:r,data:{},scrollable:o,modal:t,withToolbar:!MapSVG.isPhone&&!0===t,width:e.hasClass("mapsvg-map-container")?r.options.filters.width:"100%",events:{shown:function(e){var i=this,s=new MapSVG.FormBuilder({container:this.contentView,filtersMode:!0,schema:r.filtersSchema.getSchema(),modal:t,filtersHide:n,editMode:!1,mapsvg:r,data:a.query.filters,admin:!1,events:{load:function(t){var e,o;t.container.find(".mapsvg-form-builder").css({padding:r.options.filters.padding}),i.updateScroll(),n&&((e=function(){var e=0<(e=Object.keys(a.query.filters).length)?e:"";a.query.filters.search&&0<a.query.filters.search.length&&e--,e=0===e?"":e,t&&t.showFiltersButton&&t.showFiltersButton.views.result.find("button").html(r.getData().options.filters.showButtonText+" <b>"+e+"</b>")})(),a.on("dataLoaded",function(){e()})),r.options.filters.clearButton&&(o=$('<div class="form-group mapsvg-filters-reset-container"><button class="btn btn-default mapsvg-filters-reset">'+r.options.filters.clearButtonText+"</button></div>"),t.container.find(".mapsvg-data-form-view").append(o),o.on("click",function(){t.container.find("input").not(":button, :submit, :reset, :hidden, :checkbox, :radio").val("").prop("selected",!1),t.container.find('input[type="radio"]').prop("checked",!1),t.container.find('input[type="checkbox"]').prop("checked",!1),a.query.filters={},r.deselectAllRegions(),t.container.find("select").val("").trigger("change.select2"),a.getAll()})),r.controllers.directory&&r.controllers.directory.updateTopShift()}}});s.view.on("click",".mapsvg-btn-show-filters",function(){r.loadFiltersModal()}),s.view.on("paste keyup",'input[data-parameter-name="search"]',function(){r.throttle(r.textSearch,600,r,$(this))}),s.view.on("change paste keyup",'select,input[type="radio"],input',function(){var o,e,i,t;$(this).data("ignoreSelect2Change")?$(this).data("ignoreSelect2Change",!1):(o={},i=$(this).data("parameter-name"),"search"!=$(this).attr("data-parameter-name")&&"distanceAddress"!==$(this).attr("name")&&"search"!=i&&("distanceLatLng"===$(this).attr("name")||"distanceLength"===$(this).attr("name")?(e={units:s.view.find('[name="distanceUnits"]').val(),latlng:s.view.find('[name="distanceLatLng"]').val(),length:s.view.find('[name="distanceLength"]').val(),address:s.view.find('[name="distanceAddress"]').val()},(i=s.mapsvg.filtersSchema.schema.find(function(e){return"distance"===e.type})).country&&(e.country=i.country),e.units&&e.length&&e.latlng?(t=(o.distance=e).latlng.split(","),t={lat:parseFloat(t[0]),lng:parseFloat(t[1])},MapSVG.distanceSearch={latlng:t,units:i.distanceUnits,unitsLabel:i.distanceUnitsLabel}):(o.distance=null,MapSVG.distanceSearch=null)):0<$(this).closest(".mapsvg-checkbox-group").length?(o[i]=[],$(this).closest(".mapsvg-checkbox-group").find('input[type="checkbox"]:checked').each(function(e,t){o[i].push($(t).val())})):o[i]=$(this).val(),a.query.setFilters(o),t={filters:o},a.getAll(t)))})},closed:function(e){}}}))},textSearch:function(e){var t={search:e.val()},o="regions"===this.getData().options.filters.source?this.regionsDatabase:this.database;o.query.setFilters(t);t={filters:t};t.searchFallback=MapSVG.parseBoolean(e.attr("data-fallback")),o.getAll(t)},getRegion:function(e){return this.regions[this.regionsDict[e]]},getRegions:function(e){return _this.regions},getMarker:function(e){return this.markers[this.markersDict[e]]},checkId:function(e){return this.getRegion(e)?{error:"This ID is already being used by a Region"}:!this.getMarker(e)||{error:"This ID is already being used by another Marker"}},regionsRedrawColors:function(){this.regions.forEach(function(e){e.setFill()})},destroy:function(){var e=this;return e.controllers&&e.controllers.directory&&e.controllers.directory.mobileButtons.remove(),e.$map.empty().insertBefore(e.$wrapAll).attr("style","").removeClass("mapsvg mapsvg-responsive"),e.popover&&e.popover.close(),e.detailsController&&e.detailsController.destroy(),e.$wrapAll.remove(),e},getData:function(){return this},mayBeFitMarkers:function(){var e=this;this.lastTimeFitWas||(this.lastTimeFitWas=Date.now()-99999),this.fitDelta=Date.now()-this.lastTimeFitWas,1e3<this.fitDelta&&!e.firstDataLoad&&!e.fitOnDataLoadDone&&e.options.fitMarkers&&(e.fitMarkers(),e.fitOnDataLoadDone=!0),e.firstDataLoad&&(e.options.fitMarkersOnStart||e.options.fitMarkers&&!1===e.options.database.loadOnStart)&&(e.firstDataLoad=!1,e.options.googleMaps.on&&!e.googleMaps.map?e.on("googleMapsLoaded",function(){e.fitMarkers()}):e.fitMarkers()),this.lastTimeFitWas=Date.now()},fitMarkers:function(){var e=this,t=e.database.getLoaded();if(t&&0!==t.length){if(!e.options.googleMaps.on||"undefined"==typeof google)return e.getOptions().clustering.on?e.zoomTo(e.markersClusters.concat(e.markers)):e.zoomTo(e.markers);var o,i,s,a,n=[],r=[];1<t.length?(t.forEach(function(e){e.location&&e.location.lat&&e.location.lng&&(n.push(e.location.lat),r.push(e.location.lng))}),o=Math.min.apply(null,n),i=Math.max.apply(null,n),s=Math.min.apply(null,r),a=Math.max.apply(null,r),a=new google.maps.LatLngBounds({lat:o,lng:s},{lat:i,lng:a}),e.googleMaps.map.fitBounds(a,0)):t[0].location&&t[0].location.lat&&t[0].location.lng&&(t={lat:t[0].location.lat,lng:t[0].location.lng},e.googleMaps.map&&(e.googleMaps.map.setCenter(t),t=e.googleMaps.zoomLimit?17:20,e.googleMaps.map.setZoom(t)))}},showUserLocation:function(t){var o=this;this.getUserLocation(function(e){o.userLocation=null,o.userLocation=new MapSVG.Location({lat:e.lat,lng:e.lng,img:mapsvg_paths.root+"/markers/user-location.svg"}),o.userLocationMarker&&o.userLocationMarker.delete(),o.userLocationMarker=new MapSVG.Marker({location:o.userLocation,mapsvg:o,width:15,height:15}),o.userLocationMarker.node.addClass("mapsvg-user-location"),o.userLocationMarker.centered=!0,o.$scrollpane.append(o.userLocationMarker.node),o.userLocationMarker.adjustPosition(),t&&t(o.userLocation)})},getUserLocation:function(t){if(!navigator.geolocation)return!1;navigator.geolocation.getCurrentPosition(function(e){e={lat:e.coords.latitude,lng:e.coords.longitude};t&&t(e)})},getScale:function(){return this.$map.width()/this.viewBox[2]||1},updateSize:function(){var e=this;e.scale=e.getScale(),e.popover&&e.popover.adjustPosition(),e.markersAdjustPosition(),e.options.labelsRegions.on&&e.labelsRegionsAdjustPosition(),e.mapAdjustStrokes(),e.directoryWrap&&e.directoryWrap.height(e.$wrap.outerHeight())},getViewBox:function(){return this.viewBox},viewBoxSetBySize:function(e,t){var o=this;return e=parseFloat(e),t=parseFloat(t),o.setSize(e,t),o._viewBox=o.viewBoxGetBySize(e,t),o.setViewBox(o._viewBox),$(window).trigger("resize"),o.setSize(e,t),o.setZoomLevels(),o.viewBox},viewBoxGetBySize:function(e,t){var o=this,i=e/t,e=o.svgDefault.viewBox[2]/o.svgDefault.viewBox[3],t=$.extend([],o.svgDefault.viewBox);return i!=e&&(e<i?(t[2]=o.svgDefault.viewBox[3]*i,t[0]=o.svgDefault.viewBox[0]-(t[2]-o.svgDefault.viewBox[2])/2):(t[3]=o.svgDefault.viewBox[2]/i,t[1]=o.svgDefault.viewBox[1]-(t[3]-o.svgDefault.viewBox[3])/2)),t},viewBoxReset:function(e){var t,o,i=this;return i.options.googleMaps.on&&i.googleMaps.map?(e||(i.options.googleMaps.center=null,i.options.googleMaps.zoom=null),i.options.googleMaps.center&&i.options.googleMaps.zoom?(i.googleMaps.map.setZoom(i.options.googleMaps.zoom),i.googleMaps.map.setCenter(i.options.googleMaps.center)):(t=new google.maps.LatLng(i.geoViewBox.bottomLat,i.geoViewBox.leftLon),o=new google.maps.LatLng(i.geoViewBox.topLat,i.geoViewBox.rightLon),o=new google.maps.LatLngBounds(t,o),i.googleMaps.map.fitBounds(o,0),i.options.googleMaps.center=i.googleMaps.map.getCenter().toJSON(),i.options.googleMaps.zoom=i.googleMaps.map.getZoom())):e?(e=i._viewBox||i.svgDefault.viewBox,i.zoomLevel=0,i._scale=1,i.setViewBox(e)):i.setViewBox(),this.viewBox},getGeoViewBox:function(){var e=this,t=e.viewBox,o=e.convertSVGToGeo(t[0],t[1])[1],i=e.convertSVGToGeo(t[0]+t[2],t[1])[1];return[o,e.convertSVGToGeo(t[0],t[1])[0],i,e.convertSVGToGeo(t[0],t[1]+t[3])[0]]},mapAdjustStrokes:function(){var t=this;t.$svg.find("path, polygon, circle, ellipse, rect").each(function(e){$(this).data("stroke-width")&&$(this).css("stroke-width",$(this).data("stroke-width")/t.scale)})},zoomIn:function(e){var t=this;if(t.googleMaps.map){if(!t.isZooming){var o=t.zoomLevel>=t.options.zoom.limit[0]&&t.zoomLevel<=t.options.zoom.limit[1],i=t.googleMaps.map.getZoom(),s=t.googleMaps.zoomLimit?17:20,a=s<i+1?s:i+1,s=a-t.zoomDelta,i=s>=t.options.zoom.limit[0]&&s<=t.options.zoom.limit[1];if(o&&!i)return!1;t.isZooming=!0,t.googleMaps.map.setZoom(a),e&&(e=t.convertSVGToGeo(e[0],e[1]),t.googleMaps.map.setCenter({lat:e[0],lng:e[1]})),t.zoomLevel=s}}else t.canZoom&&(t.canZoom=!1,setTimeout(function(){t.canZoom=!0},700),t.zoom(1,e))},zoomOut:function(e){var t=this;if(t.googleMaps.map){if(!t.isZooming&&t.googleMaps.map.getZoom()-1>=t.options.googleMaps.minZoom){var o=t.zoomLevel>=t.options.zoom.limit[0]&&t.zoomLevel<=t.options.zoom.limit[1],i=t.googleMaps.map.getZoom(),s=i-1<1?1:i-1,a=s-t.zoomDelta,i=a>=t.options.zoom.limit[0]&&a<=t.options.zoom.limit[1];if(o&&!i)return!1;t.isZooming=!0,t.googleMaps.map.setZoom(s),t.zoomLevel=a}}else t.canZoom&&(t.canZoom=!1,setTimeout(function(){t.canZoom=!0},700),t.zoom(-1,e))},_touchZoomStart:function(e){var t=this;t._scale;t.scale=t.scale*zoom_k;t._scale;t._scale=t._scale*zoom_k;var o=t.viewBox[2],i=t.viewBox[3],s=[];s[2]=t._viewBox[2]/t._scale,s[3]=t._viewBox[3]/t._scale,s[0]=t.viewBox[0]+(o-s[2])/2,s[1]=viewBox[1]+(i-s[3])/2,t.setViewBox(s)},touchZoomMove:function(){},touchZoomEnd:function(){},zoomTo:function(e,o){var i=this;if(o=null!=o&&parseInt(o),"string"==typeof e&&(e=i.getRegion(e)),i.googleMaps.map)if(e instanceof MapSVG.Marker){var t=i.convertSVGToGeo(e.x,e.y);i.googleMaps.map.setZoom(o||1),i.googleMaps.map.setCenter({lat:t[0],lng:t[1]}),this.zoomLevel=this.googleMaps.map.getZoom()-this.zoomDelta}else{if(e&&void 0!==e.length)for(var s=e[0].getGeoBounds(),a=new google.maps.LatLng(s.sw[0],s.sw[1]),n=new google.maps.LatLng(s.ne[0],s.ne[1]),r=new google.maps.LatLngBounds(a,n),l=1;l<e.length-1;l++){var p=e[l].getGeoBounds(),c=new google.maps.LatLng(p.sw[0],p.sw[1]),p=new google.maps.LatLng(p.ne[0],p.ne[1]);r.extend(c),r.extend(p)}else r=e.getGeoBounds(),a=new google.maps.LatLng(r.sw[0],r.sw[1]),n=new google.maps.LatLng(r.ne[0],r.ne[1]),r=new google.maps.LatLngBounds(a,n);i.googleMaps.map.fitBounds(r,0),i.googleMaps.zoomLimit&&17<i.googleMaps.map.getZoom()&&i.googleMaps.map.setZoom(17),this.zoomLevel=this.googleMaps.map.getZoom()-this.zoomDelta}else{var g=[],d=[];if(e instanceof MapSVG.Marker||e instanceof MapSVG.MarkersCluster)return i.zoomToMarkerOrCluster(e,o);if("object"==typeof e&&void 0!==e.length){if(e[0]instanceof MapSVG.Region){var h=[(g=e[0].getBBox())[0]],u=[g[1]],m=[y=g[0]+g[2]],v=[w=g[1]+g[3]];if(1<e.length)for(l=1;l<e.length;l++){b=e[l].getBBox(),h.push(b[0]),u.push(b[1]);var f=b[0]+b[2],b=b[1]+b[3];m.push(f),v.push(b)}var h=Math.min.apply(Math,h),u=Math.min.apply(Math,u),y=Math.max.apply(Math,m)-h,w=Math.max.apply(Math,v)-u;g=[h,u,y,w]}else if(e[0]instanceof MapSVG.Marker||e[0]instanceof MapSVG.MarkersCluster){var S=[],M=[];if(1===e.length)return i.zoomToMarkerOrCluster(e[0]);e.forEach(function(e){S.push(e.x),M.push(e.y)});s=Math.min.apply(null,S),a=Math.max.apply(null,S),n=Math.min.apply(null,M),y=Math.max.apply(null,M),w=10,w=i.convertPixelToSVG([10,0])[0]-i.convertPixelToSVG([0,0])[0];g=[s-w,n-w,a-s+2*w,y-n+2*w]}}else g=e.getBBox();var d=[],x=!0;$.each(i.zoomLevels,function(e,t){x&&d&&d.length&&d[2]>g[2]&&d[3]>g[3]&&(g[2]>t.viewBox[2]||g[3]>t.viewBox[3])&&(i.zoomLevel=o||parseInt(e)-1,e=i.zoomLevels[i.zoomLevel].viewBox,i.setViewBox([g[0]-e[2]/2+g[2]/2,g[1]-e[3]/2+g[3]/2,e[2],e[3]]),i._scale=i.zoomLevels[i.zoomLevel]._scale,x=!1),d=t&&t.viewBox})}},zoomToMarkerOrCluster:function(e,t){var o=this;o.zoomLevel=t||1;t=o.zoomLevels[o.zoomLevel].viewBox;o.setViewBox([e.x-t[2]/2,e.y-t[3]/2,t[2],t[3]]),o._scale=o.zoomLevels[o.zoomLevel]._scale},centerOn:function(e,t){var o,i=this;i.options.googleMaps.on?(t=t?(t+12)/i.getScale():0,i.$map.addClass("scrolling"),o=e.getCenterLatLng(t),i.googleMaps.map.panTo(o),setTimeout(function(){i.$map.removeClass("scrolling")},100)):(t=t?(t+12)/i.getScale():0,o=e.getBBox(),e=i.viewBox,i.setViewBox([o[0]-e[2]/2+o[2]/2,o[1]-e[3]/2+o[3]/2-t,e[2],e[3]]))},zoom:function(e,t,o){var i=this,s=i.viewBox[2],a=i.viewBox[3],n=[],r=i.zoomLevel>=i.options.zoom.limit[0]&&i.zoomLevel<=i.options.zoom.limit[1];if(o)n[2]=i._viewBox[2]/o,n[3]=i._viewBox[3]/o;else{var l=0<e?1:-1;if(!i.zoomLevels[i.zoomLevel+l])return;if(i._zoomLevel=i.zoomLevel,i._zoomLevel+=l,r&&(i._zoomLevel>i.options.zoom.limit[1]||i._zoomLevel<i.options.zoom.limit[0]))return!1;i.zoomLevel=i._zoomLevel;var p=i.zoomLevels[i.zoomLevel];i._scale=p._scale,n=p.viewBox}p=[];p=t?(l=0<l?.5:-1,[(t[0]-i.viewBox[0])*l,(t[1]-i.viewBox[1])*l]):[(s-n[2])/2,(a-n[3])/2],n[0]=i.viewBox[0]+p[0],n[1]=i.viewBox[1]+p[1],i.options.scroll.limit&&(n[0]<i.svgDefault.viewBox[0]?n[0]=i.svgDefault.viewBox[0]:n[0]+n[2]>i.svgDefault.viewBox[0]+i.svgDefault.viewBox[2]&&(n[0]=i.svgDefault.viewBox[0]+i.svgDefault.viewBox[2]-n[2]),n[1]<i.svgDefault.viewBox[1]?n[1]=i.svgDefault.viewBox[1]:n[1]+n[3]>i.svgDefault.viewBox[1]+i.svgDefault.viewBox[3]&&(n[1]=i.svgDefault.viewBox[1]+i.svgDefault.viewBox[3]-n[3])),i.setViewBox(n)},markerDelete:function(e){var t=this;t.editingMarker&&t.editingMarker.id==e.id&&(t.editingMarker=null,delete t.editingMarker),t.markers.splice(t.markersDict[e.id],1),t.updateMarkersDict(),e=null,0==t.markers.length&&(t.options.markerLastID=0)},markersClusterAdd:function(e){this.layers.markers.append(e.node),this.markersClusters.push(e),e.adjustPosition()},markerAdd:function(e){e.node.hide(),e.adjustPosition(),this.layers.markers.append(e.node),this.markers.push(e),e.mapped=!0,this.markersDict[e.id]=this.markers.length-1,setTimeout(function(){e.node.show()},100)},markerRemove:function(e){e.node.detach(),e.show(),this.markers.splice(this.markersDict[e.id],1),e.mapped=!1,this.updateMarkersDict()},markerId:function(){var e=this;e.options.markerLastID=e.options.markerLastID+1;var t="marker_"+e.options.markerLastID;return e.getMarker(t)?e.markerId():t},labelsRegionsAdjustPosition:function(){var o=this;o.$map.is(":visible")&&o.regions.forEach(function(e){e.center||(e.center=e.getCenterSVG());var t=o.convertSVGToPixel([e.center.x,e.center.y]);e.textLabel&&(e.textLabel[0].style.transform="translate(-50%,-50%) translate("+t[0]+"px,"+t[1]+"px)")})},markersAdjustPosition:function(){var t=this;t.markers.forEach(function(e){e.adjustPosition(t.scale)}),t.markersClusters.forEach(function(e){e.adjustPosition()}),t.userLocationMarker&&t.userLocationMarker.adjustPosition()},markerMoveStart:function(){this.data("ox",parseFloat(this.attr("x"))),this.data("oy",parseFloat(this.attr("y")))},markerMove:function(e,t){e/=this.scale,t/=this.scale,this.attr({x:this.data("ox")+e,y:this.data("oy")+t})},markerMoveEnd:function(){this.data("ox")==this.attr("x")&&this.data("oy")==this.attr("y")&&options.markerEditHandler.call(this)},setEditingMarker:function(e){var t=this;t.editingMarker=e,t.editingMarker.mapped||(t.editingMarker.needToRemove=!0,t.markerAdd(t.editingMarker))},unsetEditingMarker:function(){var e=this;e.editingMarker&&e.editingMarker.needToRemove&&e.markerRemove(e.editingMarker),e.editingMarker=null},getEditingMarker:function(){return this.editingMarker},scrollStart:function(e,t){var o=this;if($(e.target).hasClass("mapsvg-btn-map")||$(e.target).closest(".mapsvg-gauge").length)return!1;if(o.editMarkers.on&&"mapsvg-marker"==$(e.target).hasClass("class"))return!1;e.preventDefault();var i=e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches[0]?e.originalEvent.touches[0]:e;o.scrollStarted=!0,o.scroll=o.scroll||{},o.scroll.vxi=o.viewBox[0],o.scroll.vyi=o.viewBox[1],o.scroll.x=i.clientX,o.scroll.y=i.clientY,o.scroll.dx=0,o.scroll.dy=0,o.scroll.vx=0,o.scroll.vy=0,o.scroll.gx=i.clientX,o.scroll.gy=i.clientY,o.scroll.tx=o.scroll.tx||0,o.scroll.ty=o.scroll.ty||0,0===e.type.indexOf("mouse")&&($(document).on("mousemove.scroll.mapsvg",function(e){o.scrollMove(e)}),o.options.scroll.spacebar?$(document).on("keyup.scroll.mapsvg",function(e){32==e.keyCode&&o.scrollEnd(e,t)}):$(document).on("mouseup.scroll.mapsvg",function(e){o.scrollEnd(e,t)}))},scrollMove:function(e){var t=this;e.preventDefault(),t.isScrolling||(t.isScrolling=!0,t.$map.addClass("scrolling"));var o,i=e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches[0]?e.originalEvent.touches[0]:e,s=t.panBy(t.scroll.gx-i.clientX,t.scroll.gy-i.clientY);t.googleMaps.map&&(s.x||s.y)&&(a=t.googleMaps.map.getCenter(),(e=(o=t.googleMaps.overlay.getProjection()).fromLatLngToDivPixel(a)).x+=s.x?t.scroll.gx-i.clientX:0,e.y+=s.y?t.scroll.gy-i.clientY:0,a=o.fromDivPixelToLatLng(e),t.googleMaps.map.setCenter(a)),t.scroll.gx=i.clientX,t.scroll.gy=i.clientY,t.scroll.dx=t.scroll.x-i.clientX,t.scroll.dy=t.scroll.y-i.clientY;var a=parseInt(t.scroll.vxi+t.scroll.dx/t.scale),i=parseInt(t.scroll.vyi+t.scroll.dy/t.scale);t.options.scroll.limit&&(a<t.svgDefault.viewBox[0]?a=t.svgDefault.viewBox[0]:t.viewBox[2]+a>t.svgDefault.viewBox[0]+t.svgDefault.viewBox[2]&&(a=t.svgDefault.viewBox[0]+t.svgDefault.viewBox[2]-t.viewBox[2]),i<t.svgDefault.viewBox[1]?i=t.svgDefault.viewBox[1]:t.viewBox[3]+i>t.svgDefault.viewBox[1]+t.svgDefault.viewBox[3]&&(i=t.svgDefault.viewBox[1]+t.svgDefault.viewBox[3]-t.viewBox[3])),t.scroll.vx=a,t.scroll.vy=i},scrollEnd:function(e,t,o){var i=this;setTimeout(function(){i.scrollStarted=!1,i.isScrolling=!1},100),i.googleMaps&&i.googleMaps.overlay&&i.googleMaps.overlay.draw(),i.$map.removeClass("scrolling"),$(document).off("keyup.scroll.mapsvg"),$(document).off("mousemove.scroll.mapsvg"),$(document).off("mouseup.scroll.mapsvg"),!0!==o&&Math.abs(i.scroll.dx)<5&&Math.abs(i.scroll.dy)<5&&(i.editMarkers.on?i.clickAddsMarker&&i.markerAddClickHandler(e):i.region_clicked&&i.regionClickHandler(e,i.region_clicked)),i.viewBox[0]=i.scroll.vx||i.viewBox[0],i.viewBox[1]=i.scroll.vy||i.viewBox[1]},panBy:function(e,t){var o,i,s=this,a=s.scroll.tx-e,n=s.scroll.ty-t,r={x:!0,y:!0};return s.options.scroll.limit&&(o=s.$svg[0].getBoundingClientRect(),i=s.$map[0].getBoundingClientRect(),(o.left-e>i.left&&e<0||o.right-e<i.right&&0<e)&&(a=s.scroll.tx,r.x=!1),(o.top-t>i.top&&t<0||o.bottom-t<i.bottom&&0<t)&&(n=s.scroll.ty,r.y=!1)),s.$scrollpane.css({transform:"translate("+a+"px,"+n+"px)"}),s.scroll.tx=a,s.scroll.ty=n,r},scrollRegionClickHandler:function(e,t){this.region_clicked=t},touchStart:function(e,t){var o=this;e.preventDefault(),o.scrollStarted&&o.scrollEnd(e,t,!0);var i=e.originalEvent;o.options.zoom.fingers&&i.touches&&2==i.touches.length?(o.touchZoomStart=!0,o.scaleDistStart=Math.hypot(i.touches[0].pageX-i.touches[1].pageX,i.touches[0].pageY-i.touches[1].pageY)):i.touches&&1==i.touches.length&&o.scrollStart(e,t),$(document).on("touchmove.scroll.mapsvg",function(e){e.preventDefault(),o.touchMove(e,o)}).on("touchend.scroll.mapsvg",function(e){e.preventDefault(),o.touchEnd(e,o)})},touchMove:function(e,t){var o=this;e.preventDefault();var i,s,a,n=e.originalEvent;o.options.zoom.fingers&&n.touches&&2==n.touches.length?(MapSVG.ios||(n.scale=Math.hypot(n.touches[0].pageX-n.touches[1].pageX,n.touches[0].pageY-n.touches[1].pageY)/o.scaleDistStart),1!=n.scale&&o.canZoom&&(i=1<n.scale?1:-1,s=n.touches[0].pageX>=n.touches[1].pageX?n.touches[0].pageX-(n.touches[0].pageX-n.touches[1].pageX)/2-o.$svg.offset().left:n.touches[1].pageX-(n.touches[1].pageX-n.touches[0].pageX)/2-o.$svg.offset().left,a=n.touches[0].pageY>=n.touches[1].pageY?n.touches[0].pageY-(n.touches[0].pageY-n.touches[1].pageY)-o.$svg.offset().top:n.touches[1].pageY-(n.touches[1].pageY-n.touches[0].pageY)-o.$svg.offset().top,a=o.convertPixelToSVG([s,a]),0<i?o.zoomIn(a):o.zoomOut(a))):n.touches&&1==n.touches.length&&o.scrollMove(e)},touchEnd:function(e,t){e.preventDefault();e.originalEvent;this.touchZoomStart?this.touchZoomStart=!1:this.scrollStarted&&this.scrollEnd(e,t),$(document).off("touchmove.scroll.mapsvg"),$(document).off("touchend.scroll.mapsvg")},getSelected:function(){return this.selected_id},selectRegion:function(e,t){var o,i=this;if(!(e="string"==typeof e?i.getRegion(e):e))return!1;if(i.options.multiSelect&&!i.editRegions.on){if(e.selected)return i.deselectRegion(e),void(!t&&i.options.menu.on&&("database"==i.options.menu.source?e.objects&&e.objects.length&&(o=e.objects.map(function(e){return e.id})):o=[e.id],i.controllers.directory.deselectItems(o)))}else 0<i.selected_id.length&&(i.deselectAllRegions(),!t&&i.options.menu.on&&("database"==i.options.menu.source?e.objects&&e.objects.length&&(o=e.objects.map(function(e){return e.id})):o=[e.id],i.controllers.directory.deselectItems()));i.selected_id.push(e.id),e.select(),!i.options.actions.region.click.filterDirectory&&!t&&i.options.menu.on&&i.controllers&&i.controllers.directory&&(o="database"==i.options.menu.source&&e.objects&&e.objects.length?e.objects.map(function(e){return e.id}):[e.id],i.controllers.directory.selectItems(o)),i.options.actions.region.click.addIdToUrl&&!i.options.actions.region.click.showAnotherMap&&(window.location.hash="/m/"+e.id)},deselectAllRegions:function(){var o=this;$.each(o.selected_id,function(e,t){o.deselectRegion(o.getRegion(t))})},deselectRegion:function(e){var t,o=this;(e=e||o.getRegion(o.selected_id[0]))&&(e.deselect(),t=$.inArray(e.id,o.selected_id),o.selected_id.splice(t,1)),o.options.actions.region.click.addIdToUrl&&-1!==window.location.hash.indexOf(e.id)&&history.replaceState(null,null," ")},highlightRegions:function(e){var t=this;e.forEach(function(e){!e||e.selected||e.disabled||(t.highlightedRegions.push(e),e.highlight())})},unhighlightRegions:function(){this.highlightedRegions.forEach(function(e){!e||e.selected||e.disabled||e.unhighlight()}),this.highlightedRegions=[]},selectMarker:function(e){var t=this;if(!(e instanceof MapSVG.Marker))return!1;t.deselectAllMarkers(),e.select(),t.selected_marker=e,t.layers.markers.addClass("mapsvg-with-marker-active"),t.options.menu.on&&"database"==t.options.menu.source&&(t.controllers.directory.deselectItems(),t.controllers.directory.selectItems(e.object.id))},deselectAllMarkers:function(){this.selected_marker&&this.selected_marker.deselect(),this.layers.markers.removeClass("mapsvg-with-marker-active")},deselectMarker:function(e){e&&e.deselect()},highlightMarker:function(e){this.layers.markers.addClass("mapsvg-with-marker-hover"),e.highlight(),this.highlighted_marker=e},unhighlightMarker:function(){this.layers.markers.removeClass("mapsvg-with-marker-hover"),this.highlighted_marker&&this.highlighted_marker.unhighlight()},convertMouseToSVG:function(e){var t=MapSVG.mouseCoords(e),e=t.x-this.$svg.offset().left,t=t.y-this.$svg.offset().top;return this.convertPixelToSVG([e,t])},convertSVGToPixel:function(e){var t=this,o=t.getScale(),i=0;return t.options.googleMaps.on&&t.viewBox[0]-t.svgDefault.viewBox[0]>t.svgDefault.viewBox[2]&&(i=t.svgDefault.viewBox[2]/t.mapLonDelta*360*Math.floor((t.viewBox[0]-t.svgDefault.viewBox[0])/t.svgDefault.viewBox[2])),[(e[0]-t.svgDefault.viewBox[0]+i)*o,(e[1]-t.svgDefault.viewBox[1]+0)*o]},convertPixelToSVG:function(e){var t=this.getScale();return[e[0]/t+this.svgDefault.viewBox[0],e[1]/t+this.svgDefault.viewBox[1]]},convertGeoToSVG:function(e){var t=this,o=parseFloat(e[0]),i=(parseFloat(e[1])-t.geoViewBox.leftLon)*(t.svgDefault.viewBox[2]/t.mapLonDelta),o=3.14159*o/180,s=t.svgDefault.viewBox[2]/t.mapLonDelta*360/6.28318,e=s/2*Math.log((1+Math.sin(t.mapLatBottomDegree))/(1-Math.sin(t.mapLatBottomDegree))),e=t.svgDefault.viewBox[3]-(s/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))-e);return[i+=t.svgDefault.viewBox[0],e+=t.svgDefault.viewBox[1]]},convertSVGToGeo:function(e,t){var o=this;e-=o.svgDefault.viewBox[0],t-=o.svgDefault.viewBox[1];var i=o.svgDefault.viewBox[2]/o.mapLonDelta*360/(2*Math.PI),s=i/2*Math.log((1+Math.sin(o.mapLatBottomDegree))/(1-Math.sin(o.mapLatBottomDegree))),i=(o.svgDefault.viewBox[3]+s-t)/i,i=180/Math.PI*(2*Math.atan(Math.exp(i))-Math.PI/2),o=o.geoViewBox.leftLon+e/o.svgDefault.viewBox[2]*o.mapLonDelta;return[i=parseFloat(i.toFixed(6)),o=parseFloat(o.toFixed(6))]},convertGeoBoundsToViewBox:function(e,t){var o=this,i=parseFloat(coords[0]),s=(parseFloat(coords[1])-o.geoViewBox.leftLon)*(o.svgDefault.viewBox[2]/o.mapLonDelta),i=3.14159*i/180,a=o.svgDefault.viewBox[2]/o.mapLonDelta*360/6.28318,n=a/2*Math.log((1+Math.sin(o.mapLatBottomDegree))/(1-Math.sin(o.mapLatBottomDegree))),n=o.svgDefault.viewBox[3]-(a/2*Math.log((1+Math.sin(i))/(1-Math.sin(i)))-n);return[s+=o.svgDefault.viewBox[0],n+=o.svgDefault.viewBox[1]]},pickGaugeColor:function(e){var t=this,e=(e-t.options.gauge.min)/t.options.gauge.maxAdjusted;return[Math.round(t.options.gauge.colors.diffRGB.r*e+t.options.gauge.colors.lowRGB.r),Math.round(t.options.gauge.colors.diffRGB.g*e+t.options.gauge.colors.lowRGB.g),Math.round(t.options.gauge.colors.diffRGB.b*e+t.options.gauge.colors.lowRGB.b),Math.round(t.options.gauge.colors.diffRGB.a*e+t.options.gauge.colors.lowRGB.a)]},isRegionDisabled:function(e,t){var o=this;return!(!o.options.regions[e]||!o.options.regions[e].disabled&&"none"!=t)||!(null!=o.options.regions[e]&&!MapSVG.parseBoolean(o.options.regions[e].disabled)||!o.options.disableAll&&"none"!=t&&"labels"!=e&&"Labels"!=e)},regionClickHandler:function(e,region){var _this=this;_this.region_clicked=null;var actions=_this.options.actions;if(!_this.eventsPreventList.click){if(_this.editRegions.on)return _this.selectRegion(region.id),void _this.regionEditHandler.call(region);if(region instanceof MapSVG.MarkersCluster)_this.zoomTo(region.markers);else if(region.isRegion()){if(_this.selectRegion(region.id),actions.region.click.zoom&&_this.zoomTo(region,actions.region.click.zoomToLevel),actions.region.click.filterDirectory&&(_this.database.getAll({filters:{regions:region.id}}).done(function(){_this.popover&&_this.popover.redraw(region.forTemplate()),_this.detailsController&&_this.detailsController.redraw(region.forTemplate())}),_this.updateFiltersState()),actions.region.click.showDetails&&_this.loadDetailsView(region),(actions.region.click.showPopover||e&&-1!==e.type.indexOf("touch")&&actions.region.touch.showPopover)&&(actions.region.click.zoom?setTimeout(function(){_this.showPopover(region)},400):_this.showPopover(region)),actions.region.click.goToLink){var linkParts=actions.region.click.linkField.split("."),url;if(1<linkParts.length){var obj=linkParts.shift(),attr="."+linkParts.join("."),win;if("Region"==obj){if(region.data)try{url=eval("region.data"+attr)}catch(err){console.log("No such field as region.data"+attr)}}else if(region.objects&&region.objects[0])try{url=eval("region.objects[0]"+attr)}catch(err){console.log("No such field as region.objects[0]"+attr)}if(url&&!_this.disableLinks){if(_this.editMode)return alert("Redirect: "+url+"\nLinks are disabled in the preview."),!0;actions.region.click.newTab?(win=window.open(url,"_blank"),win.focus()):window.location.href=url}}}if(actions.region.click.showAnotherMap){if(_this.editMode)return alert('"Show another map" action is disabled in the preview'),!0;var linkParts=actions.region.click.showAnotherMapField.split("."),url,obj,attr,map_id,container;1<linkParts.length&&(obj=linkParts.shift(),attr="."+linkParts.join("."),"Region"==obj?region.data&&(map_id=eval("region.data"+attr)):region.objects&&region.objects[0]&&(map_id=eval("region.objects[0]"+attr)),map_id&&(container=actions.region.click.showAnotherMapContainerId?$("#"+actions.region.click.showAnotherMapContainerId):_this.$map,jQuery.get(ajaxurl,{action:"mapsvg_get",id:map_id},function(data){container.find("svg").length&&container.mapSvg().destroy(),eval("var options = "+data),container.mapSvg(options)})))}if(_this.events["click.region"])try{_this.events["click.region"].call(region,e,_this)}catch(err){console.log(err)}}else if(region.isMarker()){_this.selectMarker(region);var passingObject=region.object;if(actions.marker.click.zoom&&_this.zoomTo(region,actions.marker.click.zoomToLevel),actions.marker.click.filterDirectory&&(_this.database.getAll({filters:{id:region.object.id}}),_this.updateFiltersState()),actions.marker.click.showDetails&&_this.loadDetailsView(passingObject),(actions.marker.click.showPopover||e&&-1!==e.type.indexOf("touch")&&actions.marker.touch.showPopover)&&(actions.marker.click.zoom?setTimeout(function(){_this.showPopover(passingObject)},500):_this.showPopover(passingObject)),actions.marker.click.goToLink){var linkParts=actions.marker.click.linkField.split("."),url;if(1<linkParts.length){var obj=linkParts.shift(),attr="."+linkParts.join("."),win;try{url=eval("passingObject"+attr)}catch(err){console.log("MapSVG: No such field as passingObject"+attr)}if(url&&!_this.disableLinks&&_this.editMode)return alert("Redirect: "+url+"\nLinks are disabled in the preview."),!0;actions.marker.click.newTab?(win=window.open(url,"_blank"),win.focus()):window.location.href=url}}if(_this.events["click.marker"])try{_this.events["click.marker"].call(region,e,_this)}catch(err){console.log(err)}}}},fileExists:function(e){if("data"==e.substr(0,4))return!0;var t=new XMLHttpRequest;return t.open("HEAD",e,!1),t.send(),404!=t.status},getStyle:function(e,t){var o;return e.currentStyle?o=e.currentStyle.margin:window.getComputedStyle&&(o=window.getComputedStyle.getPropertyValue?window.getComputedStyle(e,null).getPropertyValue(t):window.getComputedStyle(e)[t]),o},hideMarkersExceptOne:function(t){this.markers.forEach(function(e){e.id!=t&&e.hide()}),this.$wrap.addClass("mapsvg-edit-marker-mode")},showMarkers:function(){this.markers.forEach(function(e){e.show()}),this.$wrap.removeClass("mapsvg-edit-marker-mode")},markerAddClickHandler:function(e){var t=this;if($(e.target).hasClass("mapsvg-marker"))return!1;var o=MapSVG.mouseCoords(e),i=o.x-t.$svg.offset().left,s=o.y-t.$svg.offset().top,e=t.convertPixelToSVG([i,s]),o=t.convertSVGToGeo(e[0],e[1]);if(!$.isNumeric(i)||!$.isNumeric(s))return!1;o=new MapSVG.Location({x:e[0],y:e[1],lat:o[0],lng:o[1],img:t.options.defaultMarkerImage});t.editingMarker?t.editingMarker.setXy(e):(o=new MapSVG.Marker({location:o,mapsvg:this}),t.markerAdd(o),t.markerEditHandler&&t.markerEditHandler.call(o))},setDefaultMarkerImage:function(e){this.options.defaultMarkerImage=e},setMarkerImagesDependency:function(){var e=this.locationField||this.database.getSchemaField("location");e.markersByFieldEnabled&&e.markerField&&0<Object.values(e.markersByField).length?(this.setMarkersByField=!0,this.locationField=e):this.setMarkersByField=!1},getMarkerImage:function(e,t){var o;return this.setMarkersByField&&(o="object"==typeof e?e[this.locationField.markerField]:e,this.locationField.markersByField[o])?this.locationField.markersByField[o]:t&&t.img?t.img:this.options.defaultMarkerImage||mapsvg_paths.root+"markers/_pin_default.png"},setMarkersEditMode:function(e,t){this.editMarkers.on=MapSVG.parseBoolean(e),this.clickAddsMarker=this.editMarkers.on,this.setEventHandlers()},setRegionsEditMode:function(e){this.editRegions.on=MapSVG.parseBoolean(e),this.deselectAllRegions(),this.setEventHandlers()},setEditMode:function(e){this.editMode=e},setDataEditMode:function(e){this.editData.on=MapSVG.parseBoolean(e),this.deselectAllRegions(),this.setEventHandlers()},download:function(){var e=this;e.downloadForm||(e.downloadForm=$('<form id="mdownload" action="/wp-content/plugins/mapsvg-dev/download.php" method="POST"><input type="hidden" name="svg_file" value="0" /><input type="hidden" name="svg_title"></form>'),e.downloadForm.appendTo("body")),e.downloadForm.find('input[name="svg_file"]').val(e.$svg.prop("outerHTML")),e.downloadForm.find('input[name="svg_title"]').val(e.options.title),setTimeout(function(){jQuery("#mdownload").submit()},500)},showTooltip:function(e){e.length&&(this.tooltip.container.html(e),this.tooltip.container.addClass("mapsvg-tooltip-visible"))},popoverAdjustPosition:function(){var e,t=this;t.$popover&&t.$popover.data("point")&&(e=t.convertSVGToPixel(t.$popover.data("point")),t.$popover[0].style.transform="translateX(-50%) translate("+e[0]+"px,"+e[1]+"px)")},showPopover:function(e){var t,o=this,i=e instanceof MapSVG.Region?e:e.location&&e.location.marker&&e.location.marker?e.location.marker:null;i&&(t=i instanceof MapSVG.Marker?{x:i.x,y:i.y}:i.getCenterSVG(),o.popover&&o.popover.destroy(),o.popover=new MapSVG.PopoverController({container:o.$popover,point:t,yShift:i instanceof MapSVG.Marker?i.height:0,template:e instanceof MapSVG.Region?o.templates.popoverRegion:o.templates.popoverMarker,mapsvg:o,data:e instanceof MapSVG.Region?e.forTemplate():e,mapObject:i,scrollable:!0,withToolbar:!MapSVG.isPhone||!o.options.popovers.mobileFullscreen,events:{shown:function(e){var t;o.options.popovers.centerOn&&(t=this.container.height()/2,!o.options.popovers.centerOn||MapSVG.isPhone&&o.options.popovers.mobileFullscreen||o.centerOn(i,t));try{o.events["shown.popover"]&&o.events["shown.popover"].call(this,o)}catch(e){console.log(e)}o.popoverShowingFor=i,o.trigger("popoverShown")},closed:function(e){o.options.popovers.resetViewboxOnClose&&o.viewBoxReset(!0),o.popoverShowingFor=null;try{o.events["closed.popover"]&&o.events["closed.popover"].call(this,e)}catch(e){console.log(e)}o.trigger("popoverClosed")},resize:function(){var e;o.options.popovers.centerOn&&(e=this.container.height()/2,!o.options.popovers.centerOn||MapSVG.isPhone&&o.options.popovers.mobileFullscreen||o.centerOn(i,e))}}}))},hidePopover:function(){this.popover&&this.popover.close()},hideTip:function(){this.tooltip.container.removeClass("mapsvg-tooltip-visible")},popoverOffHandler:function(e){this.isScrolling||$(e.target).closest(".mapsvg-popover").length||$(e.target).hasClass("mapsvg-btn-map")||this.popover&&this.popover.close()},mouseOverHandler:function(e,t){var o,i,s,a=this;if(!a.eventsPreventList.mouseover)if(a.options.tooltips.on&&(t instanceof MapSVG.Region&&(o="tooltipRegion",i=t.forTemplate()),t instanceof MapSVG.Marker&&(o="tooltipMarker",i=t.object),a.popoverShowingFor!==t&&a.showTooltip(a.templates[o](i))),a.options.menu.on&&("database"==a.options.menu.source?(t instanceof MapSVG.Region&&t.objects.length&&(s=t.objects.map(function(e){return e.id})),t instanceof MapSVG.Marker&&(s=t.object?t.object.id:[])):(t instanceof MapSVG.Region&&(s=[t.id]),this instanceof MapSVG.Marker&&t.object.regions&&t.object.regions.length&&(s=t.object.regions.map(function(e){return e.id}))),a.controllers.directory.highlightItems(s)),t instanceof MapSVG.Region){if(t.selected||t.highlight(),a.events["mouseover.region"])try{a.events["mouseover.region"].call(t,e,a)}catch(e){console.log(e)}}else if(a.highlightMarker(t),a.events["mouseover.marker"])try{a.events["mouseover.marker"].call(t,e,a)}catch(e){console.log(e)}},mouseOutHandler:function(e,t){var o=this;if(!o.eventsPreventList.mouseout){if(o.options.tooltips.on&&o.hideTip(),t instanceof MapSVG.Region){if(t.selected||t.unhighlight(),o.events["mouseout.region"])try{o.events["mouseout.region"].call(t,e,o)}catch(e){console.log(e)}}else if(o.unhighlightMarker(t),o.events["mouseout.marker"])try{o.events["mouseout.marker"].call(t,e,o)}catch(e){console.log(e)}o.options.menu.on&&("database"==o.options.menu.source&&t instanceof MapSVG.Marker&&(t.object&&t.object.id),o.controllers.directory.unhighlightItems())}},updateMarkersDict:function(){var o=this;o.markersDict={},o.markers.forEach(function(e,t){o.markersDict[e.id]=t})},eventsPrevent:function(e){this.eventsPreventList[e]=!0},eventsRestore:function(e){e?this.eventsPreventList[e]=!1:this.eventsPreventList={}},setEventHandlers:function(){var o=this;o.$map.off(".common.mapsvg"),o.$scrollpane.off(".common.mapsvg"),$(document).off("keydown.scroll.mapsvg"),$(document).off("mousemove.scrollInit.mapsvg"),$(document).off("mouseup.scrollInit.mapsvg"),o.editMarkers.on&&o.$map.on("touchstart.common.mapsvg mousedown.common.mapsvg",".mapsvg-marker",function(e){e.originalEvent.preventDefault();var t=o.getMarker($(this).attr("id")),e=MapSVG.mouseCoords(e);t.drag(e,o.scale,function(){o.mapIsGeo&&(this.geoCoords=o.convertSVGToGeo(this.x+this.width/2,this.y+(this.height-1))),o.markerEditHandler&&o.markerEditHandler.call(this,!0),this.onChange&&this.onChange.call(this)},function(){o.markerEditHandler&&o.markerEditHandler.call(this),this.onChange&&this.onChange.call(this)})}),o.editMarkers.on||o.$map.on("mouseover.common.mapsvg",".mapsvg-region",function(e){var t=$(this).attr("id");o.mouseOverHandler.call(o,e,o.getRegion(t))}).on("mouseleave.common.mapsvg",".mapsvg-region",function(e){var t=$(this).attr("id");o.mouseOutHandler.call(o,e,o.getRegion(t))}),o.editRegions.on||o.$map.on("mouseover.common.mapsvg",".mapsvg-marker",function(e){var t=$(this).attr("id");o.mouseOverHandler.call(o,e,o.getMarker(t))}).on("mouseleave.common.mapsvg",".mapsvg-marker",function(e){var t=$(this).attr("id");o.mouseOutHandler.call(o,e,o.getMarker(t))}),o.options.scroll.spacebar?$(document).on("keydown.scroll.mapsvg",function(e){"INPUT"===document.activeElement.tagName||o.isScrolling||32!=e.keyCode||(e.preventDefault(),o.$map.addClass("mapsvg-scrollable"),$(document).on("mousemove.scrollInit.mapsvg",function(e){o.isScrolling=!0,$(document).off("mousemove.scrollInit.mapsvg"),o.scrollStart(e,o)}).on("keyup.scroll.mapsvg",function(e){32==e.keyCode&&($(document).off("mousemove.scrollInit.mapsvg"),o.$map.removeClass("mapsvg-scrollable"))}))}):o.options.scroll.on?o.$map.on("touchstart.common.mapsvg mousedown.common.mapsvg",function(e){if($(e.target).hasClass("mapsvg-popover")||$(e.target).closest(".mapsvg-popover").length)$(e.target).hasClass("mapsvg-popover-close")&&"touchstart"==e.type&&e.cancelable&&e.preventDefault();else{if("touchstart"==e.type&&e.cancelable&&e.preventDefault(),e.target&&$(e.target).attr("class")&&-1!=$(e.target).attr("class").indexOf("mapsvg-region")){var t=o.getRegion($(e.target).attr("id"));o.scrollRegionClickHandler.call(o,e,t)}else if(e.target&&$(e.target).attr("class")&&-1!=$(e.target).attr("class").indexOf("mapsvg-marker")&&-1===$(e.target).attr("class").indexOf("mapsvg-marker-cluster")){if(o.editMarkers.on)return;t=o.getMarker($(e.target).attr("id"));o.scrollRegionClickHandler.call(o,e,t)}else if(e.target&&$(e.target).attr("class")&&-1!=$(e.target).attr("class").indexOf("mapsvg-marker-cluster")){if(o.editMarkers.on)return;t=$(e.target).data("cluster");o.scrollRegionClickHandler.call(o,e,t)}"mousedown"==e.type?o.scrollStart(e,o):o.touchStart(e,o)}}):o.editMarkers.on?o.clickAddsMarker&&o.$map.on("touchend.common.mapsvg mouseup.common.mapsvg",function(e){e.cancelable&&e.preventDefault(),o.markerAddClickHandler(e)}):(o.$map.on("touchstart.common.mapsvg",".mapsvg-region",function(e){o.touchScrollStart=$(window).scrollTop()}),o.$map.on("touchstart.common.mapsvg",".mapsvg-marker",function(e){o.touchScrollStart=$(window).scrollTop()}),o.$map.on("touchend.common.mapsvg mouseup.common.mapsvg",".mapsvg-region",function(e){e.cancelable&&e.preventDefault(),void 0!==o.touchScrollStart&&o.touchScrollStart!==$(window).scrollTop()||o.regionClickHandler.call(o,e,o.getRegion($(this).attr("id")))}),o.$map.on("touchend.common.mapsvg mouseup.common.mapsvg",".mapsvg-marker",function(e){e.cancelable&&e.preventDefault(),void 0!==o.touchScrollStart&&o.touchScrollStart!==$(window).scrollTop()||o.regionClickHandler.call(o,e,o.getMarker($(this).attr("id")))}),o.$map.on("touchend.common.mapsvg mouseup.common.mapsvg",".mapsvg-marker-cluster",function(e){e.cancelable&&e.preventDefault(),o.touchScrollStart&&o.touchScrollStart!=$(window).scrollTop()||(e=$(this).data("cluster"),o.zoomTo(e.markers))}))},setLabelsRegions:function(e){var t=this;null!=(e=e||t.options.labelsRegions).on&&(e.on=MapSVG.parseBoolean(e.on)),$.extend(!0,t.options,{labelsRegions:e}),t.options.labelsRegions.on?(t.regions.forEach(function(e){e.textLabel||(e.textLabel=jQuery('<div class="mapsvg-region-label" />'),t.$scrollpane.append(e.textLabel));try{e.textLabel.html(t.templates.labelRegion(e.forTemplate()))}catch(e){console.error('MapSVG: Error in the "Region Label" template')}}),t.labelsRegionsAdjustPosition()):t.regions.forEach(function(e){e.textLabel&&(e.textLabel.remove(),e.textLabel=null,delete e.textLabel)})},deleteLabelsMarkers:function(){this.markers.forEach(function(e){e.textLabel&&(e.textLabel.remove(),e.textLabel=null,delete e.textLabel)})},setLabelsMarkers:function(e){var t=this;null!=(e=e||t.options.labelsMarkers).on&&(e.on=MapSVG.parseBoolean(e.on)),$.extend(!0,t.options,{labelsMarkers:e}),t.options.labelsMarkers.on?(t.markers.forEach(function(e){e.textLabel||(e.textLabel=jQuery('<div class="mapsvg-marker-label" data-object-id="'+e.object.id+'"/>'),t.$scrollpane.append(e.textLabel));try{e.textLabel.html(t.templates.labelMarker(e.object))}catch(e){console.error('MapSVG: Error in the "Marker Label" template')}}),t.markersAdjustPosition()):t.deleteLabelsMarkers()},addLayer:function(e){return this.layers[e]=$('<div class="mapsvg-layer mapsvg-layer-'+e+'"></div>'),this.$layers.append(this.layers[e]),this.layers[e]},getDatabaseService:function(){return this.database},getDb:function(){return this.database},getDbRegions:function(){return this.regionsDatabase},regionAdd:function(e){var o=this,e=new MapSVG.Region($(e),o.options,o.regionID,o);return e.setStatus(1),o.regions.push(e),o.regions.sort(function(e,t){return e.id==t.id?0:+(e.id>t.id)||-1}),o.regions.forEach(function(e,t){o.regionsDict[e.id]=t}),e},regionDelete:function(e){var t,o=_this.regionsDict[e];void 0!==o?((t=_this.getRegion(e)).node&&t.node.remove(),_this.regions.splice(o,1),delete _this.regionsDict[e]):$("#"+e).length&&$("#"+e).remove()},reloadRegions:function(){var o=this;o.regions=[],o.regionsDict={},o.$svg.find(".mapsvg-region").removeClass("mapsvg-region"),o.$svg.find(".mapsvg-region-disabled").removeClass("mapsvg-region-disabled"),o.$svg.find("path, polygon, circle, ellipse, rect").each(function(e){var t;$(this).closest("defs").length||$(this)[0].getAttribute("id")&&(!o.options.regionPrefix||o.options.regionPrefix&&0===$(this)[0].getAttribute("id").indexOf(o.options.regionPrefix))&&(t=new MapSVG.Region($(this),o.options,o.regionID,o),o.regions.push(t))}),o.regions.sort(function(e,t){return e.id==t.id?0:+(e.id>t.id)||-1}),o.regions.forEach(function(e,t){o.regionsDict[e.id]=t})},reloadRegionsFull:function(){var o=this,i=o.regionsDatabase.getSchemaFieldByType("status");o.regions.forEach(function(e){var t=o.regionsDatabase.getLoadedObject(e.id);t?(e.data=t,i&&void 0!==t.status&&null!==t.status&&e.setStatus(t.status)):null!==o.options.filters.filteredRegionsStatus&&""!==o.options.filters.filteredRegionsStatus&&void 0!==o.options.filters.filteredRegionsStatus&&e.setStatus(o.options.filters.filteredRegionsStatus)}),o.loadDirectory(),o.setGauge(),o.setLayersControl(),o.setGroups(),o.options.labelsRegions.on&&o.setLabelsRegions()},fixMarkersWorldScreen:function(){var i=this;i.googleMaps.map&&setTimeout(function(){var e,t,o={left:0,right:0};1<i.markers.length&&(i.markers.forEach(function(e){e.node.offset().left<i.$map.offset().left+i.$map.width()/2?o.left++:o.right++}),0!==o.left&&0!==o.right||(e=0===o.left?1:-1,t=i.svgDefault.viewBox[2]/i.mapLonDelta*360*i.getScale(),i.googleMaps.map.panBy(e*t,0)))},600)},updateOutdatedOptions:function(e){e.menu&&(e.menu.position||e.menu.customContainer)&&(e.menu.customContainer?e.menu.location="custom":(e.menu.position="left"===e.menu.position?"left":"right",e.menu.location="left"===e.menu.position?"leftSidebar":"rightSidebar",e.containers&&e.containers[e.menu.location]||(e.containers=e.containers||{},e.containers[e.menu.location]={on:!1,width:"200px"}),e.containers[e.menu.location].width=e.menu.width,MapSVG.parseBoolean(e.menu.on)&&(e.containers[e.menu.location].on=!0)),delete e.menu.position,delete e.menu.width,delete e.menu.customContainer),!e.detailsView||"near"!==e.detailsView.location&&"top"!==e.detailsView.location||(e.detailsView.location="mapContainer"),e.controls||(e.controls={},e.controls.zoom=e.zoom&&e.zoom.on&&"hide"!==e.zoom.buttons.location,e.controls.location=e.zoom&&"hide"!==e.zoom.buttons.location?e.zoom.buttons.location:"right"),e.colors&&!e.colors.markers&&(e.colors.markers={base:{opacity:100,saturation:100},hovered:{opacity:100,saturation:100},unhovered:{opacity:100,saturation:100},active:{opacity:100,saturation:100},inactive:{opacity:100,saturation:100}})},init:function(e,t){var i=this;if(!e.source)throw new Error("MapSVG: please provide SVG file source.");if("remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),Math.hypot=Math.hypot||function(){for(var e=0,t=arguments.length,o=0;o<t;o++){if(arguments[o]===1/0||arguments[o]===-1/0)return 1/0;e+=arguments[o]*arguments[o]}return Math.sqrt(e)},SVGElement.prototype.getTransformToElement=SVGElement.prototype.getTransformToElement||function(e){return e.getScreenCTM().inverse().multiply(this.getScreenCTM())},0===e.source.indexOf("//")?e.source=e.source.replace(/^\/\/[^\/]+/,"").replace("//","/"):e.source=e.source.replace(/^.*:\/\/[^\/]+/,"").replace("//","/"),i.editMode=e.editMode,delete e.editMode,i.updateOutdatedOptions(e),i.options=$.extend(!0,{},i.defaults,e),i.id=i.options.db_map_id,"new"==i.id&&(i.id=null),i.highlightedRegions=[],i.editRegions={on:!1},i.editMarkers={on:!1},i.editData={on:!1},i.map=t,i.$map=$(t),i.$scrollpane=$('<div class="mapsvg-scrollpane"></div>').appendTo(i.$map),i.$layers=$('<div class="mapsvg-layers-wrap"></div>').appendTo(i.$scrollpane),i.whRatio=0,i.isScrolling=!1,i.markerOptions={},i.svgDefault={},i.refLength=0,i.scale=1,i._scale=1,i.selected_id=[],i.mapData={},i.regions=[],i.regionsDict={},i.regionID={id:0},i.markers=[],i.markersDict={},i.markersClusters=[],i.markersClustersDict=[],i._viewBox=[],i.viewBox=[],i.viewBoxZoom=[],i.viewBoxFind=void 0,i.zoomLevel=0,i.scroll={},i.layers={},i.geoCoordinates=!1,i.geoViewBox={leftLon:0,topLat:0,rightLon:0,bottomLat:0},i.eventsPreventList={},i.googleMaps={loaded:!1,initialized:!1,map:null,zoomLimit:!0},i.setEvents(e.events),i.events.beforeLoad)try{i.events.beforeLoad.call(i)}catch(e){}if(i.events.beforeLoad&&i.events.beforeLoad.beforeLoad&&"function"==typeof i.events.beforeLoad.beforeLoad)try{i.events.beforeLoad.beforeLoad.call(i)}catch(e){console.log(e)}return i.setCss(),i.$map.addClass("mapsvg").addClass("no-transitions").css("background",i.options.colors.background),i.setContainers(i.options.containers),i.setColors(),i.$loading=$("<div>"+i.options.loadingText+"</div>").addClass("mapsvg-loading"),i.$map.append(i.$loading),i.addLayer("markers"),i.addLayer("popovers"),i.$loading.css({"margin-left":function(){return-$(this).outerWidth(!1)/2+"px"},"margin-top":function(){return-$(this).outerHeight(!1)/2+"px"}}),i.options.googleMaps.on&&i.$map.addClass("mapsvg-google-map-loading"),i.options.extension&&$().mapSvg.extensions&&$().mapSvg.extensions[i.options.extension]&&((e=$().mapSvg.extensions[i.options.extension])&&e.common(i)),$.ajax({url:i.options.source+"?v="+i.options.svgFileVersion}).fail(function(e){e=404==e.status?"MapSVG: file not found - "+i.options.source+"\n\nIf you moved MapSVG from another server please read the following docs page: https://mapsvg.com/docs/installation/moving":"MapSVG: can't load SVG file for unknown reason. Please contact support: https://mapsvg.ticksy.com",i.editMode?alert(e):console.error(e)}).done(function(e){e=$(e).find("svg");if(i.$svg=e,i.svgDefault.width=e.attr("width"),i.svgDefault.height=e.attr("height"),i.svgDefault.viewBox=e.attr("viewBox"),i.svgDefault.width&&i.svgDefault.height)i.svgDefault.width=parseFloat(i.svgDefault.width.replace(/px/g,"")),i.svgDefault.height=parseFloat(i.svgDefault.height.replace(/px/g,"")),i.svgDefault.viewBox=i.svgDefault.viewBox?i.svgDefault.viewBox.split(" "):[0,0,i.svgDefault.width,i.svgDefault.height];else{if(!i.svgDefault.viewBox){var t="MapSVG: width/height and viewBox are missing in the SVG file. Can't parse the file because of that.";return i.editMode?alert(t):console.error(t),!1}i.svgDefault.viewBox=i.svgDefault.viewBox.split(" "),i.svgDefault.width=parseFloat(i.svgDefault.viewBox[2]),i.svgDefault.height=parseFloat(i.svgDefault.viewBox[3])}var o,t=e.attr("mapsvg:geoViewBox")||e.attr("mapsvg:geoviewbox");t&&4==(t=t.split(" ")).length&&(i.mapIsGeo=!0,i.geoCoordinates=!0,i.geoViewBox={leftLon:parseFloat(t[0]),topLat:parseFloat(t[1]),rightLon:parseFloat(t[2]),bottomLat:parseFloat(t[3])},i.mapLonDelta=i.geoViewBox.rightLon-i.geoViewBox.leftLon,i.mapLatBottomDegree=3.14159*i.geoViewBox.bottomLat/180),$.each(i.svgDefault.viewBox,function(e,t){i.svgDefault.viewBox[e]=parseFloat(t)}),i._viewBox=4==i.options.viewBox.length&&i.options.viewBox||i.svgDefault.viewBox,$.each(i._viewBox,function(e,t){i._viewBox[e]=parseFloat(t)}),e.attr("preserveAspectRatio","xMidYMid meet"),e.removeAttr("width"),e.removeAttr("height"),i.reloadRegions(),i.$scrollpane.append(e),i.setSize(i.options.width,i.options.height,i.options.responsive),i.options.disableAll&&i.setDisableAll(!0),i.setViewBox(i._viewBox),i.setResponsive(i.options.responsive,!0),i.setScroll(i.options.scroll,!0),i.setZoom(i.options.zoom),i.setControls(i.options.controls),i.setGoogleMaps(),i.options.tooltipsMode&&(i.options.tooltips.mode=i.options.tooltipsMode),i.setTooltips(i.options.tooltips),i.options.popover&&(i.options.popovers=i.options.popover),i.setPopovers(i.options.popovers),i.options.cursor&&i.setCursor(i.options.cursor),i.setTemplates(i.options.templates),!i.options.backend&&i.options.extension&&$().mapSvg.extensions&&$().mapSvg.extensions[i.options.extension]&&((o=$().mapSvg.extensions[i.options.extension])&&o.frontend(i)),i.filtersSchema=new MapSVG.Filters(i.options.filtersSchema),i.database=new MapSVG.DatabaseService({map_id:i.id,perpage:i.options.database.pagination.on?i.options.database.pagination.perpage:0,sortBy:"database"==i.options.menu.source?i.options.menu.sortBy:"id",sortDir:"database"==i.options.menu.source?i.options.menu.sortDirection:"desc",table:"database"},i),i.database.on("dataLoaded",function(){i.fitOnDataLoadDone=!1,i.addLocations(),i.fixMarkersWorldScreen(),i.attachDataToRegions(),i.loadDirectory(),i.options.labelsMarkers.on&&i.setLabelsMarkers(),i.options.templates.labelRegion.indexOf(!0)&&i.setLabelsRegions();try{i.events.databaseLoaded&&i.events.databaseLoaded.call(i)}catch(e){console.log(e)}i.updateFiltersState()}),i.database.on("schemaChange",function(){i.database.getAll()}),i.database.on("create",function(e){i.attachDataToRegions(e),i.reloadRegionsFull()}),i.database.on("update",function(e){i.attachDataToRegions(e),i.reloadRegionsFull()}),i.database.on("delete",function(e){i.attachDataToRegions(),i.reloadRegionsFull()}),i.regionsDatabase=new MapSVG.DatabaseService({map_id:i.id,perpage:0,sortBy:"regions"==i.options.menu.source?i.options.menu.sortBy:"id",sortDir:"regions"==i.options.menu.source?i.options.menu.sortDirection:"desc",table:"regions"},i),i.regionsDatabase.on("dataLoaded",function(){if(i.reloadRegionsFull(),i.events.regionsLoaded)if(i.events.regionsLoaded.length&&0<i.events.regionsLoaded.length)i.trigger("regionsLoaded",i);else try{i.events.regionsLoaded.call(i)}catch(e){console.log(e)}}),i.regionsDatabase.on("change",function(){i.reloadRegionsFull()}),i.menuDatabase="regions"==i.options.menu.source?i.regionsDatabase:i.database,i.setMenu(),i.setFilters(),i.options.menu.filterout.field&&((o={})[i.options.menu.filterout.field]=i.options.menu.filterout.val,("regions"==i.options.menu.source?i.regionsDatabase:i.database).query.setFilterOut(o)),i.setEventHandlers(),i.id&&(i.options.data_regions&&i.options.data_db?(i.regionsDatabase.fill(i.options.data_regions),(i.editMode||i.options.database.loadOnStart)&&i.database.fill(i.options.data_db),delete i.options.data_regions,delete i.options.data_db):i.regionsDatabase.getAll().done(function(e){i.options.database.loadOnStart||i.editMode?i.database.getAll().done(function(e){i.final()}):i.final()})),i.final()}),i},final:function(){var e,t=this;if(!t.options.googleMaps.on||t.googleMaps.map){if((match=RegExp("[?&]mapsvg_select=([^&]*)").exec(window.location.search))&&(e=decodeURIComponent(match[1].replace(/\+/g," ")),t.selectRegion(e)),window.location.hash&&(e=window.location.hash.replace("#/m/",""),(e=t.getRegion(e))&&t.options.actions.map.afterLoad.selectRegion&&t.regionClickHandler(null,e)),setTimeout(function(){t.updateSize(),setTimeout(function(){t.$map.removeClass("no-transitions")},200)},100),t.events.afterLoad&&"function"==typeof t.events.afterLoad)try{t.events.afterLoad.call(t)}catch(e){console.log(e)}t.editMode&&t.options.afterLoad&&t.options.afterLoad.call(t),t.options.dataLoaded&&t.options.dataLoaded.call(),t.$loading.hide(),MapSVG.addInstance(t)}else t.on("googleMapsLoaded",function(){t.final()})}},$.fn.mapSvg=function(e){if("object"!=typeof e)return $(this).data("_mapsvg");e=new MapSVG.Map($(this).attr("id"),e);return $(this).data("_mapsvg",e),e}}(jQuery),function(s){MapSVG.MapObject=function(e,t){this.id="",this.objects=[],this.events={},this.data={},this.node=e,this.mapsvg=t,this.nodeType=e[0].tagName},MapSVG.MapObject.prototype.isMarker=function(){return this instanceof MapSVG.Marker},MapSVG.MapObject.prototype.isRegion=function(){return this instanceof MapSVG.Region},MapSVG.MapObject.prototype.setData=function(e){for(var t in e)this.data[t]=e[t]},MapSVG.MapObject.prototype.getBBox=function(){},MapSVG.MapObject.prototype.getGeoBounds=function(){var e=this.getBBox();return{sw:this.mapsvg.convertSVGToGeo(e[0],e[1]+e[3]),ne:this.mapsvg.convertSVGToGeo(e[0]+e[2],e[1])}},MapSVG.MapObject.prototype.getComputedStyle=function(t,e){var o;if(o=(e=e||this.node[0]).getAttribute(t))return o;if(o=e.getAttribute("style")){var i=o.split(";").filter(function(e){if((e=e.trim()).split(":")[0]==t)return!0});if(i.length)return i[0].split(":").pop().trim()}i=s(e).parent(),e=i.length?i[0].tagName:null;return e&&"svg"!=e?this.getComputedStyle(t,i[0]):void 0},MapSVG.MapObject.prototype.getStyle=function(t){if(e=this.attr(t))return e;if(e=this.attr("style")){var e=e.split(";").filter(function(e){if(0===(e=e.trim()).indexOf(t))return e});return e.length?e[0].split(":").pop().trim():void 0}return""},MapSVG.MapObject.prototype.getCenter=function(){var e=this.node[0].getBoundingClientRect().left,t=this.node[0].getBoundingClientRect().top;return[e+this.node[0].getBoundingClientRect().width/2,t+this.node[0].getBoundingClientRect().height/2]},MapSVG.MapObject.prototype.getCenterSVG=function(){var e=this.getBBox();return{x:e[0]+e[2]/2,y:e[1]+e[3]/2}},MapSVG.MapObject.prototype.getCenterLatLng=function(e){e=e||0;var t=this.getBBox(),o=t[0]+t[2]/2,e=t[1]+t[3]/2-e,e=this.mapsvg.convertSVGToGeo(o,e);return{lat:e[0],lng:e[1]}},MapSVG.MapObject.prototype.attr=function(e,t){var o=this.node[0];if("object"==typeof e)s.each(e,function(e,t){"string"!=typeof t&&"number"!=typeof t||o.setAttribute(e,t)});else if("string"!=typeof e||"string"!=typeof t&&"number"!=typeof t){if(null==t)return o.getAttribute(e)}else o.setAttribute(e,t)},MapSVG.MapObject.prototype.setId=function(e){void 0!==e&&(this.id=e,this.node[0].setAttribute("id",e))},MapSVG.MapObject.prototype.on=function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)},MapSVG.MapObject.prototype.off=function(e){for(var t in this.events)this.events[t]&&0<this.events[t].length&&0===t.indexOf(e)&&e.length<=t&&(this.events[t]=[])},MapSVG.MapObject.prototype.trigger=function(e){var t,o=this;for(t in this.events)this.events[t]&&0<this.events[t].length&&0===t.explode(".")[0].indexOf(e)&&this.events[t].forEach(function(e){e&&e.call(o)})}}(jQuery),function(r){MapSVG.Marker=function(e){this.imagePath=e.location.markerImageUrl;var t=r('<img src="'+this.imagePath+'" />').addClass("mapsvg-marker");if(MapSVG.MapObject.call(this,t,this.mapsvg),this.location=e.location,(this.location.marker=this).mapsvg=e.mapsvg,e.object&&this.setObject(e.object),this.positioned=!1,e.width&&e.height&&(this.width=e.width,this.height=e.height),this.setId(this.mapsvg.markerId()),this.mapsvg.isGeo()&&MapSVG.isNumber(this.location.lat)&&MapSVG.isNumber(this.location.lng)){e=this.mapsvg.convertGeoToSVG([this.location.lat,this.location.lng]);this.x=e[0],this.y=e[1]}else{if(!MapSVG.isNumber(this.location.x)||!MapSVG.isNumber(this.location.y))return!1;this.x=parseFloat(this.location.x),this.y=parseFloat(this.location.y)}this.setImage(this.imagePath),this.setAltAttr(),this.positioned=!0},MapSVG.extend(MapSVG.Marker,MapSVG.MapObject),MapSVG.Marker.prototype.setId=function(e){MapSVG.MapObject.prototype.setId.call(this,e),this.mapsvg.updateMarkersDict()},MapSVG.Marker.prototype.getBBox=function(){var e=this.mapsvg.getData(),e={x:this.x,y:this.y,width:this.width/e.scale,height:this.height/e.scale};return[(e=r.extend(!0,{},e)).x,e.y,e.width,e.height]},MapSVG.Marker.prototype.getOptions=function(){var o={id:this.id,src:this.src,x:this.x,y:this.y,geoCoords:this.geoCoords};return r.each(o,function(e,t){null==t&&delete o[e]}),o},MapSVG.Marker.prototype.update=function(e,t){for(var o in e){var i="set"+MapSVG.ucfirst(o);i in this&&this[i](e[o],t)}},MapSVG.Marker.prototype.setImage=function(e,t){if(!e)return!1;var o=this;e=MapSVG.safeURL(e),t=t||this.mapScale;var t=new Image,i=this;this.src=e,"src"!==i.node[0].getAttribute("src")&&i.node[0].setAttribute("src",e),t.onload=function(){i.width=this.width,i.height=this.height,o.adjustPosition()},t.src=e,this.location&&this.location.setImage(e)},MapSVG.Marker.prototype.setAltAttr=function(){var e=this,e=void 0!==e.object&&void 0!==e.object.title&&""!==e.object.title?e.object.title:e.id;this.node[0].alt=e},MapSVG.Marker.prototype.setXy=function(e){this.x=e[0]||this.x,this.y=e[1]||this.y,this.xy=[this.x,this.y],this.location&&(this.location.x=this.x,this.location.y=this.y),this.mapsvg.getData().mapIsGeo&&(this.geoCoords=this.mapsvg.convertSVGToGeo(e[0],e[1]),this.location&&this.location.setLatLng({lat:this.geoCoords[0],lng:this.geoCoords[1]})),this.adjustPosition(),this.onChange&&this.onChange.call(this)},MapSVG.Marker.prototype.moveToClick=function(e){var t=this.mapsvg.getData(),o={};e[0]=e[0]+t.viewBox[0],e[1]=e[1]+t.viewBox[1],t.mapIsGeo&&(this.geoCoords=this.mapsvg.convertSVGToGeo(e[0],e[1])),o.xy=e,this.update(o)},MapSVG.Marker.prototype.adjustPosition=function(){var e,t=this.mapsvg.convertSVGToPixel([this.x,this.y]);3e7<t[0]?(this.node[0].style.left=t[0]-3e7+"px",t[0]=3e7,this.textLabel&&(this.textLabel[0].style.left=t[0]-3e7+"px")):this.node[0].style.left=0,3e7<t[1]?(this.node[0].style.top=t[1]-3e7+"px",t[1]=3e7,this.textLabel&&(this.textLabel[0].style.top=t[1]-3e7+"px")):this.node[0].style.top=0,t[0]-=this.width/2,t[1]-=this.centered?this.height/2:this.height,t[0]=Math.round(t[0]),t[1]=Math.round(t[1]),this.node[0].style.transform="translate("+t[0]+"px,"+t[1]+"px)",this.textLabel&&(e=Math.round(t[0]+this.width/2-this.textLabel.outerWidth()/2),t=Math.round(t[1]-this.textLabel.outerHeight()),this.textLabel[0].style.transform="translate("+e+"px,"+t+"px)")},MapSVG.Marker.prototype.setGeoCoords=function(e){"string"==typeof e&&(e=e.trim().split(","),e=[parseFloat(e[0]),parseFloat(e[1])]),"object"==typeof e&&2==e.length&&r.isNumeric(e[0])&&r.isNumeric(e[1])&&(e=this.mapsvg.convertGeoToSVG(e),this.setXy(e))},MapSVG.Marker.prototype.drag=function(o,i,s,a){var n=this;this.ox=this.x,this.oy=this.y,r("body").on("mousemove.drag.mapsvg",function(e){e.preventDefault(),n.mapsvg.getData().$map.addClass("no-transitions");var t=MapSVG.mouseCoords(e),e=t.x-o.x,t=t.y-o.y;n.setXy([n.ox+e/i,n.oy+t/i])}),r("body").on("mouseup.drag.mapsvg",function(e){e.preventDefault(),n.undrag();var t=MapSVG.mouseCoords(e),e=t.x-o.x,t=t.y-o.y;n.setXy([n.ox+e/i,n.oy+t/i]),s.call(n),n.ox==n.x&&n.oy==n.y&&a.call(n)})},MapSVG.Marker.prototype.undrag=function(){r("body").off(".drag.mapsvg"),this.mapsvg.getData().$map.removeClass("no-transitions")},MapSVG.Marker.prototype.delete=function(){this.textLabel&&(this.textLabel.remove(),this.textLabel=null),this.node.empty().remove(),this.mapsvg.markerDelete(this)},MapSVG.Marker.prototype.setObject=function(e){this.object=e,this.objects=[e],this.node.attr("data-object-id",this.object.id)},MapSVG.Marker.prototype.hide=function(){this.node.addClass("mapsvg-marker-hidden"),this.textLabel&&this.textLabel.hide()},MapSVG.Marker.prototype.show=function(){this.node.removeClass("mapsvg-marker-hidden"),this.textLabel&&this.textLabel.show()},MapSVG.Marker.prototype.highlight=function(){this.node.addClass("mapsvg-marker-hover")},MapSVG.Marker.prototype.unhighlight=function(){this.node.removeClass("mapsvg-marker-hover")},MapSVG.Marker.prototype.select=function(){this.selected=!0,this.node.addClass("mapsvg-marker-active")},MapSVG.Marker.prototype.deselect=function(){this.selected=!1,this.node.removeClass("mapsvg-marker-active")}}(jQuery),function(t){MapSVG.MarkersCluster=function(e){this.mapsvg=e.mapsvg,this.x=e.x,this.y=e.y,this.cellX=e.cellX,this.cellY=e.cellY,this.markers=e.markers||[],this.cellSize=50,this.width=30;e=jQuery('<div class="mapsvg-marker-cluster">'+this.markers.length+"</div>");e.data("cluster",this),MapSVG.MapObject.call(this,e,this.mapsvg),this.markers.length<2&&this.node.hide(),this.adjustPosition()},MapSVG.extend(MapSVG.MarkersCluster,MapSVG.MapObject),MapSVG.MarkersCluster.prototype.addMarker=function(e){var t;this.markers.push(e),1<this.markers.length?(2===this.markers.length&&this.node.show(),2===this.markers.length&&(t=this.markers.map(function(e){return e.x}),this.min_x=Math.min.apply(null,t),this.max_x=Math.max.apply(null,t),t=this.markers.map(function(e){return e.y}),this.min_y=Math.min.apply(null,t),this.max_y=Math.max.apply(null,t),this.x=this.min_x+(this.max_x-this.min_x)/2,this.y=this.min_y+(this.max_y-this.min_y)/2),2<this.markers.length&&(e.x<this.min_x?this.min_x=e.x:e.x>this.max_x&&(this.max_x=e.x),e.y<this.min_y?this.min_y=e.y:e.x>this.max_x&&(this.max_y=e.y),this.x=this.min_x+(this.max_x-this.min_x)/2,this.y=this.min_y+(this.max_y-this.min_y)/2)):(this.x=e.x,this.y=e.y),this.node.text(this.markers.length),this.adjustPosition()},MapSVG.MarkersCluster.prototype.canTakeMarker=function(e){e=this.mapsvg.convertSVGToPixel([e.x,e.y]);return this.cellX===Math.ceil(e[0]/this.cellSize)&&this.cellY===Math.ceil(e[1]/this.cellSize)},MapSVG.MarkersCluster.prototype.destroy=function(){this.markers=null,this.node.remove()},MapSVG.MarkersCluster.prototype.adjustPosition=function(){var e=this.mapsvg.convertSVGToPixel([this.x,this.y]);3e7<e[0]?(this.node[0].style.left=e[0]-3e7,e[0]=3e7):this.node[0].style.left=0,3e7<e[1]?(this.node[0].style.top=e[1]-3e7,e[1]=3e7):this.node[0].style.top=0,e[0]-=this.width/2,e[1]-=this.width/2,this.node[0].style.transform="translate("+e[0]+"px,"+e[1]+"px)"},MapSVG.MarkersCluster.prototype.getBBox=function(){var e={x:this.x,y:this.y,width:this.cellSize/this.mapsvg.getScale(),height:this.cellSize/this.mapsvg.getScale()};return[(e=t.extend(!0,{},e)).x,e.y,e.width,e.height]}}(jQuery),function(o){MapSVG.PopoverController=function(e){e.autoresize=!0,MapSVG.Controller.call(this,e),this.point=e.point,this.yShift=e.yShift,this.mapObject=e.mapObject,this.id=this.mapObject.id+"_"+Math.random(),this.container.data("popover-id",this.id)},MapSVG.extend(MapSVG.PopoverController,MapSVG.Controller),MapSVG.PopoverController.prototype.setPoint=function(e){this.point=e},MapSVG.PopoverController.prototype.getToolbarTemplate=function(){return this.withToolbar?'<div class="mapsvg-popover-close"></div>':""},MapSVG.PopoverController.prototype.viewDidLoad=function(){MapSVG.Controller.prototype.viewDidLoad.call(this);var e=this;MapSVG.isPhone&&e.mapsvg.getData().options.popovers.mobileFullscreen&&!this.mobileCloseBtn&&(this.mobileCloseBtn=o('<button class="mapsvg-mobile-modal-close mapsvg-btn">'+e.mapsvg.getData().options.mobileView.labelClose+"</button>"),this.view.append(this.mobileCloseBtn)),this.adjustPosition(),this.container.toggleClass("mapsvg-popover-animate",!0),this.container.toggleClass("mapsvg-popover-visible",!0),e.adjustHeight(),e.updateScroll(),this.resizeSensor.setScroll(),this.events&&this.events.shown&&this.events.shown.call(e,e.mapsvg)},MapSVG.PopoverController.prototype.adjustHeight=function(){this.container.height(this.container.find(".mapsvg-auto-height").outerHeight()+(this.toolbarView?this.toolbarView.outerHeight():0))},MapSVG.PopoverController.prototype.adjustPosition=function(){var e=this,t=e.mapsvg.convertSVGToPixel([e.point.x,e.point.y]);t[1]-=e.yShift,t[0]=Math.round(t[0]),t[1]=Math.round(t[1]),e.container[0].style.transform="translateX(-50%) translate("+t[0]+"px,"+t[1]+"px)"},MapSVG.PopoverController.prototype.setEventHandlers=function(){var t=this;o("body").off(".popover.mapsvg"),this.view.on("click touchend",".mapsvg-popover-close, .mapsvg-mobile-modal-close",function(e){e.stopImmediatePropagation(),t.close()}),o("body").on("mouseup.popover.mapsvg touchend.popover.mapsvg",function(e){t.mapsvg.getData().isScrolling||o(e.target).closest(".mapsvg-directory").length||o(e.target).closest(".mapsvg-popover").length||o(e.target).hasClass("mapsvg-btn-map")||t.close()})},MapSVG.PopoverController.prototype.close=function(){var e=this;this.container.data("popover-id")==this.id&&e.container.is(":visible")&&(e.destroy(),e.mapObject instanceof MapSVG.Region&&e.mapsvg.deselectRegion(e.mapObject),e.mapObject instanceof MapSVG.Marker&&e.mapsvg.deselectAllMarkers(),e.events&&e.events.closed&&e.events.closed.call(e,e.mapsvg))},MapSVG.PopoverController.prototype.destroy=function(){this.container.toggleClass("mapsvg-popover-animate",!1),this.container.toggleClass("mapsvg-popover-visible",!1),MapSVG.Controller.prototype.destroy.call(this)},MapSVG.PopoverController.prototype.show=function(){this.container.toggleClass("mapsvg-popover-animate",!0),this.container.toggleClass("mapsvg-popover-visible",!0)}}(jQuery),function(a){MapSVG.Region=function(e,t,o,i){MapSVG.MapObject.call(this,e),this.globalOptions=t,this.mapsvg=i,this.id=this.node.attr("id"),this.id&&t.regionPrefix&&this.setId(this.id.replace(t.regionPrefix,"")),this.id_no_spaces=this.id.replace(" ","_"),this.title=this.node.attr("title"),this.node[0].setAttribute("class",(this.node.attr("class")||"")+" mapsvg-region"),this.setStyleInitial();i=t.regions&&t.regions[this.id]?t.regions[this.id]:null;this.disabled=this.getDisabledState(),this.disabled&&this.attr("class",this.attr("class")+" mapsvg-disabled"),this.default_attr={},this.selected_attr={};t=!(this.hover_attr={});i&&i.selected&&(t=!0,delete i.selected),i&&this.update(i),this.setFill(),t&&this.setSelected(!0),this.saveState()},MapSVG.extend(MapSVG.Region,MapSVG.MapObject),MapSVG.Region.prototype.setStyleInitial=function(){var e;this.style={fill:this.getComputedStyle("fill")},this.style.stroke=this.getComputedStyle("stroke")||"",e=this.node.data("stroke-width")?this.node.data("stroke-width"):"1"==(e=(e=this.getComputedStyle("stroke-width"))?e.replace("px",""):"1")?1.2:parseFloat(e),this.style["stroke-width"]=e,this.node.data("stroke-width",e)},MapSVG.Region.prototype.saveState=function(){this.initialState=JSON.stringify(this.getOptions())},MapSVG.Region.prototype.getBBox=function(){this.mapsvg.getData();var e=this.node[0].getBBox(),e=a.extend(!0,{},e),t=this.node[0].getTransformToElement(this.mapsvg.getData().$svg[0]),o=e.x+e.width,i=e.y+e.height,s=this.mapsvg.getData().$svg[0].createSVGPoint();return s.x=e.x,s.y=e.y,s=s.matrixTransform(t),e.x=s.x,e.y=s.y,s.x=o,s.y=i,s=s.matrixTransform(t),e.width=s.x-e.x,e.height=s.y-e.y,[e.x,e.y,e.width,e.height]},MapSVG.Region.prototype.changed=function(){return JSON.stringify(this.getOptions())!=this.initialState},MapSVG.Region.prototype.edit=function(){this.nodeOriginal=this.node.clone()},MapSVG.Region.prototype.editCommit=function(){this.nodeOriginal=null},MapSVG.Region.prototype.editCancel=function(){this.nodeOriginal.appendTo(_this.mapsvg.getData().$svg),this.node=this.nodeOriginal,this.nodeOriginal=null},MapSVG.Region.prototype.getOptions=function(e){this.globalOptions.regions[this.id];var t,o={id:this.id,id_no_spaces:this.id_no_spaces,title:this.title,fill:this.globalOptions.regions[this.id]&&this.globalOptions.regions[this.id].fill,tooltip:this.tooltip,popover:this.popover,href:this.href,target:this.target,data:this.data,gaugeValue:this.gaugeValue};return e&&(o.disabled=this.disabled,o.dataCounter=this.data&&this.data.length||0),a.each(o,function(e,t){null==t&&delete o[e]}),this.customAttrs&&(t=this).customAttrs.forEach(function(e){o[e]=t[e]}),o},MapSVG.Region.prototype.forTemplate=function(){var e,t={id:this.id,title:this.title,objects:this.objects,data:this.data};for(e in this.data)"title"!=e&&"id"!=e&&(t[e]=this.data[e]);return t},MapSVG.Region.prototype.update=function(e){for(var t in e){var o="set"+MapSVG.ucfirst(t);o in this?this[o](e[t]):(this[t]=e[t],this.customAttrs=this.customAttrs||[],this.customAttrs.push(t))}},MapSVG.Region.prototype.setId=function(e){this.id=e,this.node.prop("id",e)},MapSVG.Region.prototype.setTitle=function(e){this.title=e},MapSVG.Region.prototype.setStyle=function(e){a.extend(!0,this.style,e),this.setFill()},MapSVG.Region.prototype.getChoroplethColor=function(){var e=this.globalOptions.gauge,t=0===e.maxAdjusted?0:(parseFloat(this.data[this.globalOptions.regionChoroplethField])-e.min)/e.maxAdjusted;return{r:Math.round(e.colors.diffRGB.r*t+e.colors.lowRGB.r),g:Math.round(e.colors.diffRGB.g*t+e.colors.lowRGB.g),b:Math.round(e.colors.diffRGB.b*t+e.colors.lowRGB.b),a:(e.colors.diffRGB.a*t+e.colors.lowRGB.a).toFixed(2)}},MapSVG.Region.prototype.setFill=function(e){var t,o;this.globalOptions.colorsIgnore?this.node.css(this.style):(e?((t={})[this.id]={fill:e},a.extend(!0,this.globalOptions,{regions:t})):!e&&void 0!==e&&this.globalOptions.regions&&this.globalOptions.regions[this.id]&&this.globalOptions.regions[this.id].fill&&delete this.globalOptions.regions[this.id].fill,this.globalOptions.gauge.on&&this.data&&void 0!==this.data[this.globalOptions.regionChoroplethField]&&""!==this.data[this.globalOptions.regionChoroplethField]?(o=this.getChoroplethColor(),this.default_attr.fill="rgba("+o.r+","+o.g+","+o.b+","+o.a+")"):void 0!==this.status&&this.mapsvg.regionsDatabase&&this.mapsvg.regionsDatabase.getSchemaFieldByType("status")&&this.mapsvg.regionsDatabase.getSchemaFieldByType("status").optionsDict&&this.mapsvg.regionsDatabase.getSchemaFieldByType("status").optionsDict[this.status]&&this.mapsvg.regionsDatabase.getSchemaFieldByType("status").optionsDict[this.status].color?this.default_attr.fill=this.mapsvg.regionsDatabase.getSchemaFieldByType("status").optionsDict[this.status].color:this.globalOptions.regions[this.id]&&this.globalOptions.regions[this.id].fill?this.default_attr.fill=this.globalOptions.regions[this.id].fill:this.globalOptions.colors.base?this.default_attr.fill=this.globalOptions.colors.base:"none"!=this.style.fill?this.default_attr.fill=this.style.fill||this.globalOptions.colors.baseDefault:this.default_attr.fill="none",MapSVG.isNumber(this.globalOptions.colors.selected)?this.selected_attr.fill=MapSVG.tinycolor(this.default_attr.fill).lighten(parseFloat(this.globalOptions.colors.selected)).toRgbString():this.selected_attr.fill=this.globalOptions.colors.selected,MapSVG.isNumber(this.globalOptions.colors.hover)?this.hover_attr.fill=MapSVG.tinycolor(this.default_attr.fill).lighten(parseFloat(this.globalOptions.colors.hover)).toRgbString():this.hover_attr.fill=this.globalOptions.colors.hover,this.node.css("fill",this.default_attr.fill),this.fill=this.default_attr.fill,"none"!=this.style.stroke&&null!=this.globalOptions.colors.stroke?this.node.css("stroke",this.globalOptions.colors.stroke):(o=null==this.style.stroke?"":this.style.stroke,this.node.css("stroke",o)),this.selected&&this.setSelected())},MapSVG.Region.prototype.setDisabled=function(e,t){e=void 0!==e?MapSVG.parseBoolean(e):this.getDisabledState();var o=this.disabled;this.disabled=e,this.attr("class",this.attr("class").replace("mapsvg-disabled","")),e&&this.attr("class",this.attr("class")+" mapsvg-disabled"),this.disabled!=o&&this.mapsvg.deselectRegion(this),t||this.setFill()},MapSVG.Region.prototype.setStatus=function(e){var t;(t=this.globalOptions.regionStatuses&&this.globalOptions.regionStatuses[e])?(this.status=e,this.data.status=e,this.setDisabled(t.disabled,!0)):(this.status=void 0,this.data.status=void 0,this.setDisabled(!1,!0)),this.setFill()},MapSVG.Region.prototype.setSelected=function(){this.mapsvg.selectRegion(this)},MapSVG.Region.prototype.setGaugeValue=function(e){this.gaugeValue=a.isNumeric(e)?parseFloat(e):void 0},MapSVG.Region.prototype.getDisabledState=function(e){var t=this.globalOptions.regions[this.id];return!e&&t&&void 0!==t.disabled?t.disabled:!(!this.globalOptions.disableAll&&"none"!=this.style.fill&&"labels"!=this.id&&"Labels"!=this.id)},MapSVG.Region.prototype.highlight=function(){this.node.css({fill:this.hover_attr.fill}),this.node.addClass("mapsvg-region-hover")},MapSVG.Region.prototype.unhighlight=function(){this.node.css({fill:this.default_attr.fill}),this.node.removeClass("mapsvg-region-hover")},MapSVG.Region.prototype.select=function(){this.node.css({fill:this.selected_attr.fill}),this.selected=!0,this.node.addClass("mapsvg-region-active")},MapSVG.Region.prototype.deselect=function(){this.node.css({fill:this.default_attr.fill}),this.selected=!1,this.node.removeClass("mapsvg-region-active")}}(jQuery),jQuery,MapSVG.ResizeSensor=function(e,t){var o=this;o.element=e,o.callback=t;var i=getComputedStyle(e),t=parseInt(i.zIndex);isNaN(t)&&(t=0),t--,o.expand=document.createElement("div"),o.expand.style.position="absolute",o.expand.style.left="0px",o.expand.style.top="0px",o.expand.style.right="0px",o.expand.style.bottom="0px",o.expand.style.overflow="hidden",o.expand.style.zIndex=t,o.expand.style.visibility="hidden";i=document.createElement("div");i.style.position="absolute",i.style.left="0px",i.style.top="0px",i.style.width="10000000px",i.style.height="10000000px",o.expand.appendChild(i),o.shrink=document.createElement("div"),o.shrink.style.position="absolute",o.shrink.style.left="0px",o.shrink.style.top="0px",o.shrink.style.right="0px",o.shrink.style.bottom="0px",o.shrink.style.overflow="hidden",o.shrink.style.zIndex=t,o.shrink.style.visibility="hidden";t=document.createElement("div");t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.width="200%",t.style.height="200%",o.shrink.appendChild(t),o.element.appendChild(o.expand),o.element.appendChild(o.shrink);e=e.getBoundingClientRect();o.currentWidth=e.width,o.currentHeight=e.height,o.setScroll(),o.expand.addEventListener("scroll",function(){o.onScroll()}),o.shrink.addEventListener("scroll",function(){o.onScroll()})},MapSVG.ResizeSensor.prototype.onScroll=function(){var e=this,t=e.element.getBoundingClientRect(),o=t.width,t=t.height;o==e.currentWidth&&t==e.currentHeight||(e.currentWidth=o,e.currentHeight=t,e.callback()),this.setScroll()},MapSVG.ResizeSensor.prototype.setScroll=function(){this.expand.scrollLeft=1e7,this.expand.scrollTop=1e7,this.shrink.scrollLeft=1e7,this.shrink.scrollTop=1e7},MapSVG.ResizeSensor.prototype.destroy=function(){this.expand.remove(),this.shrink.remove()},function(n){var a=/^\s+/,r=/\s+$/,i=0,s=n.round,p=n.min,c=n.max,e=n.random;function g(e,t){if(t=t||{},(e=e||"")instanceof g)return e;if(!(this instanceof g))return new g(e,t);var o=function(e){var t={r:0,g:0,b:0},o=1,i=!1,s=!1;"string"==typeof e&&(e=function(e){e=e.replace(a,"").replace(r,"").toLowerCase();var t,o=!1;if(G[e])e=G[e],o=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};if(t=F.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=F.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=F.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=F.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=F.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=F.hsva.exec(e))return{h:t[1],s:t[2],v:t[3],a:t[4]};if(t=F.hex8.exec(e))return{a:function(e){return B(e)/255}(t[1]),r:B(t[2]),g:B(t[3]),b:B(t[4]),format:o?"name":"hex8"};if(t=F.hex6.exec(e))return{r:B(t[1]),g:B(t[2]),b:B(t[3]),format:o?"name":"hex"};if(t=F.hex3.exec(e))return{r:B(t[1]+""+t[1]),g:B(t[2]+""+t[2]),b:B(t[3]+""+t[3]),format:o?"name":"hex"};return!1}(e));"object"==typeof e&&(z(e.r)&&z(e.g)&&z(e.b)?(t=function(e,t,o){return{r:255*D(e,255),g:255*D(t,255),b:255*D(o,255)}}(e.r,e.g,e.b),i=!0,s="%"===String(e.r).substr(-1)?"prgb":"rgb"):z(e.h)&&z(e.s)&&z(e.v)?(e.s=O(e.s),e.v=O(e.v),t=function(e,t,o){e=6*D(e,360),t=D(t,100),o=D(o,100);var i=n.floor(e),s=e-i,a=o*(1-t),e=o*(1-s*t),t=o*(1-(1-s)*t),i=i%6;return{r:255*[o,e,a,a,t,o][i],g:255*[t,o,o,e,a,a][i],b:255*[a,a,t,o,o,e][i]}}(e.h,e.s,e.v),i=!0,s="hsv"):z(e.h)&&z(e.s)&&z(e.l)&&(e.s=O(e.s),e.l=O(e.l),t=function(e,t,o){var i,s,a;function n(e,t,o){return o<0&&(o+=1),1<o&&--o,o<1/6?e+6*(t-e)*o:o<.5?t:o<2/3?e+(t-e)*(2/3-o)*6:e}e=D(e,360),t=D(t,100),o=D(o,100),0===t?i=s=a=o:(i=n(t=2*o-(o=o<.5?o*(1+t):o+t-o*t),o,e+1/3),s=n(t,o,e),a=n(t,o,e-1/3));return{r:255*i,g:255*s,b:255*a}}(e.h,e.s,e.l),i=!0,s="hsl"),e.hasOwnProperty("a")&&(o=e.a));return o=$(o),{ok:i,format:e.format||s,r:p(255,c(t.r,0)),g:p(255,c(t.g,0)),b:p(255,c(t.b,0)),a:o}}(e);this._originalInput=e,this._r=o.r,this._g=o.g,this._b=o.b,this._a=o.a,this._roundA=s(100*this._a)/100,this._format=t.format||o.format,this._gradientType=t.gradientType,this._r<1&&(this._r=s(this._r)),this._g<1&&(this._g=s(this._g)),this._b<1&&(this._b=s(this._b)),this._ok=o.ok,this._tc_id=i++}function l(e,t,o){e=D(e,255),t=D(t,255),o=D(o,255);var i,s=c(e,t,o),a=p(e,t,o),n=(s+a)/2;if(s==a)i=l=0;else{var r=s-a,l=.5<n?r/(2-s-a):r/(s+a);switch(s){case e:i=(t-o)/r+(t<o?6:0);break;case t:i=(o-e)/r+2;break;case o:i=(e-t)/r+4}i/=6}return{h:i,s:l,l:n}}function d(e,t,o){e=D(e,255),t=D(t,255),o=D(o,255);var i,s=c(e,t,o),a=p(e,t,o),n=s,r=s-a,l=0===s?0:r/s;if(s==a)i=0;else{switch(s){case e:i=(t-o)/r+(t<o?6:0);break;case t:i=(o-e)/r+2;break;case o:i=(e-t)/r+4}i/=6}return{h:i,s:l,v:n}}function t(e,t,o,i){o=[_(s(e).toString(16)),_(s(t).toString(16)),_(s(o).toString(16))];return i&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function h(e,t,o,i){return[_((i=i,n.round(255*parseFloat(i)).toString(16))),_(s(e).toString(16)),_(s(t).toString(16)),_(s(o).toString(16))].join("")}function o(e,t){t=0===t?0:t||10;e=g(e).toHsl();return e.s-=t/100,e.s=L(e.s),g(e)}function u(e,t){t=0===t?0:t||10;e=g(e).toHsl();return e.s+=t/100,e.s=L(e.s),g(e)}function m(e){return g(e).desaturate(100)}function v(e,t){t=0===t?0:t||10;e=g(e).toHsl();return e.l+=t/100,e.l=L(e.l),g(e)}function f(e,t){t=0===t?0:t||10;e=g(e).toRgb();return e.r=c(0,p(255,e.r-s(-t/100*255))),e.g=c(0,p(255,e.g-s(-t/100*255))),e.b=c(0,p(255,e.b-s(-t/100*255))),g(e)}function b(e,t){t=0===t?0:t||10;e=g(e).toHsl();return e.l-=t/100,e.l=L(e.l),g(e)}function y(e,t){e=g(e).toHsl(),t=(e.h+t)%360;return e.h=t<0?360+t:t,g(e)}function w(e){e=g(e).toHsl();return e.h=(e.h+180)%360,g(e)}function S(e){var t=g(e).toHsl(),o=t.h;return[g(e),g({h:(o+120)%360,s:t.s,l:t.l}),g({h:(o+240)%360,s:t.s,l:t.l})]}function M(e){var t=g(e).toHsl(),o=t.h;return[g(e),g({h:(o+90)%360,s:t.s,l:t.l}),g({h:(o+180)%360,s:t.s,l:t.l}),g({h:(o+270)%360,s:t.s,l:t.l})]}function x(e){var t=g(e).toHsl(),o=t.h;return[g(e),g({h:(o+72)%360,s:t.s,l:t.l}),g({h:(o+216)%360,s:t.s,l:t.l})]}function k(e,t,o){t=t||6,o=o||30;var i=g(e).toHsl(),s=360/o,a=[g(e)];for(i.h=(i.h-(s*t>>1)+720)%360;--t;)i.h=(i.h+s)%360,a.push(g(i));return a}function V(e,t){t=t||6;for(var e=g(e).toHsv(),o=e.h,i=e.s,s=e.v,a=[],n=1/t;t--;)a.push(g({h:o,s:i,v:s})),s=(s+n)%1;return a}g.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e=this.toRgb(),t=e.r/255,o=e.g/255,e=e.b/255,t=t<=.03928?t/12.92:n.pow((.055+t)/1.055,2.4),o=o<=.03928?o/12.92:n.pow((.055+o)/1.055,2.4),e=e<=.03928?e/12.92:n.pow((.055+e)/1.055,2.4);return.2126*t+.7152*o+.0722*e},setAlpha:function(e){return this._a=$(e),this._roundA=s(100*this._a)/100,this},toHsv:function(){var e=d(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=d(this._r,this._g,this._b),t=s(360*e.h),o=s(100*e.s),e=s(100*e.v);return 1==this._a?"hsv("+t+", "+o+"%, "+e+"%)":"hsva("+t+", "+o+"%, "+e+"%, "+this._roundA+")"},toHsl:function(){var e=l(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=l(this._r,this._g,this._b),t=s(360*e.h),o=s(100*e.s),e=s(100*e.l);return 1==this._a?"hsl("+t+", "+o+"%, "+e+"%)":"hsla("+t+", "+o+"%, "+e+"%, "+this._roundA+")"},toHex:function(e){return t(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(){return h(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:s(this._r),g:s(this._g),b:s(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+s(this._r)+", "+s(this._g)+", "+s(this._b)+")":"rgba("+s(this._r)+", "+s(this._g)+", "+s(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:s(100*D(this._r,255))+"%",g:s(100*D(this._g,255))+"%",b:s(100*D(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+s(100*D(this._r,255))+"%, "+s(100*D(this._g,255))+"%, "+s(100*D(this._b,255))+"%)":"rgba("+s(100*D(this._r,255))+"%, "+s(100*D(this._g,255))+"%, "+s(100*D(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&C[t(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+h(this._r,this._g,this._b,this._a),o=t;return"progid:DXImageTransform.Microsoft.gradient("+(this._gradientType?"GradientType = 1, ":"")+"startColorstr="+t+",endColorstr="+(o=e?g(e).toHex8String():o)+")"},toString:function(e){var t=!!e;e=e||this._format;var o=!1,i=this._a<1&&0<=this._a;return t||!i||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"name"!==e?("rgb"===e&&(o=this.toRgbString()),"prgb"===e&&(o=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(o=this.toHexString()),"hex3"===e&&(o=this.toHexString(!0)),"hex8"===e&&(o=this.toHex8String()),"name"===e&&(o=this.toName()),"hsl"===e&&(o=this.toHslString()),(o="hsv"===e?this.toHsvString():o)||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return g(this.toString())},_applyModification:function(e,t){t=e.apply(null,[this].concat([].slice.call(t)));return this._r=t._r,this._g=t._g,this._b=t._b,this.setAlpha(t._a),this},lighten:function(){return this._applyModification(v,arguments)},brighten:function(){return this._applyModification(f,arguments)},darken:function(){return this._applyModification(b,arguments)},desaturate:function(){return this._applyModification(o,arguments)},saturate:function(){return this._applyModification(u,arguments)},greyscale:function(){return this._applyModification(m,arguments)},spin:function(){return this._applyModification(y,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(k,arguments)},complement:function(){return this._applyCombination(w,arguments)},monochromatic:function(){return this._applyCombination(V,arguments)},splitcomplement:function(){return this._applyCombination(x,arguments)},triad:function(){return this._applyCombination(S,arguments)},tetrad:function(){return this._applyCombination(M,arguments)}},g.fromRatio=function(e,t){if("object"==typeof e){var o,i={};for(o in e)e.hasOwnProperty(o)&&(i[o]="a"===o?e[o]:O(e[o]));e=i}return g(e,t)},g.equals=function(e,t){return!(!e||!t)&&g(e).toRgbString()==g(t).toRgbString()},g.random=function(){return g.fromRatio({r:e(),g:e(),b:e()})},g.mix=function(e,t,o){o=0===o?0:o||50;var i=g(e).toRgb(),s=g(t).toRgb(),e=o/100,t=2*e-1,o=s.a-i.a,t=t*o==-1?t:(t+o)/(1+t*o),o=1-(t=(t+1)/2);return g({r:s.r*t+i.r*o,g:s.g*t+i.g*o,b:s.b*t+i.b*o,a:s.a*e+i.a*(1-e)})},g.readability=function(e,t){e=g(e),t=g(t);return(n.max(e.getLuminance(),t.getLuminance())+.05)/(n.min(e.getLuminance(),t.getLuminance())+.05)},g.isReadable=function(e,t,o){var i=g.readability(e,t),s=!1,o=function(e){var t;t=((e=e||{level:"AA",size:"small"}).level||"AA").toUpperCase(),e=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA");"small"!==e&&"large"!==e&&(e="small");return{level:t,size:e}}(o);switch(o.level+o.size){case"AAsmall":case"AAAlarge":s=4.5<=i;break;case"AAlarge":s=3<=i;break;case"AAAsmall":s=7<=i}return s},g.mostReadable=function(e,t,o){for(var i,s=null,a=0,n=(o=o||{}).includeFallbackColors,r=o.level,l=o.size,p=0;p<t.length;p++)a<(i=g.readability(e,t[p]))&&(a=i,s=g(t[p]));return g.isReadable(e,s,{level:r,size:l})||!n?s:(o.includeFallbackColors=!1,g.mostReadable(e,["#fff","#000"],o))};var G=g.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},C=g.hexNames=function(e){var t,o={};for(t in e)e.hasOwnProperty(t)&&(o[e[t]]=t);return o}(G);function $(e){return e=parseFloat(e),e=isNaN(e)||e<0||1<e?1:e}function D(e,t){"string"==typeof(o=e)&&-1!=o.indexOf(".")&&1===parseFloat(o)&&(e="100%");var o,o="string"==typeof(o=e)&&-1!=o.indexOf("%");return e=p(t,c(0,parseFloat(e))),o&&(e=parseInt(e*t,10)/100),n.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function L(e){return p(1,c(0,e))}function B(e){return parseInt(e,16)}function _(e){return 1==e.length?"0"+e:""+e}function O(e){return e=e<=1?100*e+"%":e}var T,R,j,F=(R="[\\s|\\(]+("+(T="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+T+")[,|\\s]+("+T+")\\s*\\)?",j="[\\s|\\(]+("+T+")[,|\\s]+("+T+")[,|\\s]+("+T+")[,|\\s]+("+T+")\\s*\\)?",{CSS_UNIT:new RegExp(T),rgb:new RegExp("rgb"+R),rgba:new RegExp("rgba"+j),hsl:new RegExp("hsl"+R),hsla:new RegExp("hsla"+j),hsv:new RegExp("hsv"+R),hsva:new RegExp("hsva"+j),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function z(e){return F.CSS_UNIT.exec(e)}MapSVG.tinycolor=g,"undefined"!=typeof module&&module.exports?module.exports=g:"function"==typeof define&&define.amd&&define(function(){return g})}(Math);
!function(o){function t(e){var t=e||window.event,n=[].slice.call(arguments,1),i=0,l=0,s=0;return(e=o.event.fix(t)).type="mousewheel",t.wheelDelta&&(i=t.wheelDelta/120),s=i=t.detail?-t.detail/3:i,void 0!==t.axis&&t.axis===t.HORIZONTAL_AXIS&&(s=0,l=-1*i),void 0!==t.wheelDeltaY&&(s=t.wheelDeltaY/120),void 0!==t.wheelDeltaX&&(l=-1*t.wheelDeltaX/120),n.unshift(e,i,l,s),(o.event.dispatch||o.event.handle).apply(this,n)}var n=["DOMMouseScroll","mousewheel"];if(o.event.fixHooks)for(var e=n.length;e;)o.event.fixHooks[n[--e]]=o.event.mouseHooks;o.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=n.length;e;)this.addEventListener(n[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=n.length;e;)this.removeEventListener(n[--e],t,!1);else this.onmousewheel=null}},o.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(jQuery);
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Handlebars=e():t.Handlebars=e()}(this,function(){return n={},r.m=s=[function(t,e,r){"use strict";function s(){var r=p();return r.compile=function(t,e){return c.compile(t,e,r)},r.precompile=function(t,e){return c.precompile(t,e,r)},r.AST=o.default,r.Compiler=c.Compiler,r.JavaScriptCompiler=l.default,r.Parser=a.parser,r.parse=a.parse,r.parseWithoutProcessing=a.parseWithoutProcessing,r}var n=r(1).default;e.__esModule=!0;var i=n(r(2)),o=n(r(45)),a=r(46),c=r(51),l=n(r(52)),u=n(r(49)),r=n(r(44)),p=i.default.create,i=s();i.create=s,r.default(i),i.Visitor=u.default,i.default=i,e.default=i,t.exports=e.default},function(t,e){"use strict";e.default=function(t){return t&&t.__esModule?t:{default:t}},e.__esModule=!0},function(t,e,r){"use strict";function s(){var e=new o.HandlebarsEnvironment;return l.extend(e,o),e.SafeString=a.default,e.Exception=c.default,e.Utils=l,e.escapeExpression=l.escapeExpression,e.VM=u,e.template=function(t){return u.template(t,e)},e}var n=r(3).default,i=r(1).default;e.__esModule=!0;var o=n(r(4)),a=i(r(37)),c=i(r(6)),l=n(r(5)),u=n(r(38)),i=i(r(44)),r=s();r.create=s,i.default(r),r.default=r,e.default=r,t.exports=e.default},function(t,e){"use strict";e.default=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},e.__esModule=!0},function(t,e,r){"use strict";function s(t,e,r){this.helpers=t||{},this.partials=e||{},this.decorators=r||{},a.registerDefaultHelpers(this),c.registerDefaultDecorators(this)}var n=r(1).default;e.__esModule=!0,e.HandlebarsEnvironment=s;var i=r(5),o=n(r(6)),a=r(10),c=r(30),n=n(r(32)),l=r(33);e.VERSION="4.7.7";e.COMPILER_REVISION=8;e.LAST_COMPATIBLE_COMPILER_REVISION=7;e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};var u="[object Object]";s.prototype={constructor:s,logger:n.default,log:n.default.log,registerHelper:function(t,e){if(i.toString.call(t)===u){if(e)throw new o.default("Arg not supported with multiple helpers");i.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if(i.toString.call(t)===u)i.extend(this.partials,t);else{if(void 0===e)throw new o.default('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if(i.toString.call(t)===u){if(e)throw new o.default("Arg not supported with multiple decorators");i.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]},resetLoggedPropertyAccesses:function(){l.resetLoggedProperties()}};r=n.default.log;e.log=r,e.createFrame=i.createFrame,e.logger=n.default},function(t,e){"use strict";function r(t){return n[t]}function s(t){for(var e=1;e<arguments.length;e++)for(var r in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],r)&&(t[r]=arguments[e][r]);return t}e.__esModule=!0,e.extend=s,e.indexOf=function(t,e){for(var r=0,s=t.length;r<s;r++)if(t[r]===e)return r;return-1},e.escapeExpression=function(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return o.test(t)?t.replace(i,r):t},e.isEmpty=function(t){return!t&&0!==t||!(!l(t)||0!==t.length)},e.createFrame=function(t){var e=s({},t);return e._parent=t,e},e.blockParams=function(t,e){return t.path=e,t},e.appendContextPath=function(t,e){return(t?t+".":"")+e};var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},i=/[&<>"'`=]/g,o=/[&<>"'`=]/,a=Object.prototype.toString;e.toString=a;var c=function(t){return"function"==typeof t};c(/x/)&&(e.isFunction=c=function(t){return"function"==typeof t&&"[object Function]"===a.call(t)}),e.isFunction=c;var l=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===a.call(t)};e.isArray=l},function(t,e,r){"use strict";function l(t,e){var r=e&&e.loc,s=void 0,n=void 0,i=void 0,o=void 0;r&&(s=r.start.line,n=r.end.line,i=r.start.column,o=r.end.column,t+=" - "+s+":"+i);for(var a=Error.prototype.constructor.call(this,t),c=0;c<p.length;c++)this[p[c]]=a[p[c]];Error.captureStackTrace&&Error.captureStackTrace(this,l);try{r&&(this.lineNumber=s,this.endLineNumber=n,u?(Object.defineProperty(this,"column",{value:i,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:o,enumerable:!0})):(this.column=i,this.endColumn=o))}catch(t){}}var u=r(7).default;e.__esModule=!0;var p=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];l.prototype=new Error,e.default=l,t.exports=e.default},function(t,e,r){t.exports={default:r(8),__esModule:!0}},function(t,e,r){var s=r(9);t.exports=function(t,e,r){return s.setDesc(t,e,r)}},function(t,e){var r=Object;t.exports={create:r.create,getProto:r.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:r.getOwnPropertyDescriptor,setDesc:r.defineProperty,setDescs:r.defineProperties,getKeys:r.keys,getNames:r.getOwnPropertyNames,getSymbols:r.getOwnPropertySymbols,each:[].forEach}},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0,e.registerDefaultHelpers=function(t){n.default(t),i.default(t),o.default(t),a.default(t),c.default(t),l.default(t),u.default(t)},e.moveHelperToHooks=function(t,e,r){t.helpers[e]&&(t.hooks[e]=t.helpers[e],r||delete t.helpers[e])};var n=s(r(11)),i=s(r(12)),o=s(r(25)),a=s(r(26)),c=s(r(27)),l=s(r(28)),u=s(r(29))},function(t,e,r){"use strict";e.__esModule=!0;var i=r(5);e.default=function(n){n.registerHelper("blockHelperMissing",function(t,e){var r=e.inverse,s=e.fn;return!0===t?s(this):!1===t||null==t?r(this):i.isArray(t)?0<t.length?(e.ids&&(e.ids=[e.name]),n.helpers.each(t,e)):r(this):(e.data&&e.ids&&((r=i.createFrame(e.data)).contextPath=i.appendContextPath(e.data.contextPath,e.name),e={data:r}),s(t,e))})},t.exports=e.default},function(e,r,s){!function(d){"use strict";var m=s(13).default,t=s(1).default;r.__esModule=!0;var g=s(5),v=t(s(6));r.default=function(t){t.registerHelper("each",function(s,t){function e(t,e,r){c&&(c.key=t,c.index=e,c.first=0===e,c.last=!!r,l&&(c.contextPath=l+t)),a+=n(s[t],{data:c,blockParams:g.blockParams([s[t],t],[l+t,null])})}if(!t)throw new v.default("Must pass iterator to #each");var r,n=t.fn,i=t.inverse,o=0,a="",c=void 0,l=void 0;if(t.data&&t.ids&&(l=g.appendContextPath(t.data.contextPath,t.ids[0])+"."),g.isFunction(s)&&(s=s.call(this)),t.data&&(c=g.createFrame(t.data)),s&&"object"==typeof s)if(g.isArray(s))for(var u=s.length;o<u;o++)o in s&&e(o,o,o===s.length-1);else if(d.Symbol&&s[d.Symbol.iterator]){for(var p=[],h=s[d.Symbol.iterator](),f=h.next();!f.done;f=h.next())p.push(f.value);for(u=(s=p).length;o<u;o++)e(o,o,o===s.length-1)}else r=void 0,m(s).forEach(function(t){void 0!==r&&e(r,o-1),r=t,o++}),void 0!==r&&e(r,o-1,!0);return a=0===o?i(this):a})},e.exports=r.default}.call(r,function(){return this}())},function(t,e,r){t.exports={default:r(14),__esModule:!0}},function(t,e,r){r(15),t.exports=r(21).Object.keys},function(t,e,r){var s=r(16);r(18)("keys",function(e){return function(t){return e(s(t))}})},function(t,e,r){var s=r(17);t.exports=function(t){return Object(s(t))}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,r){var n=r(19),i=r(21),o=r(24);t.exports=function(t,e){var r=(i.Object||{})[t]||Object[t],s={};s[t]=e(r),n(n.S+n.F*o(function(){r(1)}),"Object",s)}},function(t,e,r){var d=r(20),m=r(21),g=r(22),v="prototype",y=function(t,e,r){var s,n,i,o=t&y.F,a=t&y.G,c=t&y.S,l=t&y.P,u=t&y.B,p=t&y.W,h=a?m:m[e]||(m[e]={}),f=a?d:c?d[e]:(d[e]||{})[v];for(s in r=a?e:r)n=!o&&f&&s in f,n&&s in h||(i=(n?f:r)[s],h[s]=a&&"function"!=typeof f[s]?r[s]:u&&n?g(i,d):p&&f[s]==i?function(e){function t(t){return this instanceof e?new e(t):e(t)}return t[v]=e[v],t}(i):l&&"function"==typeof i?g(Function.call,i):i,l&&((h[v]||(h[v]={}))[s]=i))};y.F=1,y.G=2,y.S=4,y.P=8,y.B=16,y.W=32,t.exports=y},function(t,e){t=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},function(t,e){t=t.exports={version:"1.2.6"};"number"==typeof __e&&(__e=t)},function(t,e,r){var i=r(23);t.exports=function(s,n,t){if(i(s),void 0===n)return s;switch(t){case 1:return function(t){return s.call(n,t)};case 2:return function(t,e){return s.call(n,t,e)};case 3:return function(t,e,r){return s.call(n,t,e,r)}}return function(){return s.apply(n,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0;var n=s(r(6));e.default=function(t){t.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new n.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},t.exports=e.default},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0;var n=r(5),i=s(r(6));e.default=function(r){r.registerHelper("if",function(t,e){if(2!=arguments.length)throw new i.default("#if requires exactly one argument");return n.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||n.isEmpty(t)?e.inverse(this):e.fn(this)}),r.registerHelper("unless",function(t,e){if(2!=arguments.length)throw new i.default("#unless requires exactly one argument");return r.helpers.if.call(this,t,{fn:e.inverse,inverse:e.fn,hash:e.hash})})},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(n){n.registerHelper("log",function(){for(var t=[void 0],e=arguments[arguments.length-1],r=0;r<arguments.length-1;r++)t.push(arguments[r]);var s=1;null!=e.hash.level?s=e.hash.level:e.data&&null!=e.data.level&&(s=e.data.level),t[0]=s,n.log.apply(n,t)})},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("lookup",function(t,e,r){return t&&r.lookupProperty(t,e)})},t.exports=e.default},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0;var n=r(5),i=s(r(6));e.default=function(t){t.registerHelper("with",function(t,e){if(2!=arguments.length)throw new i.default("#with requires exactly one argument");n.isFunction(t)&&(t=t.call(this));var r=e.fn;if(n.isEmpty(t))return e.inverse(this);var s=e.data;return e.data&&e.ids&&((s=n.createFrame(e.data)).contextPath=n.appendContextPath(e.data.contextPath,e.ids[0])),r(t,{data:s,blockParams:n.blockParams([t],[s&&s.contextPath])})})},t.exports=e.default},function(t,e,r){"use strict";var s=r(1).default;e.__esModule=!0,e.registerDefaultDecorators=function(t){n.default(t)};var n=s(r(31))},function(t,e,r){"use strict";e.__esModule=!0;var o=r(5);e.default=function(t){t.registerDecorator("inline",function(s,n,i,t){var e=s;return n.partials||(n.partials={},e=function(t,e){var r=i.partials;i.partials=o.extend({},r,n.partials);e=s(t,e);return i.partials=r,e}),n.partials[t.args[0]]=t.fn,e})},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0;var s=r(5),n={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){var e;return t="string"==typeof t?0<=(e=s.indexOf(n.methodMap,t.toLowerCase()))?e:parseInt(t,10):t},log:function(t){if(t=n.lookupLevel(t),"undefined"!=typeof console&&n.lookupLevel(n.level)<=t){t=n.methodMap[t];console[t]||(t="log");for(var e=arguments.length,r=Array(1<e?e-1:0),s=1;s<e;s++)r[s-1]=arguments[s];console[t].apply(console,r)}}};e.default=n,t.exports=e.default},function(t,e,r){"use strict";function s(t,e){return void 0!==t.whitelist[e]?!0===t.whitelist[e]:void 0!==t.defaultValue?t.defaultValue:(!0!==l[e=e]&&(l[e]=!0,c.log("error",'Handlebars: Access has been denied to resolve the property "'+e+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details')),!1)}var n=r(34).default,i=r(13).default,o=r(3).default;e.__esModule=!0,e.createProtoAccessControl=function(t){var e=n(null);e.constructor=!1,e.__defineGetter__=!1,e.__defineSetter__=!1,e.__lookupGetter__=!1;var r=n(null);return r.__proto__=!1,{properties:{whitelist:a.createNewLookupObject(r,t.allowedProtoProperties),defaultValue:t.allowProtoPropertiesByDefault},methods:{whitelist:a.createNewLookupObject(e,t.allowedProtoMethods),defaultValue:t.allowProtoMethodsByDefault}}},e.resultIsAllowed=function(t,e,r){return s("function"==typeof t?e.methods:e.properties,r)},e.resetLoggedProperties=function(){i(l).forEach(function(t){delete l[t]})};var a=r(36),c=o(r(32)),l=n(null)},function(t,e,r){t.exports={default:r(35),__esModule:!0}},function(t,e,r){var s=r(9);t.exports=function(t,e){return s.create(t,e)}},function(t,e,r){"use strict";var s=r(34).default;e.__esModule=!0,e.createNewLookupObject=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.extend.apply(void 0,[s(null)].concat(e))};var n=r(5)},function(t,e){"use strict";function r(t){this.string=t}e.__esModule=!0,r.prototype.toString=r.prototype.toHTML=function(){return""+this.string},e.default=r,t.exports=e.default},function(t,e,r){"use strict";function a(s,t,n,i,e,o,a){function r(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=a;return!a||t==a[0]||t===s.nullContext&&null===a[0]||(r=[t].concat(a)),n(s,t,s.helpers,s.partials,e.data||i,o&&[e.blockParams].concat(o),r)}return(r=h(n,r,s,a,i,o)).program=t,r.depth=a?a.length:0,r.blockParams=e||0,r}function o(){return""}function h(t,e,r,s,n,i){var o;return t.decorator&&(o={},e=t.decorator(e,o,r,s&&s[0],n,i,s),f.extend(e,o)),e}var s=r(39).default,i=r(13).default,n=r(3).default,c=r(1).default;e.__esModule=!0,e.checkRevision=function(t){var e=t&&t[0]||1,r=m.COMPILER_REVISION;if(!(e>=m.LAST_COMPATIBLE_COMPILER_REVISION&&e<=m.COMPILER_REVISION)){if(e<m.LAST_COMPATIBLE_COMPILER_REVISION){r=m.REVISION_CHANGES[r],e=m.REVISION_CHANGES[e];throw new d.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+e+").")}throw new d.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}},e.template=function(c,l){function u(t){function e(t){return""+c.main(p,t,p.helpers,p.partials,i,a,o)}var r,s,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=n.data;u._setup(n),!n.partial&&c.useData&&(r=t,(s=i)&&"root"in s||((s=s?m.createFrame(s):{}).root=r),i=s);var o=void 0,a=c.useBlockParams?[]:void 0;return c.useDepths&&(o=n.depths?t!=n.depths[0]?[t].concat(n.depths):n.depths:[t]),(e=h(c.main,e,p,n.depths||[],i,a))(t,n)}if(!l)throw new d.default("No environment passed to template");if(!c||!c.main)throw new d.default("Unknown template object: "+typeof c);c.main.decorator=c.main_d,l.VM.checkRevision(c.compiler);var r=c.compiler&&7===c.compiler[0],p={strict:function(t,e,r){if(!(t&&e in t))throw new d.default('"'+e+'" not defined in '+t,{loc:r});return p.lookupProperty(t,e)},lookupProperty:function(t,e){var r=t[e];return null==r||Object.prototype.hasOwnProperty.call(t,e)||y.resultIsAllowed(r,p.protoAccessControl,e)?r:void 0},lookup:function(t,e){for(var r=t.length,s=0;s<r;s++)if(null!=(t[s]&&p.lookupProperty(t[s],e)))return t[s][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:f.escapeExpression,invokePartial:function(t,e,r){r.hash&&(e=f.extend({},e,r.hash),r.ids&&(r.ids[0]=!0)),t=l.VM.resolvePartial.call(this,t,e,r);var s=f.extend({},r,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),n=l.VM.invokePartial.call(this,t,e,s);if(null==n&&l.compile&&(r.partials[r.name]=l.compile(t,c.compilerOptions,l),n=r.partials[r.name](e,s)),null==n)throw new d.default("The partial "+r.name+" could not be compiled when running in runtime-only mode");if(r.indent){for(var i=n.split("\n"),o=0,a=i.length;o<a&&(i[o]||o+1!==a);o++)i[o]=r.indent+i[o];n=i.join("\n")}return n},fn:function(t){var e=c[t];return e.decorator=c[t+"_d"],e},programs:[],program:function(t,e,r,s,n){var i=this.programs[t],o=this.fn(t);return i=e||n||s||r?a(this,t,o,e,r,s,n):i||(this.programs[t]=a(this,t,o))},data:function(t,e){for(;t&&e--;)t=t._parent;return t},mergeIfNeeded:function(t,e){var r=t||e;return r=t&&e&&t!==e?f.extend({},e,t):r},nullContext:s({}),noop:l.VM.noop,compilerInfo:c.compiler};return u.isTop=!0,u._setup=function(t){var e,s,n;t.partial?(p.protoAccessControl=t.protoAccessControl,p.helpers=t.helpers,p.partials=t.partials,p.decorators=t.decorators,p.hooks=t.hooks):(e=f.extend({},l.helpers,t.helpers),n=p,i(s=e).forEach(function(t){var e,r=s[t];s[t]=(r=r,e=n.lookupProperty,v.wrapHelper(r,function(t){return f.extend({lookupProperty:e},t)}))}),p.helpers=e,c.usePartial&&(p.partials=p.mergeIfNeeded(t.partials,l.partials)),(c.usePartial||c.useDecorators)&&(p.decorators=f.extend({},l.decorators,t.decorators)),p.hooks={},p.protoAccessControl=y.createProtoAccessControl(t),t=t.allowCallsToHelperMissing||r,g.moveHelperToHooks(p,"helperMissing",t),g.moveHelperToHooks(p,"blockHelperMissing",t))},u._child=function(t,e,r,s){if(c.useBlockParams&&!r)throw new d.default("must pass block params");if(c.useDepths&&!s)throw new d.default("must pass parent depths");return a(p,t,c[t],e,0,r,s)},u},e.wrapProgram=a,e.resolvePartial=function(t,e,r){return t?t.call||r.name||(r.name=t,t=r.partials[t]):t="@partial-block"===r.name?r.data["partial-block"]:r.partials[r.name],t},e.invokePartial=function(t,e,s){var n=s.data&&s.data["partial-block"];s.partial=!0,s.ids&&(s.data.contextPath=s.ids[0]||s.data.contextPath);var i=void 0;if(s.fn&&s.fn!==o&&function(){s.data=m.createFrame(s.data);var r=s.fn;i=s.data["partial-block"]=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return e.data=m.createFrame(e.data),e.data["partial-block"]=n,r(t,e)},r.partials&&(s.partials=f.extend({},s.partials,r.partials))}(),void 0===(t=void 0===t&&i?i:t))throw new d.default("The partial "+s.name+" could not be found");if(t instanceof Function)return t(e,s)},e.noop=o;var f=n(r(5)),d=c(r(6)),m=r(4),g=r(10),v=r(43),y=r(33)},function(t,e,r){t.exports={default:r(40),__esModule:!0}},function(t,e,r){r(41),t.exports=r(21).Object.seal},function(t,e,r){var s=r(42);r(18)("seal",function(e){return function(t){return e&&s(t)?e(t):t}})},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){"use strict";e.__esModule=!0,e.wrapHelper=function(e,r){return"function"!=typeof e?e:function(){var t=arguments[arguments.length-1];return arguments[arguments.length-1]=r(t),e.apply(this,arguments)}}},function(t,e){!function(s){"use strict";e.__esModule=!0,e.default=function(t){var e=void 0!==s?s:window,r=e.Handlebars;t.noConflict=function(){return e.Handlebars===t&&(e.Handlebars=r),t}},t.exports=e.default}.call(e,function(){return this}())},function(t,e){"use strict";e.__esModule=!0;var r={helpers:{helperExpression:function(t){return"SubExpression"===t.type||("MustacheStatement"===t.type||"BlockStatement"===t.type)&&!!(t.params&&t.params.length||t.hash)},scopedId:function(t){return/^\.|this\b/.test(t.original)},simpleId:function(t){return 1===t.parts.length&&!r.helpers.scopedId(t)&&!t.depth}}};e.default=r,t.exports=e.default},function(t,e,r){"use strict";function s(t,e){return"Program"===t.type?t:((o.default.yy=c).locInfo=function(t){return new c.SourceLocation(e&&e.srcName,t)},o.default.parse(t))}var n=r(1).default,i=r(3).default;e.__esModule=!0,e.parseWithoutProcessing=s,e.parse=function(t,e){return t=s(t,e),new a.default(e).accept(t)};var o=n(r(47)),a=n(r(48)),i=i(r(50)),r=r(5);e.parser=o.default;var c={};r.extend(c,i)},function(t,e){"use strict";e.__esModule=!0;var r,s,r=(s={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,r=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var s=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);t=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===s.length?this.yylloc.first_column:0)+s[s.length-r.length].length-r[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[t[0],t[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(20<t.length?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(20<t.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;var t,e,r,s;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var n=this._currentRules(),i=0;i<n.length&&(!(e=this._input.match(this.rules[n[i]]))||t&&!(e[0].length>t[0].length)||(t=e,r=i,this.options.flex));i++);return t?((s=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],s=this.performAction.call(this,this.yy,this,n[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),s||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return void 0!==t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)},options:{},performAction:function(t,r,e,s){function n(t,e){return r.yytext=r.yytext.substring(t,r.yyleng-e+t)}switch(e){case 0:if("\\\\"===r.yytext.slice(-2)?(n(0,1),this.begin("mu")):"\\"===r.yytext.slice(-1)?(n(0,1),this.begin("emu")):this.begin("mu"),r.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),"raw"===this.conditionStack[this.conditionStack.length-1]?15:(n(5,9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(r.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return r.yytext=n(1,2).replace(/\\"/g,'"'),80;case 32:return r.yytext=n(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return r.yytext=r.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},rules:[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^\/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]+?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],conditions:{mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!(r={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,0],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(t,e,r,s,n,i,o){var a=i.length-1;switch(n){case 1:return i[a-1];case 2:this.$=s.prepareProgram(i[a]);break;case 3:case 4:case 5:case 6:case 7:case 8:this.$=i[a];break;case 9:this.$={type:"CommentStatement",value:s.stripComment(i[a]),strip:s.stripFlags(i[a],i[a]),loc:s.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:i[a],value:i[a],loc:s.locInfo(this._$)};break;case 11:this.$=s.prepareRawBlock(i[a-2],i[a-1],i[a],this._$);break;case 12:this.$={path:i[a-3],params:i[a-2],hash:i[a-1]};break;case 13:this.$=s.prepareBlock(i[a-3],i[a-2],i[a-1],i[a],!1,this._$);break;case 14:this.$=s.prepareBlock(i[a-3],i[a-2],i[a-1],i[a],!0,this._$);break;case 15:this.$={open:i[a-5],path:i[a-4],params:i[a-3],hash:i[a-2],blockParams:i[a-1],strip:s.stripFlags(i[a-5],i[a])};break;case 16:case 17:this.$={path:i[a-4],params:i[a-3],hash:i[a-2],blockParams:i[a-1],strip:s.stripFlags(i[a-5],i[a])};break;case 18:this.$={strip:s.stripFlags(i[a-1],i[a-1]),program:i[a]};break;case 19:var c=s.prepareBlock(i[a-2],i[a-1],i[a],i[a],!1,this._$),c=s.prepareProgram([c],i[a-1].loc);c.chained=!0,this.$={strip:i[a-2].strip,program:c,chain:!0};break;case 20:this.$=i[a];break;case 21:this.$={path:i[a-1],strip:s.stripFlags(i[a-2],i[a])};break;case 22:case 23:this.$=s.prepareMustache(i[a-3],i[a-2],i[a-1],i[a-4],s.stripFlags(i[a-4],i[a]),this._$);break;case 24:this.$={type:"PartialStatement",name:i[a-3],params:i[a-2],hash:i[a-1],indent:"",strip:s.stripFlags(i[a-4],i[a]),loc:s.locInfo(this._$)};break;case 25:this.$=s.preparePartialBlock(i[a-2],i[a-1],i[a],this._$);break;case 26:this.$={path:i[a-3],params:i[a-2],hash:i[a-1],strip:s.stripFlags(i[a-4],i[a])};break;case 27:case 28:this.$=i[a];break;case 29:this.$={type:"SubExpression",path:i[a-3],params:i[a-2],hash:i[a-1],loc:s.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:i[a],loc:s.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:s.id(i[a-2]),value:i[a],loc:s.locInfo(this._$)};break;case 32:this.$=s.id(i[a-1]);break;case 33:case 34:this.$=i[a];break;case 35:this.$={type:"StringLiteral",value:i[a],original:i[a],loc:s.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(i[a]),original:Number(i[a]),loc:s.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:"true"===i[a],original:"true"===i[a],loc:s.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:s.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:s.locInfo(this._$)};break;case 40:case 41:this.$=i[a];break;case 42:this.$=s.preparePath(!0,i[a],this._$);break;case 43:this.$=s.preparePath(!1,i[a],this._$);break;case 44:i[a-2].push({part:s.id(i[a]),original:i[a],separator:i[a-1]}),this.$=i[a-2];break;case 45:this.$=[{part:s.id(i[a]),original:i[a]}];break;case 46:this.$=[];break;case 47:i[a-1].push(i[a]);break;case 48:this.$=[];break;case 49:i[a-1].push(i[a]);break;case 50:this.$=[];break;case 51:i[a-1].push(i[a]);break;case 58:this.$=[];break;case 59:i[a-1].push(i[a]);break;case 64:this.$=[];break;case 65:i[a-1].push(i[a]);break;case 70:this.$=[];break;case 71:i[a-1].push(i[a]);break;case 78:this.$=[];break;case 79:i[a-1].push(i[a]);break;case 82:this.$=[];break;case 83:i[a-1].push(i[a]);break;case 86:this.$=[];break;case 87:i[a-1].push(i[a]);break;case 90:this.$=[];break;case 91:i[a-1].push(i[a]);break;case 94:this.$=[];break;case 95:i[a-1].push(i[a]);break;case 98:this.$=[i[a]];break;case 99:i[a-1].push(i[a]);break;case 100:this.$=[i[a]];break;case 101:i[a-1].push(i[a])}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{15:[2,48],17:39,18:[2,48]},{20:41,56:40,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:44,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:45,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:41,56:48,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:49,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,50]},{72:[1,35],86:51},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:52,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:53,38:55,39:[1,57],43:56,44:[1,58],45:54,47:[2,54]},{28:59,43:60,44:[1,58],47:[2,56]},{13:62,15:[1,20],18:[1,61]},{33:[2,86],57:63,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:64,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:65,47:[1,66]},{30:67,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:68,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:69,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:70,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:74,33:[2,80],50:71,63:72,64:75,65:[1,43],69:73,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,79]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,50]},{20:74,53:80,54:[2,84],63:81,64:75,65:[1,43],69:82,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:83,47:[1,66]},{47:[2,55]},{4:84,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:85,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:86,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:87,47:[1,66]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:74,33:[2,88],58:88,63:89,64:75,65:[1,43],69:90,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:91,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:92,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,31:93,33:[2,60],63:94,64:75,65:[1,43],69:95,70:76,71:77,72:[1,78],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,66],36:96,63:97,64:75,65:[1,43],69:98,70:76,71:77,72:[1,78],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,22:99,23:[2,52],63:100,64:75,65:[1,43],69:101,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,92],62:102,63:103,64:75,65:[1,43],69:104,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,105]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:106,72:[1,107],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,108],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,109]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:55,39:[1,57],43:56,44:[1,58],45:111,46:110,47:[2,76]},{33:[2,70],40:112,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,113]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:74,63:115,64:75,65:[1,43],67:114,68:[2,96],69:116,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,117]},{32:118,33:[2,62],74:119,75:[1,120]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:121,74:122,75:[1,120]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,123]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,124]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,108]},{20:74,63:125,64:75,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:74,33:[2,72],41:126,63:127,64:75,65:[1,43],69:128,70:76,71:77,72:[1,78],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,129]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,130]},{33:[2,63]},{72:[1,132],76:131},{33:[1,133]},{33:[2,69]},{15:[2,12],18:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:134,74:135,75:[1,120]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,137],77:[1,136]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,138]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],54:[2,55],56:[2,20],60:[2,57],73:[2,81],82:[2,85],86:[2,18],90:[2,89],101:[2,53],104:[2,93],110:[2,19],111:[2,77],116:[2,97],119:[2,63],122:[2,69],135:[2,75],136:[2,32]},parseError:function(t,e){throw new Error(t)},parse:function(t){var e=this,r=[0],s=[null],n=[],i=this.table,o="",a=0,c=0,l=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,void 0===(this.yy.parser=this).lexer.yylloc&&(this.lexer.yylloc={});var u=this.lexer.yylloc;n.push(u);var p=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var h,f,d,m,g,v,y,k,S,b={};;){if(d=r[r.length-1],void 0===(m=this.defaultActions[d]||(null!=h||(S=void 0,h=S="number"!=typeof(S=e.lexer.lex()||1)&&e.symbols_[S]||S),i[d]&&i[d][h]))||!m.length||!m[0]){var _;if(!l){for(v in k=[],i[d])this.terminals_[v]&&2<v&&k.push("'"+this.terminals_[v]+"'");_=this.lexer.showPosition?"Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[h]||h)+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==h?"end of input":"'"+(this.terminals_[h]||h)+"'"),this.parseError(_,{text:this.lexer.match,token:this.terminals_[h]||h,line:this.lexer.yylineno,loc:u,expected:k})}}if(m[0]instanceof Array&&1<m.length)throw new Error("Parse Error: multiple actions possible at state: "+d+", token: "+h);switch(m[0]){case 1:r.push(h),s.push(this.lexer.yytext),n.push(this.lexer.yylloc),r.push(m[1]),h=null,f?(h=f,f=null):(c=this.lexer.yyleng,o=this.lexer.yytext,a=this.lexer.yylineno,u=this.lexer.yylloc,0<l&&l--);break;case 2:if(y=this.productions_[m[1]][1],b.$=s[s.length-y],b._$={first_line:n[n.length-(y||1)].first_line,last_line:n[n.length-1].last_line,first_column:n[n.length-(y||1)].first_column,last_column:n[n.length-1].last_column},p&&(b._$.range=[n[n.length-(y||1)].range[0],n[n.length-1].range[1]]),void 0!==(g=this.performAction.call(b,o,c,a,this.yy,m[1],s,n)))return g;y&&(r=r.slice(0,-1*y*2),s=s.slice(0,-1*y),n=n.slice(0,-1*y)),r.push(this.productions_[m[1]][0]),s.push(b.$),n.push(b._$),y=i[r[r.length-2]][r[r.length-1]],r.push(y);break;case 3:return!0}}return!0}})},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}}},r.lexer=s,new((n.prototype=r).Parser=n));function n(){this.yy={}}e.default=r,t.exports=e.default},function(t,e,r){"use strict";function s(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=t}function h(t,e,r){var s=t[(e=void 0===e?t.length:e)-1],e=t[e-2];return s?"ContentStatement"===s.type?(e||!r?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(s.original):void 0:r}function f(t,e,r){var s=t[(e=void 0===e?-1:e)+1],e=t[e+2];return s?"ContentStatement"===s.type?(e||!r?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(s.original):void 0:r}function d(t,e,r){t=t[null==e?0:e+1];!t||"ContentStatement"!==t.type||!r&&t.rightStripped||(e=t.value,t.value=t.value.replace(r?/^\s+/:/^[ \t]*\r?\n?/,""),t.rightStripped=t.value!==e)}function m(t,e,r){t=t[null==e?t.length-1:e-1];if(t&&"ContentStatement"===t.type&&(r||!t.leftStripped)){e=t.value;return t.value=t.value.replace(r?/\s+$/:/[ \t]+$/,""),t.leftStripped=t.value!==e,t.leftStripped}}var n=r(1).default;e.__esModule=!0;r=n(r(49));(s.prototype=new r.default).Program=function(t){var e=!this.options.ignoreStandalone,r=!this.isRootSeen;this.isRootSeen=!0;for(var s=t.body,n=0,i=s.length;n<i;n++){var o,a,c,l,u=s[n],p=this.accept(u);p&&(o=h(s,n,r),l=f(s,n,r),a=p.openStandalone&&o,c=p.closeStandalone&&l,l=p.inlineStandalone&&o&&l,p.close&&d(s,n,!0),p.open&&m(s,n,!0),e&&l&&(d(s,n),m(s,n)&&"PartialStatement"===u.type&&(u.indent=/([ \t]+$)/.exec(s[n-1].original)[1])),e&&a&&(d((u.program||u.inverse).body),m(s,n)),e&&c&&(d(s,n),m((u.inverse||u.program).body)))}return t},s.prototype.BlockStatement=s.prototype.DecoratorBlock=s.prototype.PartialBlockStatement=function(t){this.accept(t.program),this.accept(t.inverse);var e=t.program||t.inverse,r=t.program&&t.inverse,s=r,n=r;if(r&&r.chained)for(s=r.body[0].program;n.chained;)n=n.body[n.body.length-1].program;var i={open:t.openStrip.open,close:t.closeStrip.close,openStandalone:f(e.body),closeStandalone:h((s||e).body)};return t.openStrip.close&&d(e.body,null,!0),r?((r=t.inverseStrip).open&&m(e.body,null,!0),r.close&&d(s.body,null,!0),t.closeStrip.open&&m(n.body,null,!0),!this.options.ignoreStandalone&&h(e.body)&&f(s.body)&&(m(e.body),d(s.body))):t.closeStrip.open&&m(e.body,null,!0),i},s.prototype.Decorator=s.prototype.MustacheStatement=function(t){return t.strip},s.prototype.PartialStatement=s.prototype.CommentStatement=function(t){t=t.strip||{};return{inlineStandalone:!0,open:t.open,close:t.close}},e.default=s,t.exports=e.default},function(t,e,r){"use strict";function s(){this.parents=[]}function n(t){this.acceptRequired(t,"path"),this.acceptArray(t.params),this.acceptKey(t,"hash")}function i(t){n.call(this,t),this.acceptKey(t,"program"),this.acceptKey(t,"inverse")}function o(t){this.acceptRequired(t,"name"),this.acceptArray(t.params),this.acceptKey(t,"hash")}var a=r(1).default;e.__esModule=!0;var c=a(r(6));s.prototype={constructor:s,mutating:!1,acceptKey:function(t,e){var r=this.accept(t[e]);if(this.mutating){if(r&&!s.prototype[r.type])throw new c.default('Unexpected node type "'+r.type+'" found when accepting '+e+" on "+t.type);t[e]=r}},acceptRequired:function(t,e){if(this.acceptKey(t,e),!t[e])throw new c.default(t.type+" requires "+e)},acceptArray:function(t){for(var e=0,r=t.length;e<r;e++)this.acceptKey(t,e),t[e]||(t.splice(e,1),e--,r--)},accept:function(t){if(t){if(!this[t.type])throw new c.default("Unknown type: "+t.type,t);this.current&&this.parents.unshift(this.current),this.current=t;var e=this[t.type](t);return this.current=this.parents.shift(),!this.mutating||e?e:!1!==e?t:void 0}},Program:function(t){this.acceptArray(t.body)},MustacheStatement:n,Decorator:n,BlockStatement:i,DecoratorBlock:i,PartialStatement:o,PartialBlockStatement:function(t){o.call(this,t),this.acceptKey(t,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:n,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(t){this.acceptArray(t.pairs)},HashPair:function(t){this.acceptRequired(t,"value")}},e.default=s,t.exports=e.default},function(t,e,r){"use strict";function l(t,e){if(e=e.path?e.path.original:e,t.path.original!==e){var r={loc:t.path.loc};throw new u.default(t.path.original+" doesn't match "+e,r)}}var s=r(1).default;e.__esModule=!0,e.SourceLocation=function(t,e){this.source=t,this.start={line:e.first_line,column:e.first_column},this.end={line:e.last_line,column:e.last_column}},e.id=function(t){return/^\[.*\]$/.test(t)?t.substring(1,t.length-1):t},e.stripFlags=function(t,e){return{open:"~"===t.charAt(2),close:"~"===e.charAt(e.length-3)}},e.stripComment=function(t){return t.replace(/^\{\{~?!-?-?/,"").replace(/-?-?~?\}\}$/,"")},e.preparePath=function(t,e,r){r=this.locInfo(r);for(var s=t?"@":"",n=[],i=0,o=0,a=e.length;o<a;o++){var c=e[o].part,l=e[o].original!==c;if(s+=(e[o].separator||"")+c,l||".."!==c&&"."!==c&&"this"!==c)n.push(c);else{if(0<n.length)throw new u.default("Invalid path: "+s,{loc:r});".."===c&&i++}}return{type:"PathExpression",data:t,depth:i,parts:n,original:s,loc:r}},e.prepareMustache=function(t,e,r,s,n,i){var o="{"!==(o=s.charAt(3)||s.charAt(2))&&"&"!==o;return{type:/\*/.test(s)?"Decorator":"MustacheStatement",path:t,params:e,hash:r,escaped:o,strip:n,loc:this.locInfo(i)}},e.prepareRawBlock=function(t,e,r,s){return l(t,r),e={type:"Program",body:e,strip:{},loc:s=this.locInfo(s)},{type:"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:e,openStrip:{},inverseStrip:{},closeStrip:{},loc:s}},e.prepareBlock=function(t,e,r,s,n,i){s&&s.path&&l(t,s);var o=/\*/.test(t.open);e.blockParams=t.blockParams;var a=void 0,c=void 0;if(r){if(o)throw new u.default("Unexpected inverse block on decorator",r);r.chain&&(r.program.body[0].closeStrip=s.strip),c=r.strip,a=r.program}return n&&(n=a,a=e,e=n),{type:o?"DecoratorBlock":"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:e,inverse:a,openStrip:t.strip,inverseStrip:c,closeStrip:s&&s.strip,loc:this.locInfo(i)}},e.prepareProgram=function(t,e){var r,s;return!e&&t.length&&(r=t[0].loc,s=t[t.length-1].loc,r&&s&&(e={source:r.source,start:{line:r.start.line,column:r.start.column},end:{line:s.end.line,column:s.end.column}})),{type:"Program",body:t,strip:{},loc:e}},e.preparePartialBlock=function(t,e,r,s){return l(t,r),{type:"PartialBlockStatement",name:t.path,params:t.params,hash:t.hash,program:e,openStrip:t.strip,closeStrip:r&&r.strip,loc:this.locInfo(s)}};var u=s(r(6))},function(t,e,r){"use strict";function s(){}function n(t){var e;t.path.parts||(e=t.path,t.path={type:"PathExpression",data:!1,depth:0,parts:[e.original+""],original:e.original+"",loc:e.loc})}var i=r(34).default,o=r(1).default;e.__esModule=!0,e.Compiler=s,e.precompile=function(t,e,r){if(null==t||"string"!=typeof t&&"Program"!==t.type)throw new a.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);return"data"in(e=e||{})||(e.data=!0),e.compat&&(e.useDepths=!0),t=r.parse(t,e),t=(new r.Compiler).compile(t,e),(new r.JavaScriptCompiler).compile(t,e)},e.compile=function(e,r,s){function n(){var t=s.parse(e,r),t=(new s.Compiler).compile(t,r),t=(new s.JavaScriptCompiler).compile(t,r,void 0,!0);return s.template(t)}function t(t,e){return(i=i||n()).call(this,t,e)}if(void 0===r&&(r={}),null==e||"string"!=typeof e&&"Program"!==e.type)throw new a.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+e);"data"in(r=c.extend({},r))||(r.data=!0),r.compat&&(r.useDepths=!0);var i=void 0;return t._setup=function(t){return(i=i||n())._setup(t)},t._child=function(t,e,r,s){return(i=i||n())._child(t,e,r,s)},t};var a=o(r(6)),c=r(5),l=o(r(45)),u=[].slice;s.prototype={compiler:s,equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e)return!1;for(var r=0;r<e;r++){var s=this.opcodes[r],n=t.opcodes[r];if(s.opcode!==n.opcode||!function t(e,r){if(e===r)return 1;if(c.isArray(e)&&c.isArray(r)&&e.length===r.length){for(var s=0;s<e.length;s++)if(!t(e[s],r[s]))return;return 1}}(s.args,n.args))return!1}for(e=this.children.length,r=0;r<e;r++)if(!this.children[r].equals(t.children[r]))return!1;return!0},guid:0,compile:function(t,e){return this.sourceNode=[],this.opcodes=[],this.children=[],this.options=e,this.stringParams=e.stringParams,this.trackIds=e.trackIds,e.blockParams=e.blockParams||[],e.knownHelpers=c.extend(i(null),{helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},e.knownHelpers),this.accept(t)},compileProgram:function(t){var e=(new this.compiler).compile(t,this.options),t=this.guid++;return this.usePartial=this.usePartial||e.usePartial,this.children[t]=e,this.useDepths=this.useDepths||e.useDepths,t},accept:function(t){if(!this[t.type])throw new a.default("Unknown type: "+t.type,t);this.sourceNode.unshift(t);t=this[t.type](t);return this.sourceNode.shift(),t},Program:function(t){this.options.blockParams.unshift(t.blockParams);for(var e=t.body,r=e.length,s=0;s<r;s++)this.accept(e[s]);return this.options.blockParams.shift(),this.isSimple=1===r,this.blockParams=t.blockParams?t.blockParams.length:0,this},BlockStatement:function(t){n(t);var e=t.program,r=t.inverse,e=e&&this.compileProgram(e),r=r&&this.compileProgram(r),s=this.classifySexpr(t);"helper"===s?this.helperSexpr(t,e,r):"simple"===s?(this.simpleSexpr(t),this.opcode("pushProgram",e),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("blockValue",t.path.original)):(this.ambiguousSexpr(t,e,r),this.opcode("pushProgram",e),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(t){var e=t.program&&this.compileProgram(t.program),e=this.setupFullMustacheParams(t,e,void 0),t=t.path;this.useDecorators=!0,this.opcode("registerDecorator",e.length,t.original)},PartialStatement:function(t){this.usePartial=!0;var e=(e=t.program)&&this.compileProgram(t.program),r=t.params;if(1<r.length)throw new a.default("Unsupported number of partial arguments: "+r.length,t);r.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):r.push({type:"PathExpression",parts:[],depth:0}));var s=t.name.original,r="SubExpression"===t.name.type;r&&this.accept(t.name),this.setupFullMustacheParams(t,e,void 0,!0);t=t.indent||"";this.options.preventIndent&&t&&(this.opcode("appendContent",t),t=""),this.opcode("invokePartial",r,s,t),this.opcode("append")},PartialBlockStatement:function(t){this.PartialStatement(t)},MustacheStatement:function(t){this.SubExpression(t),t.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(t){this.DecoratorBlock(t)},ContentStatement:function(t){t.value&&this.opcode("appendContent",t.value)},CommentStatement:function(){},SubExpression:function(t){n(t);var e=this.classifySexpr(t);"simple"===e?this.simpleSexpr(t):"helper"===e?this.helperSexpr(t):this.ambiguousSexpr(t)},ambiguousSexpr:function(t,e,r){var s=t.path,n=s.parts[0],t=null!=e||null!=r;this.opcode("getContext",s.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",r),s.strict=!0,this.accept(s),this.opcode("invokeAmbiguous",n,t)},simpleSexpr:function(t){t=t.path;t.strict=!0,this.accept(t),this.opcode("resolvePossibleLambda")},helperSexpr:function(t,e,r){var s=this.setupFullMustacheParams(t,e,r),e=t.path,r=e.parts[0];if(this.options.knownHelpers[r])this.opcode("invokeKnownHelper",s.length,r);else{if(this.options.knownHelpersOnly)throw new a.default("You specified knownHelpersOnly, but used the unknown helper "+r,t);e.strict=!0,e.falsy=!0,this.accept(e),this.opcode("invokeHelper",s.length,e.original,l.default.helpers.simpleId(e))}},PathExpression:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var e=t.parts[0],r=l.default.helpers.scopedId(t),s=!t.depth&&!r&&this.blockParamIndex(e);s?this.opcode("lookupBlockParam",s,t.parts):e?t.data?(this.options.data=!0,this.opcode("lookupData",t.depth,t.parts,t.strict)):this.opcode("lookupOnContext",t.parts,t.falsy,t.strict,r):this.opcode("pushContext")},StringLiteral:function(t){this.opcode("pushString",t.value)},NumberLiteral:function(t){this.opcode("pushLiteral",t.value)},BooleanLiteral:function(t){this.opcode("pushLiteral",t.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(t){var e=t.pairs,r=0,s=e.length;for(this.opcode("pushHash");r<s;r++)this.pushParam(e[r].value);for(;r--;)this.opcode("assignToHash",e[r].key);this.opcode("popHash")},opcode:function(t){this.opcodes.push({opcode:t,args:u.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(t){t&&(this.useDepths=!0)},classifySexpr:function(t){var e=l.default.helpers.simpleId(t.path),r=e&&!!this.blockParamIndex(t.path.parts[0]),s=!r&&l.default.helpers.helperExpression(t),r=!r&&(s||e);return r&&!s&&(e=t.path.parts[0],(t=this.options).knownHelpers[e]?s=!0:t.knownHelpersOnly&&(r=!1)),s?"helper":r?"ambiguous":"simple"},pushParams:function(t){for(var e=0,r=t.length;e<r;e++)this.pushParam(t[e])},pushParam:function(t){var e,r,s=null!=t.value?t.value:t.original||"";this.stringParams?(s.replace&&(s=s.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",s,t.type),"SubExpression"===t.type&&this.accept(t)):(this.trackIds&&(e=void 0,(e=!t.parts||l.default.helpers.scopedId(t)||t.depth?e:this.blockParamIndex(t.parts[0]))?(r=t.parts.slice(1).join("."),this.opcode("pushId","BlockParam",e,r)):((s=t.original||s).replace&&(s=s.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",t.type,s))),this.accept(t))},setupFullMustacheParams:function(t,e,r,s){var n=t.params;return this.pushParams(n),this.opcode("pushProgram",e),this.opcode("pushProgram",r),t.hash?this.accept(t.hash):this.opcode("emptyHash",s),n},blockParamIndex:function(t){for(var e=0,r=this.options.blockParams.length;e<r;e++){var s=this.options.blockParams[e],n=s&&c.indexOf(s,t);if(s&&0<=n)return[e,n]}}}},function(t,e,r){"use strict";function a(t){this.value=t}function n(){}var o=r(13).default,s=r(1).default;e.__esModule=!0;var i=r(4),h=s(r(6)),c=r(5),l=s(r(53));n.prototype={nameLookup:function(t,e){return this.internalNameLookup(t,e)},depthedLookup:function(t){return[this.aliasable("container.lookup"),"(depths, ",JSON.stringify(t),")"]},compilerInfo:function(){var t=i.COMPILER_REVISION;return[t,i.REVISION_CHANGES[t]]},appendToBuffer:function(t,e,r){return c.isArray(t)||(t=[t]),t=this.source.wrap(t,e),this.environment.isSimple?["return ",t,";"]:r?["buffer += ",t,";"]:(t.appendToBuffer=!0,t)},initializeBuffer:function(){return this.quotedString("")},internalNameLookup:function(t,e){return this.lookupPropertyFunctionIsUsed=!0,["lookupProperty(",t,",",JSON.stringify(e),")"]},lookupPropertyFunctionIsUsed:!1,compile:function(t,e,r,s){this.environment=t,this.options=e,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!s,this.name=this.environment.name,this.isChild=!!r,this.context=r||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(t,e),this.useDepths=this.useDepths||t.useDepths||t.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||t.useBlockParams;for(var n,i=t.opcodes,o=void 0,a=void 0,c=void 0,a=0,c=i.length;a<c;a++)n=i[a],this.source.currentLocation=n.loc,o=o||n.loc,this[n.opcode].apply(this,n.args);if(this.source.currentLocation=o,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new h.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend(["var decorators = container.decorators, ",this.lookupPropertyFunctionVarDeclaration(),";\n"]),this.decorators.push("return fn;"),s?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend("function(fn, props, container, depth0, data, blockParams, depths) {\n"),this.decorators.push("}\n"),this.decorators=this.decorators.merge()));t=this.createFunctionContext(s);if(this.isChild)return t;var l={compiler:this.compilerInfo(),main:t};this.decorators&&(l.main_d=this.decorators,l.useDecorators=!0);var t=this.context,u=t.programs,p=t.decorators;for(a=0,c=u.length;a<c;a++)u[a]&&(l[a]=u[a],p[a]&&(l[a+"_d"]=p[a],l.useDecorators=!0));return this.environment.usePartial&&(l.usePartial=!0),this.options.data&&(l.useData=!0),this.useDepths&&(l.useDepths=!0),this.useBlockParams&&(l.useBlockParams=!0),this.options.compat&&(l.compat=!0),s?l.compilerOptions=this.options:(l.compiler=JSON.stringify(l.compiler),this.source.currentLocation={start:{line:1,column:0}},l=this.objectLiteral(l),e.srcName?(l=l.toStringWithSourceMap({file:e.destName})).map=l.map&&l.map.toString():l=l.toString()),l},preamble:function(){this.lastContext=0,this.source=new l.default(this.options.srcName),this.decorators=new l.default(this.options.srcName)},createFunctionContext:function(t){var r=this,s="",e=this.stackVars.concat(this.registers.list);0<e.length&&(s+=", "+e.join(", "));var n=0;o(this.aliases).forEach(function(t){var e=r.aliases[t];e.children&&1<e.referenceCount&&(s+=", alias"+ ++n+"="+t,e.children[0]="alias"+n)}),this.lookupPropertyFunctionIsUsed&&(s+=", "+this.lookupPropertyFunctionVarDeclaration());var i=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&i.push("blockParams"),this.useDepths&&i.push("depths");e=this.mergeSource(s);return t?(i.push(e),Function.apply(this,i)):this.source.wrap(["function(",i.join(","),") {\n  ",e,"}"])},mergeSource:function(t){var e=this.environment.isSimple,r=!this.forceBuffer,s=void 0,n=void 0,i=void 0,o=void 0;return this.source.each(function(t){t.appendToBuffer?(i?t.prepend("  + "):i=t,o=t):(i&&(n?i.prepend("buffer += "):s=!0,o.add(";"),i=o=void 0),n=!0,e||(r=!1))}),r?i?(i.prepend("return "),o.add(";")):n||this.source.push('return "";'):(t+=", buffer = "+(s?"":this.initializeBuffer()),i?(i.prepend("return buffer + "),o.add(";")):this.source.push("return buffer;")),t&&this.source.prepend("var "+t.substring(2)+(s?"":";\n")),this.source.merge()},lookupPropertyFunctionVarDeclaration:function(){return"\n      lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    }\n    ".trim()},blockValue:function(t){var e=this.aliasable("container.hooks.blockHelperMissing"),r=[this.contextName(0)];this.setupHelperArgs(t,0,r);t=this.popStack();r.splice(1,0,t),this.push(this.source.functionCall(e,"call",r))},ambiguousBlockValue:function(){var t=this.aliasable("container.hooks.blockHelperMissing"),e=[this.contextName(0)];this.setupHelperArgs("",0,e,!0),this.flushInline();var r=this.topStack();e.splice(1,0,r),this.pushSource(["if (!",this.lastHelper,") { ",r," = ",this.source.functionCall(t,"call",e),"}"])},appendContent:function(t){this.pendingContent?t=this.pendingContent+t:this.pendingLocation=this.source.currentLocation,this.pendingContent=t},append:function(){var t;this.isInline()?(this.replaceStack(function(t){return[" != null ? ",t,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()))):(t=this.popStack(),this.pushSource(["if (",t," != null) { ",this.appendToBuffer(t,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"]))},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(t){this.lastContext=t},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(t,e,r,s){var n=0;s||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(t[n++])),this.resolvePath("context",t,n,e,r)},lookupBlockParam:function(t,e){this.useBlockParams=!0,this.push(["blockParams[",t[0],"][",t[1],"]"]),this.resolvePath("context",e,1)},lookupData:function(t,e,r){t?this.pushStackLiteral("container.data(data, "+t+")"):this.pushStackLiteral("data"),this.resolvePath("data",e,0,!0,r)},resolvePath:function(r,s,n,i,t){var o=this;if(this.options.strict||this.options.assumeObjects)this.push(function(t,e,r,s){var n=e.popStack(),i=0,o=r.length;for(t&&o--;i<o;i++)n=e.nameLookup(n,r[i],s);return t?[e.aliasable("container.strict"),"(",n,", ",e.quotedString(r[i]),", ",JSON.stringify(e.source.currentLocation)," )"]:n}(this.options.strict&&t,this,s,r));else for(var e=s.length;n<e;n++)this.replaceStack(function(t){var e=o.nameLookup(t,s[n],r);return i?[" && ",e]:[" != null ? ",e," : ",t]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(t,e){this.pushContext(),this.pushString(e),"SubExpression"!==e&&("string"==typeof t?this.pushString(t):this.pushStackLiteral(t))},emptyHash:function(t){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(t?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:{},types:[],contexts:[],ids:[]}},popHash:function(){var t=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(t.ids)),this.stringParams&&(this.push(this.objectLiteral(t.contexts)),this.push(this.objectLiteral(t.types))),this.push(this.objectLiteral(t.values))},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){null!=t?this.pushStackLiteral(this.programExpression(t)):this.pushStackLiteral(null)},registerDecorator:function(t,e){var r=this.nameLookup("decorators",e,"decorator"),t=this.setupHelperArgs(e,t);this.decorators.push(["fn = ",this.decorators.functionCall(r,"",["fn","props","container",t])," || fn;"])},invokeHelper:function(t,e,r){var s=this.popStack(),t=this.setupHelper(t,e),e=[];r&&e.push(t.name),e.push(s),this.options.strict||e.push(this.aliasable("container.hooks.helperMissing"));e=["(",this.itemsSeparatedBy(e,"||"),")"],t=this.source.functionCall(e,"call",t.callParams);this.push(t)},itemsSeparatedBy:function(t,e){var r=[];r.push(t[0]);for(var s=1;s<t.length;s++)r.push(e,t[s]);return r},invokeKnownHelper:function(t,e){e=this.setupHelper(t,e);this.push(this.source.functionCall(e.name,"call",e.callParams))},invokeAmbiguous:function(t,e){this.useRegister("helper");var r=this.popStack();this.emptyHash();e=this.setupHelper(0,t,e),r=["(","(helper = ",this.lastHelper=this.nameLookup("helpers",t,"helper")," || ",r,")"];this.options.strict||(r[0]="(helper = ",r.push(" != null ? helper : ",this.aliasable("container.hooks.helperMissing"))),this.push(["(",r,e.paramsInit?["),(",e.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",e.callParams)," : helper))"])},invokePartial:function(t,e,r){var s=[],n=this.setupParams(e,1,s);t&&(e=this.popStack(),delete n.name),r&&(n.indent=JSON.stringify(r)),n.helpers="helpers",n.partials="partials",n.decorators="container.decorators",t?s.unshift(e):s.unshift(this.nameLookup("partials",e,"partial")),this.options.compat&&(n.depths="depths"),n=this.objectLiteral(n),s.push(n),this.push(this.source.functionCall("container.invokePartial","",s))},assignToHash:function(t){var e=this.popStack(),r=void 0,s=void 0,n=void 0;this.trackIds&&(n=this.popStack()),this.stringParams&&(s=this.popStack(),r=this.popStack());var i=this.hash;r&&(i.contexts[t]=r),s&&(i.types[t]=s),n&&(i.ids[t]=n),i.values[t]=e},pushId:function(t,e,r){"BlockParam"===t?this.pushStackLiteral("blockParams["+e[0]+"].path["+e[1]+"]"+(r?" + "+JSON.stringify("."+r):"")):"PathExpression"===t?this.pushString(e):"SubExpression"===t?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:n,compileChildren:function(t,e){for(var r=t.children,s=void 0,n=void 0,i=0,o=r.length;i<o;i++){var a,s=r[i],n=new this.compiler,c=this.matchExistingProgram(s);null==c?(this.context.programs.push(""),a=this.context.programs.length,s.index=a,s.name="program"+a,this.context.programs[a]=n.compile(s,e,this.context,!this.precompile),this.context.decorators[a]=n.decorators,this.context.environments[a]=s,this.useDepths=this.useDepths||n.useDepths,this.useBlockParams=this.useBlockParams||n.useBlockParams,s.useDepths=this.useDepths,s.useBlockParams=this.useBlockParams):(s.index=c.index,s.name="program"+c.index,this.useDepths=this.useDepths||c.useDepths,this.useBlockParams=this.useBlockParams||c.useBlockParams)}},matchExistingProgram:function(t){for(var e=0,r=this.context.environments.length;e<r;e++){var s=this.context.environments[e];if(s&&s.equals(t))return s}},programExpression:function(t){t=this.environment.children[t],t=[t.index,"data",t.blockParams];return(this.useBlockParams||this.useDepths)&&t.push("blockParams"),this.useDepths&&t.push("depths"),"container.program("+t.join(", ")+")"},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},push:function(t){return t instanceof a||(t=this.source.wrap(t)),this.inlineStack.push(t),t},pushStackLiteral:function(t){this.push(new a(t))},pushSource:function(t){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),t&&this.source.push(t)},replaceStack:function(t){var e=["("],r=void 0,s=void 0,n=void 0;if(!this.isInline())throw new h.default("replaceStack on non-inline");var i,o=this.popStack(!0);o instanceof a?(e=["(",r=[o.value]],n=!0):(s=!0,i=this.incrStack(),e=["((",this.push(i)," = ",o,")"],r=this.topStack());r=t.call(this,r);n||this.popStack(),s&&this.stackSlot--,this.push(e.concat(r,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;this.inlineStack=[];for(var e=0,r=t.length;e<r;e++){var s,n=t[e];n instanceof a?this.compileStack.push(n):(s=this.incrStack(),this.pushSource([s," = ",n,";"]),this.compileStack.push(s))}},isInline:function(){return this.inlineStack.length},popStack:function(t){var e=this.isInline(),r=(e?this.inlineStack:this.compileStack).pop();if(!t&&r instanceof a)return r.value;if(!e){if(!this.stackSlot)throw new h.default("Invalid stack pop");this.stackSlot--}return r},topStack:function(){var t=this.isInline()?this.inlineStack:this.compileStack,t=t[t.length-1];return t instanceof a?t.value:t},contextName:function(t){return this.useDepths&&t?"depths["+t+"]":"depth"+t},quotedString:function(t){return this.source.quotedString(t)},objectLiteral:function(t){return this.source.objectLiteral(t)},aliasable:function(t){var e=this.aliases[t];return e?e.referenceCount++:((e=this.aliases[t]=this.source.wrap(t)).aliasable=!0,e.referenceCount=1),e},setupHelper:function(t,e,r){var s=[];return{params:s,paramsInit:this.setupHelperArgs(e,t,s,r),name:this.nameLookup("helpers",e,"helper"),callParams:[this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : (container.nullContext || {})")].concat(s)}},setupParams:function(t,e,r){var s,n={},i=[],o=[],a=[],c=!r;c&&(r=[]),n.name=this.quotedString(t),n.hash=this.popStack(),this.trackIds&&(n.hashIds=this.popStack()),this.stringParams&&(n.hashTypes=this.popStack(),n.hashContexts=this.popStack());var l=this.popStack(),t=this.popStack();(t||l)&&(n.fn=t||"container.noop",n.inverse=l||"container.noop");for(var u=e;u--;)s=this.popStack(),r[u]=s,this.trackIds&&(a[u]=this.popStack()),this.stringParams&&(o[u]=this.popStack(),i[u]=this.popStack());return c&&(n.args=this.source.generateArray(r)),this.trackIds&&(n.ids=this.source.generateArray(a)),this.stringParams&&(n.types=this.source.generateArray(o),n.contexts=this.source.generateArray(i)),this.options.data&&(n.data="data"),this.useBlockParams&&(n.blockParams="blockParams"),n},setupHelperArgs:function(t,e,r,s){e=this.setupParams(t,e,r);return e.loc=JSON.stringify(this.source.currentLocation),e=this.objectLiteral(e),s?(this.useRegister("options"),r.push("options"),["options=",e]):r?(r.push(e),""):e}},function(){for(var t="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),e=n.RESERVED_WORDS={},r=0,s=t.length;r<s;r++)e[t[r]]=!0}(),n.isValidJavaScriptVariableName=function(t){return!n.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)},e.default=n,t.exports=e.default},function(t,e,r){"use strict";function i(t,e,r){if(a.isArray(t)){for(var s=[],n=0,i=t.length;n<i;n++)s.push(e.wrap(t[n],r));return s}return"boolean"==typeof t||"number"==typeof t?t+"":t}function s(t){this.srcFile=t,this.source=[]}var o=r(13).default;e.__esModule=!0;var a=r(5),n=void 0;n||((n=function(t,e,r,s){this.src="",s&&this.add(s)}).prototype={add:function(t){a.isArray(t)&&(t=t.join("")),this.src+=t},prepend:function(t){a.isArray(t)&&(t=t.join("")),this.src=t+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),s.prototype={isEmpty:function(){return!this.source.length},prepend:function(t,e){this.source.unshift(this.wrap(t,e))},push:function(t,e){this.source.push(this.wrap(t,e))},merge:function(){var e=this.empty();return this.each(function(t){e.add(["  ",t,"\n"])}),e},each:function(t){for(var e=0,r=this.source.length;e<r;e++)t(this.source[e])},empty:function(){var t=this.currentLocation||{start:{}};return new n(t.start.line,t.start.column,this.srcFile)},wrap:function(t){var e=arguments.length<=1||void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return t instanceof n?t:(t=i(t,this,e),new n(e.start.line,e.start.column,this.srcFile,t))},functionCall:function(t,e,r){return r=this.generateList(r),this.wrap([t,e?"."+e+"(":"(",r,")"])},quotedString:function(t){return'"'+(t+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(r){var s=this,n=[];o(r).forEach(function(t){var e=i(r[t],s);"undefined"!==e&&n.push([s.quotedString(t),":",e])});var t=this.generateList(n);return t.prepend("{"),t.add("}"),t},generateList:function(t){for(var e=this.empty(),r=0,s=t.length;r<s;r++)r&&e.add(","),e.add(i(t[r],this));return e},generateArray:function(t){t=this.generateList(t);return t.prepend("["),t.add("]"),t}},e.default=s,t.exports=e.default}],r.c=n,r.p="",r(0);function r(t){if(n[t])return n[t].exports;var e=n[t]={exports:{},id:t,loaded:!1};return s[t].call(e.exports,e,e.exports,r),e.loaded=!0,e.exports}var s,n});
function getDistanceFromLatLonInKm(e,r,t,n){var a=deg2rad(t-e),r=deg2rad(n-r),r=Math.sin(a/2)*Math.sin(a/2)+Math.cos(deg2rad(e))*Math.cos(deg2rad(t))*Math.sin(r/2)*Math.sin(r/2);return 6371*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)))}function deg2rad(e){return e*(Math.PI/180)}Handlebars.registerHelper("ifeq",function(e,r,t){return e==r?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("getLabel",function(e,r,t,n){return e&&r&&t&&r[t]?"object"==typeof e[r[t]]?e[r[t]].label||"...":e[r[t]]:e&&e[0]&&e[0].label?"...":""}),Handlebars.registerHelper("getStatusText",function(e,r,t,n){return e[r[t]]?e[r[t]].label:"..."}),Handlebars.registerHelper("round",function(e,r){return Math.round(e)}),Handlebars.registerHelper("ifinr",function(e,r,t){for(var n in r)if(r[n].id==e)return t.fn(this);return t.inverse(this)}),Handlebars.registerHelper("ifselected",function(e,r,t){for(var n in r)if(r[n].value==e)return t.fn(this);return t.inverse(this)}),Handlebars.registerHelper("ifin",function(e,r,t){return-1!=r.indexOf(e)?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("ifnoteq",function(e,r,t){return e!=r?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("ifjson",function(e,r,t){return"object"==typeof e[r]?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("ifnotjson",function(e,r,t){return"object"!=typeof e[r]?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("getRegions",function(e,r,t){e=e[r],r="";if(e&&e.length)return r+='<label class="label label-default">'+(e[0].title||e[0].id)+"</label> ",1<e.length&&(r+='<span class="mapsvg-data-image-counter">+'+(e.length-1)+"</span>"),new Handlebars.SafeString(r)}),Handlebars.registerHelper("getSelectedOptions",function(e,r,t){e=e[r],r="";if(e&&e.length)return r+='<label class="label label-default">'+(void 0===e[0].label?e[0].value:e[0].label)+"</label> ",1<e.length&&(r+='<span class="mapsvg-data-image-counter">+'+(e.length-1)+"</span>"),new Handlebars.SafeString(r)}),Handlebars.registerHelper("getRegionIDs",function(e,r,t){e=e[r],r="";if(e&&e.length)return r+='<label class="label label-default">'+(region.title||region.id)+"</label> ",1<e.length&&(r+='<span class="mapsvg-data-image-counter">+'+(e.length-1)+"</span>"),new Handlebars.SafeString(r)}),Handlebars.registerHelper("getThumbs",function(e,r,t){e=e[r],r="";if(e&&e.length)return r+='<img src="'+e[0].thumbnail+'" class="mapsvg-data-thumbnail"/>',1<e.length&&(r+='<span class="mapsvg-data-image-counter">+'+(e.length-1)+"</span>"),new Handlebars.SafeString(r)}),Handlebars.registerHelper("getMarkerImage",function(e,r,t){r=e[r];if(r&&r.img)return new Handlebars.SafeString('<img src="'+r.markerImageUrl+'" class="mapsvg-marker-image"/> '+(r.address&&r.address.formatted?r.address.formatted:""))}),Handlebars.registerHelper("not",function(e,r,t){return e!=r?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("if_starts",function(e,r,t){return e&&0==e.indexOf(r)?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("if_function",function(e,r){return"function"==typeof e?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("if_number",function(e,r){return jQuery.isNumeric(e)?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("if_string",function(e,r){return"string"!=typeof e||jQuery.isNumeric(e)?r.inverse(this):r.fn(this)}),Handlebars.registerHelper("toString",function(e){return null!=e?MapSVG.convertToText(e):""}),Handlebars.registerHelper("jsonToString",function(e){return null!=e?JSON.stringify(e):""}),Handlebars.registerHelper("log",function(e){return console.log(e),e}),Handlebars.registerHelper("distanceFrom",function(e){if(MapSVG.distanceSearch){e=getDistanceFromLatLonInKm(e.lat,e.lng,MapSVG.distanceSearch.latlng.lat,MapSVG.distanceSearch.latlng.lng);return"mi"===MapSVG.distanceSearch.units&&(e*=.62137),e.toFixed(2)+" "+MapSVG.distanceSearch.unitsLabel}return""}),Handlebars.registerHelper("distanceTo",function(e){if(MapSVG.distanceSearch){e=getDistanceFromLatLonInKm(e.lat,e.lng,MapSVG.distanceSearch.latlng.lat,MapSVG.distanceSearch.latlng.lng);return"mi"===MapSVG.distanceSearch.units&&(e*=.62137),e.toFixed(2)+" "+MapSVG.distanceSearch.unitsLabel}return""}),Handlebars.registerHelper("stripUnderscores",function(e){return null!=e?e.replace(/_/g," "):""}),Handlebars.registerHelper("spacesToUnderscores",function(e){return null!=e?e.replace(/ /g,"_"):""}),Handlebars.registerHelper("switch",function(e,r){this._switch_value_=e,this._switch_break_=!1;r=r.fn(this);return delete this._switch_break_,delete this._switch_value_,r}),Handlebars.registerHelper("case",function(e,r){var t=Array.prototype.slice.call(arguments),r=t.pop();return this._switch_break_||!this._open_break_&&-1===t.indexOf(this._switch_value_)?"":("true"===r.hash.break||!0===r.hash.break?this._switch_break_=!0:this._open_break_=!0,r.fn(this))}),Handlebars.registerHelper("default",function(e){if(!this._switch_break_)return e.fn(this)}),Handlebars.registerHelper("numberFormat",function(e,r){var t=r.hash.decimalLength||2,n=r.hash.thousandsSep||" ",a=r.hash.decimalSep||".",r="\\d(?=(\\d{3})+"+(0<t?"\\D":"$")+")",t=(e=parseFloat(e)).toFixed(Math.max(0,~~t));return(a?t.replace(".",a):t).replace(new RegExp(r,"g"),"$&"+n)}),Handlebars.registerHelper("shortcode",function(e){for(item in this)e=e.replace(new RegExp("{{"+item+"}}","g"),this[item]);return void 0===window.MapSVG.resizeIframe&&(window.MapSVG.resizeIframe=function(e){jQuery(e).contents();window.addEventListener("message",function(e){for(var r=document.getElementsByTagName("iframe"),t=0;t<r.length;t++)if(r[t].contentWindow===e.source){jQuery(r[t]).css({height:e.data.height});break}},!1)},window.MapSVG.resizeIframe()),new Handlebars.SafeString('<iframe width="100%" class="mapsvg-iframe-shortcode"  src="/mapsvg_sc?mapsvg_shortcode='+encodeURI(e)+'"></iframe>')}),Handlebars.registerHelper("shortcode_inline",function(e){for(item in this)e=e.replace(new RegExp("{{"+item+"}}","g"),this[item]);void 0===window.MapSVG.shortcodeCounter&&(window.MapSVG.shortcodeCounter=0);var r="mapsvg-inline-shortcode-"+ ++window.MapSVG.shortcodeCounter,t='<span class="mapsvg-inline-shortcode" id="'+r+'"></span>';return jQuery.get(ajaxurl,{action:"mapsvg_shortcode",shortcode:e},function(e){jQuery("#"+r).replaceWith(e)}),new Handlebars.SafeString(t)}),Handlebars.registerHelper("post",function(e){return this.post_id?(void 0===window.MapSVG.resizeIframe&&(window.MapSVG.resizeIframe=function(e){jQuery(e).contents();window.addEventListener("message",function(e){for(var r=document.getElementsByTagName("iframe"),t=0;t<r.length;t++)if(r[t].contentWindow===e.source){jQuery(r[t]).css({height:e.data.height});break}},!1)},window.MapSVG.resizeIframe()),new Handlebars.SafeString('<iframe width="100%" class="mapsvg-iframe-post"  src="/mapsvg_sc?mapsvg_embed_post='+encodeURI(this.post_id)+'"></iframe>')):""}),Handlebars.registerHelper("math",function(e,r,t){return{"+":(e=parseFloat(e))+(t=parseFloat(t)),"-":e-t,"*":e*t,"/":e/t,"%":e%t}[r]});
var scripts=document.getElementsByTagName("script"),myScript=scripts[scripts.length-1].src.split("/");myScript.pop();var pluginRootURL=myScript.join("/")+"/";!function(u,r,e){function i(e,t){e=e||{};var a,i=this;this.formBuilder=t,this.images=[],this.type=e.type,this.value=e.value,this.searchable=r.parseBoolean(e.searchable),this.databaseFields=this.formBuilder.mapsvg.database.getSchema().map(function(e){if("text"==e.type||"region"==e.type||"textarea"==e.type||"post"==e.type||"select"==e.type||"radio"==e.type||"checkbox"==e.type)return"post"==e.type?"Object.post.post_title":"Object."+e.name}),this.databaseFieldsFilterableShort=this.formBuilder.mapsvg.database.getSchema().filter(function(e){return"select"==e.type||"radio"==e.type||"region"==e.type}).map(function(e){return e.name}),this.regionFields=this.formBuilder.mapsvg.regionsDatabase.getSchema().map(function(e){if("status"==e.type||"text"==e.type||"textarea"==e.type||"post"==e.type||"select"==e.type||"radio"==e.type||"checkbox"==e.type)return"post"==e.type?"Region.post.post_title":"Region."+e.name}),this.db_type="varchar(255)","region"==this.type?(this.options=this.formBuilder.getRegionsList(),this.label="Regions",this.name="regions",this.db_type="text"):"text"==this.type?this.searchType=e.searchType||"fulltext":"textarea"==this.type?(this.autobr=e.autobr,this.html=e.html,this.db_type="text"):"modal"==this.type?this.showButtonText=e.showButtonText:"location"==this.type?(this.location=this.value,this.label=this.label||(void 0===e.label?"Location":e.label),this.name="location",this.db_type="text",this.languages=[{value:"sq",label:"Albanian"},{value:"ar",label:"Arabic"},{value:"eu",label:"Basque"},{value:"be",label:"Belarusian"},{value:"bg",label:"Bulgarian"},{value:"my",label:"Burmese"},{value:"bn",label:"Bengali"},{value:"ca",label:"Catalan"},{value:"zh-cn",label:"Chinese (simplified)"},{value:"zh-tw",label:"Chinese (traditional)"},{value:"hr",label:"Croatian"},{value:"cs",label:"Czech"},{value:"da",label:"Danish"},{value:"nl",label:"Dutch"},{value:"en",label:"English"},{value:"en-au",label:"English (australian)"},{value:"en-gb",label:"English (great Britain)"},{value:"fa",label:"Farsi"},{value:"fi",label:"Finnish"},{value:"fil",label:"Filipino"},{value:"fr",label:"French"},{value:"gl",label:"Galician"},{value:"de",label:"German"},{value:"el",label:"Greek"},{value:"gu",label:"Gujarati"},{value:"iw",label:"Hebrew"},{value:"hi",label:"Hindi"},{value:"hu",label:"Hungarian"},{value:"id",label:"Indonesian"},{value:"it",label:"Italian"},{value:"ja",label:"Japanese"},{value:"kn",label:"Kannada"},{value:"kk",label:"Kazakh"},{value:"ko",label:"Korean"},{value:"ky",label:"Kyrgyz"},{value:"lt",label:"Lithuanian"},{value:"lv",label:"Latvian"},{value:"mk",label:"Macedonian"},{value:"ml",label:"Malayalam"},{value:"mr",label:"Marathi"},{value:"no",label:"Norwegian"},{value:"pl",label:"Polish"},{value:"pt",label:"Portuguese"},{value:"pt-br",label:"Portuguese (brazil)"},{value:"pt-pt",label:"Portuguese (portugal)"},{value:"pa",label:"Punjabi"},{value:"ro",label:"Romanian"},{value:"ru",label:"Russian"},{value:"sr",label:"Serbian"},{value:"sk",label:"Slovak"},{value:"sl",label:"Slovenian"},{value:"es",label:"Spanish"},{value:"sv",label:"Swedish"},{value:"tl",label:"Tagalog"},{value:"ta",label:"Tamil"},{value:"te",label:"Telugu"},{value:"th",label:"Thai"},{value:"tr",label:"Turkish"},{value:"uk",label:"Ukrainian"},{value:"uz",label:"Uzbek"},{value:"vi",label:"Vietnamese"}],this.language=e.language,this.markerImages=r.markerImages,this.markersByField=e.markersByField,this.markerField=e.markerField,this.markersByFieldEnabled=r.parseBoolean(e.markersByFieldEnabled)):"search"==this.type?(this.searchFallback=r.parseBoolean(e.searchFallback),this.placeholder=e.placeholder||"Search",this.noResultsText=e.noResultsText||"No results found",this.width=i.formBuilder.filtersHide&&!i.formBuilder.modal?null:e.width||"100%"):"distance"==this.type?(this.label=this.label||(void 0===e.label?"Search radius":e.label),this.distanceControl=e.distanceControl||"select",this.distanceUnits=e.distanceUnits||"km",this.distanceUnitsLabel=e.distanceUnitsLabel||"km",this.fromLabel=e.fromLabel||"from",this.placeholder=e.placeholder,this.userLocationButton=e.userLocationButton||!1,this.type=e.type,this.addressField=e.addressField||!0,this.addressFieldPlaceholder=e.addressFieldPlaceholder||"Address",this.languages=[{value:"sq",label:"Albanian"},{value:"ar",label:"Arabic"},{value:"eu",label:"Basque"},{value:"be",label:"Belarusian"},{value:"bg",label:"Bulgarian"},{value:"my",label:"Burmese"},{value:"bn",label:"Bengali"},{value:"ca",label:"Catalan"},{value:"zh-cn",label:"Chinese (simplified)"},{value:"zh-tw",label:"Chinese (traditional)"},{value:"hr",label:"Croatian"},{value:"cs",label:"Czech"},{value:"da",label:"Danish"},{value:"nl",label:"Dutch"},{value:"en",label:"English"},{value:"en-au",label:"English (australian)"},{value:"en-gb",label:"English (great Britain)"},{value:"fa",label:"Farsi"},{value:"fi",label:"Finnish"},{value:"fil",label:"Filipino"},{value:"fr",label:"French"},{value:"gl",label:"Galician"},{value:"de",label:"German"},{value:"el",label:"Greek"},{value:"gu",label:"Gujarati"},{value:"iw",label:"Hebrew"},{value:"hi",label:"Hindi"},{value:"hu",label:"Hungarian"},{value:"id",label:"Indonesian"},{value:"it",label:"Italian"},{value:"ja",label:"Japanese"},{value:"kn",label:"Kannada"},{value:"kk",label:"Kazakh"},{value:"ko",label:"Korean"},{value:"ky",label:"Kyrgyz"},{value:"lt",label:"Lithuanian"},{value:"lv",label:"Latvian"},{value:"mk",label:"Macedonian"},{value:"ml",label:"Malayalam"},{value:"mr",label:"Marathi"},{value:"no",label:"Norwegian"},{value:"pl",label:"Polish"},{value:"pt",label:"Portuguese"},{value:"pt-br",label:"Portuguese (brazil)"},{value:"pt-pt",label:"Portuguese (portugal)"},{value:"pa",label:"Punjabi"},{value:"ro",label:"Romanian"},{value:"ru",label:"Russian"},{value:"sr",label:"Serbian"},{value:"sk",label:"Slovak"},{value:"sl",label:"Slovenian"},{value:"es",label:"Spanish"},{value:"sv",label:"Swedish"},{value:"tl",label:"Tagalog"},{value:"ta",label:"Tamil"},{value:"te",label:"Telugu"},{value:"th",label:"Thai"},{value:"tr",label:"Turkish"},{value:"uk",label:"Ukrainian"},{value:"uz",label:"Uzbek"},{value:"vi",label:"Vietnamese"}],this.countries=r.countries,this.country=e.country,this.language=e.language,this.searchByZip=e.searchByZip,this.zipLength=e.zipLength||5,this.userLocationButton=r.parseBoolean(e.userLocationButton),this.options=e.options||[{value:"10",default:!0},{value:"30",default:!1},{value:"50",default:!1},{value:"100",default:!1}],a=!1,i.value&&this.options.forEach(function(e){e.value===i.value.length&&(e.selected=!0,a=!0)}),a||this.options.forEach(function(e){e.default&&(e.selected=!0)})):"post"==this.type?(i.formBuilder.admin&&(this.post_types=this.formBuilder.admin.getPostTypes()),this.post_type=e.post_type||this.post_types[0],this.add_fields=r.parseBoolean(e.add_fields),this.db_type="int(11)",this.name="post_id",this.post_id=e.post_id,this.post=e.post):"checkbox"==this.type?(this.db_type="tinyint(1)",this.checkboxLabel=e.checkboxLabel,this.checkboxValue=e.checkboxValue):"checkboxes"==this.type?(this.db_type="text",this.checkboxLabel=e.checkboxLabel,this.options=e.options||[{label:"Option one",name:"option_one",value:1},{label:"Option two",name:"option_two",value:2}],this.optionsDict=e.optionsDict||{},this.optionsDict||this.options.forEach(function(e){i.optionsDict[e.value]=e.label})):"radio"==this.type||"select"==this.type?(this.options=e.options||[{label:"Option one",name:"option_one",value:1},{label:"Option two",name:"option_two",value:2}],"select"==this.type&&(this.multiselect=e.multiselect,this.optionsGrouped=e.optionsGrouped,this.db_type=this.multiselect?"text":"varchar(255)"),this.optionsDict=e.optionsDict||{},this.optionsDict||this.options.forEach(function(e){i.optionsDict[e.value]=e.label})):"image"==this.type?(this.button_text=e.button_text||"Browse...",this.db_type="text",this.label=e.label||"Images",this.name=e.name||"images"):"status"==this.type?(this.label=e.label||"Status",this.name="status",this.options=e.options||[{label:"Enabled",value:1,color:"",disabled:!1},{label:"Disabled",value:0,color:"",disabled:!0}]):"date"==this.type&&(i.formBuilder.admin&&(this.languages=["en-GB","ar","az","bg","bs","ca","cs","cy","da","de","el","es","et","eu","fa","fi","fo","fr","gl","he","hr","hu","hy","id","is","it","ja","ka","kh","kk","kr","lt","lv","mk","ms","nb","nl","nl-BE","no","pl","pt-BR","pt","ro","rs","rs-latin","ru","sk","sl","sq","sr","sr-latin","sv","sw","th","tr","uk","vi","zh-CN","zh-TW"]),this.db_type="varchar(50)",this.language=e.language),this.label=this.label||(void 0===e.label?"Label":e.label),this.name=this.name||e.name||"label",this.help=e.help||"",this.placeholder=e.placeholder;var s,t=this.type;"location"===(t="marker"===t&&i.formBuilder.mapsvg.isGeo()?"marker-geo":t)&&i.formBuilder.mapsvg.isGeo()&&(t="location-geo"),this.formBuilder.filtersMode?(this.parameterName=e.parameterName||"",this.parameterNameShort=this.parameterName.split(".")[1],this.placeholder=e.placeholder||"",this.templates={result:Handlebars.compile(u("#mapsvg-filters-tmpl-"+t+"-view").html())}):this.templates={result:Handlebars.compile(u("#mapsvg-data-tmpl-"+t+"-view").html())},this.views={result:u(this.templates.result(this.get()))},this.views.result.data("formElement",this),u().mselect2&&("distance"!==this.type?(s={},this.formBuilder.filtersMode&&"select"==this.type&&(s.placeholder=this.placeholder,this.multiselect||(s.allowClear=!0)),this.views.result.find("select").css({width:"100%",display:"block"}).mselect2(s).on("select2:focus",function(){u(this).mselect2("open")}),this.views.result.find(".select2-selection--multiple .select2-search__field").css("width","100%")):this.views.result.find("select").mselect2().on("select2:focus",function(){u(this).mselect2("open")})),u().colorpicker&&(this.views.result.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(e){""==u(this).find("input").val()&&u(this).find("i").css({"background-color":""})}),this.views.edit&&this.views.edit.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(e){""==u(this).find("input").val()&&u(this).find("i").css({"background-color":""})})),this.html&&(s=this.views.result.find("textarea")[0],this.editor=CodeMirror.fromTextArea(s,{mode:{name:"handlebars",base:"text/html"},matchBrackets:!0,lineNumbers:!0}),i.formBuilder.admin&&this.editor.on("change",this.setTextareaValue)),"image"==this.type&&(this.images=this.value||[],this.redrawImages()),"marker"!=this.type&&"location"!=this.type||(this.templates.marker=Handlebars.compile(u("#mapsvg-data-tmpl-marker").html()),this.location&&this.location.marker&&i.renderMarker()),this.setEventHandlers()}r.parseBoolean=function(e){switch(String(e).toLowerCase()){case"on":case"true":case"1":case"yes":case"y":return!0;case"off":case"false":case"0":case"no":case"n":return!1;default:return}},i.prototype.setTextareaValue=function(e,t){var a=e.getValue();u(e.getTextArea()).val(a).trigger("change")},i.prototype.setEventHandlers=function(){var e,a,i,s,l=this;this.formBuilder.editMode?this.views.result.on("click",function(){l.formBuilder.edit(l)}):("image"==this.type&&(e=l.views.result.find(".mapsvg-data-images"),this.formBuilder.mediaUploader.on("select",function(){return l.formBuilder.mediaUploaderFor===l&&(l.formBuilder.mediaUploader.state().get("selection").toJSON().forEach(function(e){var t,a={sizes:{}};for(t in e.sizes)a[t]=e.sizes[t].url.replace("http://","//").replace("https://","//"),a.sizes[t]={width:e.sizes[t].width,height:e.sizes[t].height};a.thumbnail||(a.thumbnail=a.full,a.sizes.thumbnail={width:e.sizes.full.width,height:e.sizes.full.height}),a.medium||(a.medium=a.full,a.sizes.medium={width:e.sizes.full.width,height:e.sizes.full.height}),a.caption=e.caption,a.description=e.description,l.images.push(a)}),void l.redrawImages())}),l.views.result.on("click",".mapsvg-upload-image",function(e){e.preventDefault(),(l.formBuilder.mediaUploaderFor=l).formBuilder.mediaUploader.open()}),l.views.result.on("click",".mapsvg-image-delete",function(e){e.preventDefault(),u(this).closest(".mapsvg-thumbnail-wrap").remove(),l.images=[],l.views.result.find("img").each(function(e,t){l.images.push(u(t).data("image"))}),l.views.result.find("input").val(JSON.stringify(l.images))}),l.sortable=new Sortable(e[0],{animation:150,onStart:function(){l.elements.containers.form_view.addClass("sorting")},onEnd:function(e){l.images=[],l.views.result.find("img").each(function(e,t){l.images.push(u(t).data("image"))}),l.views.result.find("input").val(JSON.stringify(l.images))}})),"post"==this.type&&l.views.result.find(".mapsvg-find-post").mselect2({placeholder:"Search post by title",allowClear:!0,ajax:{url:ajaxurl+"?action=mapsvg_search_posts&post_type="+l.post_type,dataType:"json",delay:250,data:function(e){return{query:e.term,page:e.page}},processResults:function(e,t){return t.page=t.page||1,{results:e,pagination:{more:!1}}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:1,templateResult:function(e){return e.loading?e.text:"<div class='select2-result-repository clearfix'>"+e.post_title+"</div>"},templateSelection:function(e){return e.post_title||e.text}}).on("select2:select",function(e){l.post=e.params.data,l.views.result.find(".mapsvg-post-id").text(l.post.ID),l.views.result.find(".mapsvg-post-url").text(l.post.url).attr("href",l.post.url),l.views.result.find('input[name="post_id"]').val(l.post.ID)}).on("change",function(e){""===e.target.value&&(l.views.result.find(".mapsvg-post-id").text(""),l.views.result.find(".mapsvg-post-url").text(""),l.views.result.find('input[name="post_id"]').val(""))}),"location"===this.type&&(l.formBuilder.mapsvg.isGeo()&&(i=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("formatted_address"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:ajaxurl+"?action=mapsvg_geocoding&address=%QUERY%&language="+this.language,wildcard:"%QUERY%",transform:function(e){return e.error_message&&alert(e.error_message),e.results},rateLimitWait:600}}),(s=this.views.result.find(".typeahead")).typeahead({minLength:3},{name:"mapsvg-addresses",display:"formatted_address",source:i}),s.on("typeahead:select",function(e,t){l.location&&l.location.marker&&l.deleteMarker();var a={};a.formatted=t.formatted_address,t.address_components.forEach(function(e){var t=e.types[0];a[t]=e.long_name,e.short_name!=e.long_name&&(a[t+"_short"]=e.short_name)});var i={address:a,lat:t.geometry.location.lat,lng:t.geometry.location.lng,img:l.formBuilder.mapsvg.getMarkerImage(l.formBuilder.getData())};l.location=new r.Location(i,l.formBuilder.mapsvg),l.formBuilder.location=this.location;t=new r.Marker({location:l.location,mapsvg:l.formBuilder.mapsvg});l.location.marker=t,l.formBuilder.mapsvg.markerAdd(l.location.marker),l.formBuilder.mapsvg.setEditingMarker(t),l.formBuilder.marker=t.getOptions(),l.renderMarker();i=l.formBuilder.view.find('select[name="regions"]');-1!==l.formBuilder.mapsvg.getData().options.source.indexOf("/geo-calibrated/usa.svg")?0!==i.length&&l.location.address.state_short&&(i.val(["US-"+l.location.address.state_short]),i.trigger("change")):-1!==l.formBuilder.mapsvg.getData().options.source.indexOf("/geo-calibrated/world.svg")?0!==i.length&&l.location.address.country_short&&(i.val([l.location.address.country_short]),i.trigger("change")):0===i.length||!l.location.address.administrative_area_level_1||0<(t=l.formBuilder.mapsvg.getData().regions.filter(function(e){return e.title===l.location.address.administrative_area_level_1||e.title===l.location.address.administrative_area_level_2||e.id===l.location.address.country_short+"-"+l.location.address.administrative_area_level_1_short})).length&&(t=t[0],i.val([t.id]),i.trigger("change")),s.typeahead("val","")})),l.views.result.on("click",".mapsvg-marker-image-btn-trigger",function(e){u(this).toggleClass("active"),l.toggleMarkerSelector.call(l,u(this),e)}),l.views.result.on("click",".mapsvg-marker-delete",function(e){e.preventDefault(),l.deleteMarker()})),"select"!==this.type&&"radio"!==this.type||(a=l.formBuilder.mapsvg.database.getSchemaField("location"))&&a.markersByFieldEnabled&&a.markerField&&this.name==a.markerField&&0<Object.values(a.markersByField).length&&l.views.result.on("change","select",function(e){var t=a.markersByField[u(this).val()];t&&l.formBuilder.marker&&(l.formBuilder.mapsvg.getMarker(l.formBuilder.marker.id).setImage(t),l.views.result.closest(".mapsvg-form-builder").find(".mapsvg-marker-image-btn img").attr("src",t))}),"distance"===this.type&&(l.formBuilder.mapsvg.isGeo()&&(i=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("formatted_address"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:ajaxurl+"?action=mapsvg_geocoding&address="+(!0===this.searchByZip?"zip%20":"")+"%QUERY%&language="+this.language+(this.country?"&country="+this.country:""),wildcard:"%QUERY%",transform:function(e){return e.error_message&&alert(e.error_message),e.results},rateLimitWait:600}}),s=this.views.result.find(".typeahead"),this.searchByZip?(this.views.result.find(".mapsvg-distance-fields").addClass("search-by-zip"),s.on("change keyup",function(){u(this).val().length===parseInt(l.zipLength)&&i.search(u(this).val(),null,function(e){e&&e[0]&&(e=e[0].geometry.location,l.formBuilder.view.find('[name="distanceLatLng"]').val(e.lat+","+e.lng).trigger("change"))})})):(s.typeahead({minLength:3},{name:"mapsvg-addresses",display:"formatted_address",source:i,limit:5}),this.views.result.find(".mapsvg-distance-fields").removeClass("search-by-zip")),l.userLocationButton&&this.views.result.find(".user-location-button").on("click",function(){l.formBuilder.mapsvg.showUserLocation(function(t){i.search(t.lat+","+t.lng,null,function(e){e&&e[0]?s.val(e[0].formatted_address):s.val(t.lat+","+t.lng)}),l.formBuilder.view.find('[name="distanceLatLng"]').val(t.lat+","+t.lng).trigger("change")})}),s.on("change keyup",function(){""===u(this).val()&&l.formBuilder.view.find('[name="distanceLatLng"]').val("").trigger("change")}),s.on("typeahead:select",function(e,t){t.formatted_address;t=t.geometry.location;l.formBuilder.view.find('[name="distanceLatLng"]').val(t.lat+","+t.lng).trigger("change"),s.blur()})),l.views.result.on("click",".mapsvg-marker-image-btn-trigger",function(e){u(this).toggleClass("active"),l.toggleMarkerSelector.call(l,u(this),e)}),l.views.result.on("click",".mapsvg-marker-delete",function(e){e.preventDefault(),l.deleteMarker()})))},i.prototype.toggleMarkerSelector=function(e,t){t.preventDefault();var a,i=this;i.markerSelector&&i.markerSelector.is(":visible")?i.markerSelector.hide():i.markerSelector&&i.markerSelector.not(":visible")?i.markerSelector.show():(i.markerImageButton=e.find("img"),a=i.markerImageButton.attr("src"),e=r.markerImages.map(function(e){return'<button class="btn btn-default mapsvg-marker-image-btn mapsvg-marker-image-btn-choose '+(a==e.url?"active":"")+'"><img src="'+e.url+'" /></button>'}),i.markerSelector||(i.markerSelector=i.views.result.find(".mapsvg-marker-image-selector")),i.markerSelector&&i.markerSelector.empty(),i.formBuilder.markerSelector=i.markerSelector,i.formBuilder.marker?i.markerSelector.data("marker",i.formBuilder.marker):i.markerSelector.data("marker",null),i.markerSelector.html(e.join("")),i.markerSelector.append('<div class=\'mapsvg-marker-selector-help\'>Upload marker images on: <em><i class="fa fa-database"></i> Database > <i class="fa fa-pencil-square-o"></i> Edit fields > Location > Markers > Upload</em></div>'),i.markerSelector.on("click",".mapsvg-marker-image-btn-choose",function(e){e.preventDefault();e=u(this).find("img").attr("src");i.formBuilder.marker&&i.formBuilder.mapsvg.getMarker(i.formBuilder.marker.id).setImage(e),i.markerSelector.hide(),i.views.result.find(".mapsvg-marker-image-btn-trigger").toggleClass("active",!1),i.markerImageButton.attr("src",e)}))},i.prototype.toggleMarkerSelectorInLocationEditor=function(i,e){e.preventDefault();var t,a,s=this;i.data("markerSelector")&&i.data("markerSelector").is(":visible")?i.data("markerSelector").hide():i.data("markerSelector")&&i.data("markerSelector").not(":visible")?i.data("markerSelector").show():(t=u(this).closest("td").find(".mapsvg-marker-image-btn-trigger").attr("src"),a=r.markerImages.map(function(e){return'<button class="btn btn-default mapsvg-marker-image-btn mapsvg-marker-image-btn-choose '+(t==e.url?"active":"")+'"><img src="'+e.url+'" /></button>'}),i.data("markerSelector")?i.data("markerSelector").empty():(e=u('<div class="mapsvg-marker-image-selector"></div>'),i.closest("td").append(e),i.data("markerSelector",e)),i.data("markerSelector").html(a.join("")),i.data("markerSelector").on("click",".mapsvg-marker-image-btn-choose",function(e){e.preventDefault();var t=u(this).find("img").attr("src");i.data("markerSelector").hide();var a=u(this).closest("td"),e=u(this).closest("tr").data("option-id"),a=a.find(".mapsvg-marker-image-btn-trigger");a.toggleClass("active",!1),a.find("img").attr("src",t),s.setMarkerByField(e,t)}))},i.prototype.setMarkerByField=function(e,t){this.markersByField=this.markersByField||{},this.markersByField[e]=t},i.prototype.deleteMarker=function(){this.formBuilder.backupData=this.formBuilder.backupData||{},this.formBuilder.backupData.location=this.location,this.formBuilder.backupData.marker=this.marker,this.location=null,this.marker=null,this.formBuilder.marker&&(this.formBuilder.mapsvg.getMarker(this.formBuilder.marker.id).delete(),this.formBuilder.mapsvg.editingMarker=null),this.views.result.find(".mapsvg-new-marker").hide(),this.views.result.find(".mapsvg-marker-id").attr("disabled","disabled")},i.prototype.renderMarker=function(e){var t=this;if(!(this.location||e&&e.location))return!1;e&&e.location&&(this.location=e.location),t.views.result.find(".mapsvg-new-marker").show().html(this.templates.marker(this.location)),this.location.marker.onChange=function(){t.renderMarker()}},i.prototype.redrawImages=function(){var a=this.views.result.find(".mapsvg-data-images");a.empty(),this.images&&this.images.forEach(function(e){var t=u('<img class="mapsvg-data-thumbnail" />').attr("src",e.thumbnail).data("image",e),e=u('<div class="mapsvg-thumbnail-wrap"></div>').data("image",e);e.append(t),e.append('<i class="fa fa-times  mapsvg-image-delete"></i>'),a.append(e)}),this.views.result.find("input").val(JSON.stringify(this.images))},i.prototype.setEditorEventHandlers=function(){var s=this;this.views.edit.on("click","button.mapsvg-remove",function(){s.views.result.empty().remove(),s.views.edit.empty().remove(),s.formBuilder.delete(s)}).on("keyup change paste",".mapsvg-edit-status-row input",function(){s.mayBeAddStatusRow()}).on("keyup change paste",".mapsvg-edit-distance-row input",function(){s.mayBeAddDistanceRow()});var a=u("#marker-file-uploader").closest(".form-group").find(".mapsvg-marker-image-selector"),i=u("#marker-file-uploader").closest(".btn-file");this.views.edit.on("change","#marker-file-uploader",function(){i=u(this).closest(".btn-file")._button("loading");for(var e=0;e<this.files.length;e++){var t=new FormData;t.append("file",this.files[0]),t.append("action","mapsvg_marker_upload"),t.append("_wpnonce",r.nonce),u.ajax({url:ajaxurl,type:"POST",data:t,processData:!1,contentType:!1}).done(function(e){var t;(e=JSON.parse(e)).error?alert(e.error):(t='<button class="btn btn-default mapsvg-marker-image-btn mapsvg-marker-image-btn-choose"><img src="'+e.url+'" /></button>',u(t).appendTo(a),r.markerImages.push(e))}).always(function(){i._button("reset")})}}),this.views.edit.on("change",'select[name="markerField"]',function(){var e=u(this).val();s.fillMarkersByFieldOptions(e)}),s.views.edit.on("click",".mapsvg-marker-image-btn-trigger",function(e){u(this).toggleClass("active"),s.toggleMarkerSelectorInLocationEditor.call(s,u(this),e)}),this.views.edit.on("click",".mapsvg-filter-insert-options",function(){var e=s.parameterName.split(".")[0],t=s.parameterName.split(".")[1],e="Object"==e?s.formBuilder.mapsvg.database.getSchemaField(t):"id"==t?{options:s.formBuilder.mapsvg.getData().regions.map(function(e){return{label:e.id,value:e.id}})}:"region_title"==t?{options:s.formBuilder.mapsvg.getData().regions.map(function(e){return{label:e.title,value:e.title}})}:s.formBuilder.mapsvg.regionsDatabase.getSchemaField(t);e&&e.options&&(e="regions"==t?(e.options[0].title&&e.options[0].title.length&&e.options.sort(function(e,t){return e.title<t.title?-1:e.title>t.title?1:0}),e.options.map(function(e){return(e.title||e.id)+":"+e.id})):e.options.map(function(e){return e.label+":"+e.value}),u(this).closest(".form-group").find("textarea").val(e.join("\n")).trigger("change"))}),this.views.edit.on("keyup change paste","input, textarea, select",function(){var e=u(this).attr("name"),t=u(this).data("array");if("status"===s.type&&t){var a=u(this).data("param"),i=u(this).closest("tr").index();s.options[i]=s.options[i]||{label:"",value:"",color:"",disabled:!1},s.options[i][a]=u(this).is(":checkbox")?u(this).prop("checked"):u(this).val(),s.redraw()}else if("distance"===s.type&&t){var a=u(this).data("param"),i=u(this).closest("tr").index();s.options[i]||(s.options[i]={value:"",default:!1}),"default"===a?(s.options.forEach(function(e,t){e.default=!1}),s.options[i].default=u(this).prop("checked")):s.options[i].value=u(this).val(),s.redraw()}else{if("label"==e||"name"==e)return!1;a="checkbox"==u(this).attr("type")?u(this).prop("checked"):u(this).val(),"radio"==u(this).attr("type")&&(i=u(this).attr("name"),a=u('input[name="'+i+'"]:checked').val()),s.update(e,a)}}),this.views.edit.on("keyup change paste",'input[name="label"]',function(){var e;s.nameChanged||(s.label=u(this).val(),"region"!=s.type&&"location"!=s.type&&(e=(e=u(this).val()).toLowerCase().replace(/ /g,"_").replace(/\W/g,""),s.views.edit.find('input[name="name"]').val(e),s.name=e),s.views.result.find("label").first().html(s.label),s.formBuilder.filtersMode||s.views.result.find("label").first().append('<div class="field-name">'+s.name+"</div>"))}),this.views.edit.on("keyup change paste",'input[name="name"]',function(){this.value&&(this.value.match(/[^a-zA-Z0-9_]/g)&&(this.value=this.value.replace(/[^a-zA-Z0-9_]/g,""),u(this).trigger("change")),this.value[0].match(/[^a-zA-Z_]/g)&&(this.value=this.value[0].replace(/[^a-zA-Z_]/g,"")+this.value.slice(1),u(this).trigger("change"))),"region"!=s.type&&(s.name=this.value),s.views.result.find("label").html(s.label+'<div class="field-name">'+s.name+"</div>"),s.nameChanged=!0})},i.prototype.fillMarkersByFieldOptions=function(e){var a,i=this,e=i.formBuilder.mapsvg.database.getSchemaField(e);e&&(a=i.formBuilder.mapsvg.getData().options.defaultMarkerImage,e=e.options.map(function(e){var t=i.markersByField&&i.markersByField[e.value]?i.markersByField[e.value]:a;return'<tr data-option-id="'+e.value+'"><td>'+e.label+'</td><td><button class="btn btn-default mapsvg-marker-image-btn-trigger mapsvg-marker-image-btn"><img src="'+t+'" class="new-marker-img" style="margin-right: 4px;"/><span class="caret"></span></button></td></tr>'}),u("#markers-by-field").empty().append(e))},i.prototype.getEditor=function(){return this.formBuilder.filtersMode?this.templates.edit=this.templates.edit||Handlebars.compile(u("#mapsvg-filters-tmpl-"+this.type+"-control").html()):this.templates.edit=this.templates.edit||Handlebars.compile(u("#mapsvg-data-tmpl-"+this.type+"-control").html()),this.views.edit=u(this.templates.edit(this.get())),this.views.edit},i.prototype.destroyEditor=function(){this.views.edit.empty().remove()},i.prototype.initEditor=function(){var i=this;this.views.edit.find("input").first().select(),u().mselect2&&("distance"!==this.type?this.views.edit.find("select").css({width:"100%",display:"block"}):this.views.edit.find("select")).mselect2(),"status"==this.type&&(i.views.edit.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(e){var t=u(this).find("input"),a=u(this).closest("tr").index();""==t.val()&&u(this).find("i").css({"background-color":""}),i.options[a]=i.options[a]||{label:"",value:"",color:"",disabled:!1},i.options[a].color=t.val()}),i.mayBeAddStatusRow()),"distance"===this.type&&i.mayBeAddDistanceRow(),"location"===this.type&&i.fillMarkersByFieldOptions(i.markerField),this.views.edit.find(".mapsvg-onoff").bootstrapToggle({onstyle:"default",offstyle:"default"}),this.setEditorEventHandlers()},i.prototype.mayBeAddStatusRow=function(){var i=this;this.templates.editStatusRow=this.templates.editStatusRow||u(u("#mapsvg-edit-status-row").html());var e=i.views.edit.find(".mapsvg-edit-status-label:last-child");e&&e.last()&&e.last().val()&&e.last().val().trim().length&&((t=this.templates.editStatusRow.clone()).insertAfter(i.views.edit.find(".mapsvg-edit-status-row:last-child")),t.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(e){var t=u(this).find("input"),a=u(this).closest("tr").index();""==t.val()&&u(this).find("i").css({"background-color":""}),i.options[a]=i.options[a]||{label:"",value:"",color:"",disabled:!1},i.options[a].color=t.val()}));var e=i.views.edit.find(".mapsvg-edit-status-row"),t=e.eq(e.length-2),e=e.eq(e.length-1);t.length&&e.length&&!(t.find("input:eq(0)").val().trim()||t.find("input:eq(1)").val().trim()||t.find("input:eq(2)").val().trim())&&!(e.find("input:eq(0)").val().trim()||e.find("input:eq(1)").val().trim()||e.find("input:eq(2)").val().trim())&&e.remove()},i.prototype.mayBeAddDistanceRow=function(){this.templates.editDistanceRow=this.templates.editDistanceRow||u(u("#mapsvg-edit-distance-row").html());var e=this.views.edit.find(".mapsvg-edit-distance-row:last-child input");e&&e.last()&&e.last().val()&&e.last().val().trim().length&&this.templates.editDistanceRow.clone().insertAfter(this.views.edit.find(".mapsvg-edit-distance-row:last-child"));var t=this.views.edit.find(".mapsvg-edit-distance-row"),e=t.eq(t.length-2),t=t.eq(t.length-1);e.length&&t.length&&!e.find("input:eq(0)").val().trim()&&!t.find("input:eq(0)").val().trim()&&t.remove()},i.prototype.getSchema=function(){var e,t=this,a={type:this.type,db_type:this.db_type,label:this.label,name:this.name,value:this.value,searchable:r.parseBoolean(this.searchable)};return"select"==this.type&&(a.multiselect=r.parseBoolean(this.multiselect),a.multiselect&&(a.db_type="text"),a.optionsGrouped=this.optionsGrouped),this.options&&(e=u.extend(!0,{},{options:this.options}),a.options=e.options,a.optionsDict={},"region"==a.type?a.options.forEach(function(e){a.optionsDict[e.id]=e.title||e.id}):"status"==t.type?a.options.forEach(function(e,t){""===a.options[t].value?a.options.splice(t,1):(a.options[t].disabled=r.parseBoolean(a.options[t].disabled),a.optionsDict[e.value]=e)}):"distance"==t.type?a.options.forEach(function(e,t){""===a.options[t].value?a.options.splice(t,1):a.options[t].default=r.parseBoolean(a.options[t].default)}):a.options.forEach(function(e){a.optionsDict[e.value]="status"==t.type?e:e.label})),this.help&&(a.help=this.help),this.button_text&&(a.button_text=this.button_text),"post"==this.type&&(a.post_type=this.post_type,a.add_fields=this.add_fields),"date"==this.type&&(a.language=this.language),"location"==this.type&&(a.language=this.language,a.markersByField=this.markersByField,a.markerField=this.markerField,a.markersByFieldEnabled=r.parseBoolean(this.markersByFieldEnabled)),"textarea"==this.type&&(a.autobr=this.autobr,a.html=this.html),"text"==this.type&&(a.searchType=this.searchType),"modal"==this.type&&(a.showButtonText=this.showButtonText),"distance"==this.type&&(a.distanceControl=this.distanceControl,a.distanceUnits=this.distanceUnits,a.distanceUnitsLabel=this.distanceUnitsLabel,a.fromLabel=this.fromLabel,a.addressField=this.addressField,a.addressFieldPlaceholder=this.addressFieldPlaceholder,a.userLocationButton=this.userLocationButton,a.placeholder=this.placeholder,a.language=this.language,a.country=this.country,a.searchByZip=this.searchByZip,a.zipLength=this.zipLength,a.userLocationButton=r.parseBoolean(this.userLocationButton),"none"===a.distanceControl&&(a.distanceDefault=a.options.filter(function(e){return e.default})[0].value)),"search"==this.type&&(a.searchFallback=r.parseBoolean(this.searchFallback),a.placeholder=this.placeholder,a.noResultsText=this.noResultsText,a.width=this.width),this.checkboxLabel&&(a.checkboxLabel=this.checkboxLabel),this.checkboxValue&&(a.checkboxValue=this.checkboxValue),this.formBuilder.filtersMode&&(a.parameterName=this.parameterName,a.parameterNameShort=this.parameterName.split(".")[1],a.placeholder=this.placeholder),a.visible=void 0===this.visible||this.visible,a},i.prototype.get=function(){var e,t,a=this.getSchema();return a._name=a.name,this.formBuilder.namespace&&(a.name=this.name.split("[")[0],e=(e=this.name.split("[")[1]||"")&&"["+e,a.name=this.formBuilder.namespace+"["+a.name+"]"+e),"post"==this.type&&(this.formBuilder.admin&&(a.post_types=this.formBuilder.admin.getPostTypes()),a.post_type=this.post_type,a.post=this.post,a.add_fields=this.add_fields||0),"date"==this.type&&(this.formBuilder.admin&&(a.languages=this.languages),a.language=this.language),"distance"==this.type&&(this.formBuilder.admin&&(a.languages=this.languages,a.countries=this.countries),a.language=this.language,a.country=this.country,a.searchByZip=this.searchByZip,a.zipLength=this.zipLength,a.userLocationButton=r.parseBoolean(this.userLocationButton)),"location"==this.type&&(this.formBuilder.admin&&(a.languages=this.languages,a.markerImages=r.markerImages,a.markersByField=this.markersByField,a.markerField=this.markerField,a.markersByFieldEnabled=r.parseBoolean(this.markersByFieldEnabled),t=this,a.markerImages.forEach(function(e){e.url===t.formBuilder.mapsvg.getData().options.defaultMarkerImage?e.default=!0:e.default=!1})),a.language=this.language,this.location&&(a.location=this.location,this.location.marker&&(a.location.img=(0===this.location.marker.src.indexOf(r.urls.uploads)?"uploads/":"")+this.location.marker.src.split("/").pop()))),"textarea"==this.type&&(a.html=this.html),a.databaseFields=this.databaseFields,a.databaseFieldsFilterableShort=this.databaseFieldsFilterableShort,a.regionFields=this.regionFields,a.placeholder=this.placeholder,a},i.prototype.update=function(e,t){var a,i=this;"options"==e?(a=[],t=t.split("\n").forEach(function(e){e=e.trim().split(":"),"checkbox"==i.type&&3==e.length?a.push({label:e[0],name:e[1],value:e[2]}):"radio"!=i.type&&"select"!=i.type&&"checkboxes"!=i.type||2!=e.length||a.push({label:e[0],value:e[1]})}),this.options=a):this[e]=t,"parameterName"==e&&this.views.edit.find(".mapsvg-filter-param-name").text(t),this.redraw()},i.prototype.redraw=function(){var e=u(this.templates.result(this.get()));this.views.result.html(e.html()),u().mselect2&&("distance"!==this.type?this.views.result.find("select").css({width:"100%",display:"block"}):this.views.result.find("select")).mselect2().on("select2:focus",function(){u(this).mselect2("open")}),u().colorpicker&&this.views.edit&&this.views.edit.find(".cpicker").colorpicker().on("changeColor.colorpicker",function(e){""==u(this).find("input").val()&&u(this).find("i").css({"background-color":""})})};function t(e){var t=this;this.container=e.container,this.namespace=e.namespace,this.mediaUploader=e.mediaUploader,this.schema=e.schema||[],this.editMode=null!=e.editMode&&e.editMode,this.filtersMode=null!=e.filtersMode&&e.filtersMode,this.filtersHide=null!=e.filtersHide&&e.filtersHide,this.modal=null!=e.modal&&e.modal,this.admin=e.admin,this.mapsvg=e.mapsvg,this.data=e.data||{},this.eventHandlers=e.events,this.template="form-builder",this.closeOnSave=!0===e.closeOnSave,this.newRecord=!0===e.newRecord,this.types=e.types||["text","textarea","checkbox","radio","select","image","region","location","post","date"],this.templates={},this.elements={},this.view=u("<div />").addClass("mapsvg-form-builder"),this.editMode&&this.view.addClass("full-flex"),this.formControls=[],r.templatesLoaded[this.template]?this.init():u.get(r.urls.templates+t.template+".html?"+Math.random(),function(e){u(e).appendTo("body"),r.templatesLoaded[t.template]=!0,Handlebars.registerPartial("dataMarkerPartial",u("#mapsvg-data-tmpl-marker").html()),t.editMode&&Handlebars.registerPartial("markerByFieldPartial",u("#mapsvg-markers-by-field-tmpl-partial").html()),t.init()})}t.prototype.init=function(){var e,t=this;r.formBuilder=this,t.editMode?(e=Handlebars.compile(u("#mapsvg-form-editor-tmpl-ui").html()),t.view.append(e({types:this.types})),t.view.addClass("edit")):(e=u('<div class="mapsvg-data-form-view"></div>'),t.view.append(e),this.filtersMode||e.addClass("form-horizontal")),t.elements={buttons:{text:t.view.find("#mapsvg-data-btn-text"),textarea:t.view.find("#mapsvg-data-btn-textarea"),checkbox:t.view.find("#mapsvg-data-btn-checkbox"),radio:t.view.find("#mapsvg-data-btn-radio"),select:t.view.find("#mapsvg-data-btn-select"),image:t.view.find("#mapsvg-data-btn-image"),region:t.view.find("#mapsvg-data-btn-region"),marker:t.view.find("#mapsvg-data-btn-marker"),saveSchema:t.view.find("#mapsvg-data-btn-save-schema")},containers:{buttons_add:t.view.find("#mapsvg-data-buttons-add"),form_view:t.view.find(".mapsvg-data-form-view"),form_edit:t.view.find("#mapsvg-data-form-edit")}},t.redraw()},t.prototype.viewDidLoad=function(){_this.formControls.forEach(function(e){var t;e.html&&(t=e.views.result.find("textarea")[0],e.htmlEditor=CodeMirror.fromTextArea(t,{mode:{name:"handlebars",base:"text/html"},matchBrackets:!0,lineNumbers:!0}))})},t.prototype.setEventHandlers=function(){var m=this;u(e).off("keydown.form.mapsvg").on("keydown.form.mapsvg",function(e){r.formBuilder&&((e.metaKey||e.ctrlKey)&&13==e.keyCode?r.formBuilder.save():27==e.keyCode&&r.formBuilder.close())}),this.editMode?(this.view.on("click",".mapsvg-marker-image-selector button",function(e){e.preventDefault();e=u(this).find("img").attr("src");u(this).parent().find("button").removeClass("active"),u(this).addClass("active"),m.mapsvg.setDefaultMarkerImage(e)}),this.view.on("click","#mapsvg-data-buttons-add button",function(e){e.preventDefault();e=u(this).data("create");m.add({type:e})}),this.view.on("click","#mapsvg-data-btn-save-schema",function(e){e.preventDefault();var e=m.getSchema(),s={};m.formControls.forEach(function(e){s[e.name]=(s[e.name]||0)+1}),m.elements.containers.form_view.find(".form-group").removeClass("has-error");var l,r,o=[],n=["id","lat","lon","lng","location","location_lat","location_lon","location_lng","location_address","location_img","marker","marker_id","regions","region_id","post_id","post","post_title","post_url","keywords","status"],d={regions:"region",status:"status",post_id:"post",marker:"marker",location:"location"};m.formControls.forEach(function(e,t){var a,i=!1;m.filtersMode||(1<s[e.name]?l||(l="Field names should be unique",o.push(l),i=!0):0===e.name.length?r||(r="Field name can't be empty",o.push(r),i=!0):-1!=n.indexOf(e.name)&&(!d[e.name]||d[e.name]&&d[e.name]!=e.type)&&(a='Field name "'+e.name+'" is reserved, please set another name',o.push(a),i=!0)),!e.options||"region"==e.type||"marker"==e.type||(a=_.pluck(e.options,"value")).length!=_.uniq(a).length&&(o.push('Check "Options" list - values should not repeat'),i=!0),i&&e.views.result.addClass("has-error")}),0==o.length?m.eventHandlers.saveSchema&&m.eventHandlers.saveSchema(e):u.growl.error({title:"Errors",message:o.join("<br />")})}),setTimeout(function(){var e=m.elements.containers.form_view[0];m.sortable=new Sortable(e,{animation:150,onStart:function(){m.elements.containers.form_view.addClass("sorting")},onEnd:function(){setTimeout(function(){m.elements.containers.form_view.removeClass("sorting"),m.formControls=[],u(e).find(".form-group").each(function(e,t){m.formControls.push(u(t).data("formElement"))})},500)}})},1e3)):(m.view.on("click","button.btn-save",function(e){e.preventDefault(),m.save()}),m.view.on("click","button.btn-close",function(e){e.preventDefault(),m.close()})),new r.ResizeSensor(this.view[0],function(){m.scrollApi&&m.scrollApi.reinitialise()})},t.prototype.save=function(){var e=this;e.marker&&(e.marker.onChange=null,e.mapsvg.unsetEditingMarker());var t=e.getData();e.saved=!0,e.eventHandlers.save&&e.eventHandlers.save.call(e,t)},t.prototype.getData=function(){var i=this,e=i.toJSON(!0);return i.formControls.forEach(function(t){var a;"image"==t.type&&(e[t.name]=[],t.images&&t.images.length&&null!=t.images[0]&&(a=[],t.views.result.find(".mapsvg-thumbnail-wrap").each(function(e,t){t=u(t).data("image");a.push(t)}),t.images=a,e[t.name]=e[t.name].concat(t.images))),"location"==t.type&&(t.location?e[t.name]=t.location:e[t.name]=""),"post"==t.type&&(e.post=t.post),"region"==t.type&&(e.regions&&"object"==typeof e.regions&&e.regions.length?e.regions=e.regions.map(function(e){return{id:e,title:i.mapsvg.getRegion(e).title}}):e.regions=""),"select"==t.type&&t.multiselect&&e[t.name]&&e[t.name].length&&(e[t.name]=e[t.name].map(function(e){return{value:e,label:t.optionsDict[e]}}))}),null!=i.data.id&&(e.id=i.data.id),delete e.marker_id,e},t.prototype.getDataJSON=function(){var t=this,i=t.toJSON(!0);return t.formControls.forEach(function(e){var a;"image"==e.type&&(i[e.name]=[],e.images&&e.images.length&&null!=e.images[0]&&(a=[],t.view.find(".mapsvg-thumbnail-wrap").each(function(e,t){t=u(t).data("image");a.push(t)}),e.images=a,i[e.name]=i[e.name].concat(e.images))),"location"==e.type&&(i[e.name]=e.location)}),null!=t.data.id&&(i.id=t.data.id),i},t.prototype.redraw=function(e){var t,a,i=this;delete i.marker,i.container.empty(),i.elements.containers.form_view.empty(),i.formControls=[],i.data&&i.data.id&&i.add({type:"id",label:"ID",name:"id",value:i.data.id}),i.data&&i.data._title&&i.add({type:"title",label:"Title",name:"title",value:i.data._title}),i.schema&&i.schema.length&&i.schema.forEach(function(e){var t;i.admin&&i.admin.isMetabox&&"post"==e.type||(i.filtersMode?"distance"==e.type?e.value=i.data.distance||(void 0!==e.value?e.value:null):e.value=i.data[e.parameterNameShort]:e.value=i.data?i.data[e.name]:void 0!==e.value?e.value:null,"location"!=e.type||i.editMode?"post"==e.type&&(e.post=i.data.post):(e.value&&e.value.marker&&e.value.marker.id&&(i.marker=e.value.marker.getOptions(),i.mapsvg.setEditingMarker(e.value.marker)),i.admin&&i.admin.setMode&&i.admin.setMode("editMarkers"),i.admin&&i.admin.enableMarkersMode(!0),i.mapsvg.setMarkerEditHandler(function(){i.marker=this.getOptions(),i.mapsvg.setEditingMarker(this);var e=i.getData(),e=i.mapsvg.getMarkerImage(e);this.setImage(e),i.locationFormElement&&i.locationFormElement.renderMarker(i.mapsvg.getMarker(i.marker.id))})),(!i.filtersMode||!i.filtersHide||i.filtersHide&&i.modal&&"search"!==e.type||!i.modal&&"search"===e.type)&&(t=i.add(e)),"location"==e.type&&(i.locationFormElement=t))}),i.editMode||(0!=this.schema.length||i.filtersMode?i.admin&&!i.admin.isMetabox&&i.add({type:"save"}):i.add({type:"empty"})),i.filtersMode&&i.filtersHide&&!i.modal&&(this.showFiltersButton=i.add({type:"modal",buttonText:i.mapsvg.getData().options.filters.showButtonText})),i.editMode||i.filtersMode?i.container.html(this.view):(t=u('<div class="nano"></div>'),a=u('<div class="nano-content"></div>'),t.append(a),a.html(this.view),i.container.html(t),t.jScrollPane(),i.scrollApi=t.data("jsp")),i.eventHandlers.load&&i.eventHandlers.load(i),this.editMode||i.filtersMode||this.view.find("input:visible,textarea:visible").not(".tt-hint").first().focus(),this.container.find(".CodeMirror").each(function(e,t){t&&t.CodeMirror.refresh()}),i.setEventHandlers(),i.eventHandlers.init&&i.eventHandlers.init(i.data)},t.prototype.delete=function(a){var i=this;i.formControls.forEach(function(e,t){e===a&&(i.formControls.splice(t,1),i.structureChanged=!0)})},t.prototype.add=function(t){if(-1!=["region","marker","post","status","distance","location","search"].indexOf(t.type)){var a=!1;if(this.formControls.forEach(function(e){e.type==t.type&&(a=!0)}),a)return void u.growl.error({title:"Error",message:'You can add only 1 "'+r.ucfirst(t.type)+'" field'})}"date"==t.type&&(r.datepicker=r.datepicker||{});var e=new i(t,this);return this.formControls.push(e),this.elements.containers.form_view.append(e.views.result),this.editMode&&this.edit(e),e},t.prototype.edit=function(e){var t=this;t.currentlyEditing&&t.currentlyEditing.destroyEditor(),t.elements.containers.form_edit.append(e.getEditor()),e.initEditor(),t.currentlyEditing=e,t.elements.containers.form_view.find(".form-group.active").removeClass("active"),e.views.result.addClass("active")},t.prototype.get=function(){return this.formControls.map(function(e){return e.get()})},t.prototype.getSchema=function(){return this.formControls.map(function(e){return e.getSchema()})},t.prototype.close=function(){var e,t=this;t.saved||(null==t.data.id&&t.marker&&((e=t.mapsvg.getMarker(t.marker.id)).onChange=null,e.delete(),delete t.marker),this.backupData&&this.backupData.location&&(this.location=this.backupData.location,t.mapsvg.markerAdd(this.location.marker),t.mapsvg.setEditingMarker(this.location.marker)),!t.marker||(e=t.mapsvg.getEditingMarker())&&(e.setImage(t.marker.src),e.setXy([t.marker.x,t.marker.y]),t.mapsvg.unsetEditingMarker())),t.markerSelector&&t.markerSelector.popover("destroy"),!u().mselect2||(a=t.view.find(".mapsvg-select2")).length&&a.mselect2("destroy");var a=t.view.find(".CodeMirror");a.length&&a.empty().remove(),t.admin&&t.admin.enableMarkersMode(!1),r.formBuilder=null,t.eventHandlers.close&&t.eventHandlers.close()},t.prototype.destroy=function(){this.view.empty().remove(),this.sortable=null},t.prototype.on=function(e,t){this.eventHandlers[e]=t},t.prototype.toJSON=function(s){var t={};return this.elements.containers.form_view.find("input, textarea, select").each(function(){var e;u(this).data("skip")||u(this).prop("disabled")||!u(this).attr("name")||!s&&"checkbox"==u(this).attr("type")&&null==u(this).attr("checked")||"radio"==u(this).attr("type")&&!u(this).is(":checked")||(e="checkbox"==u(this).attr("type")?u(this).prop("checked"):u(this).val(),function e(t,a,i){(s||i)&&(1==a.length?t[a[0]]=i:(null==t[a[0]]&&(""===a[1]?t[a[0]]=[]:t[a[0]]={}),void 0!==t[a[0]].length?t[a[0]].push(i):e(t[a[0]],a.slice(1),i)))}(t,u(this).attr("name").replace(/]/g,"").split("["),e))}),t},t.prototype.getRegionsList=function(){return this.mapsvg.getData().regions.map(function(e){return{id:e.id,title:e.title}})},t.prototype.getMarkersList=function(){return this.mapsvg.getData().markers.map(function(e){return{id:e.id}})},r.FormBuilder=t}(jQuery,MapSVG,window);
!function(e,n){"function"==typeof define&&define.amd?define(["jquery"],function(t){return e.Bloodhound=n(t)}):"object"==typeof exports?module.exports=n(require("jquery")):e.Bloodhound=n(e.jQuery)}(this,function(c){var h=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:c.isArray,isFunction:c.isFunction,isObject:c.isPlainObject,isUndefined:function(t){return void 0===t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(t){return t instanceof c},toStr:function(t){return h.isUndefined(t)||null===t?"":t+""},bind:c.proxy,each:function(t,n){c.each(t,function(t,e){return n(e,t)})},map:c.map,filter:c.grep,every:function(n,i){var s=!0;return n?(c.each(n,function(t,e){if(!(s=i.call(null,e,t,n)))return!1}),!!s):s},some:function(n,i){var s=!1;return n?(c.each(n,function(t,e){if(s=i.call(null,e,t,n))return!1}),!!s):s},mixin:c.extend,identity:function(t){return t},clone:function(t){return c.extend(!0,{},t)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(t){return c.isFunction(t)?t:function(){return String(t)}},defer:function(t){setTimeout(t,0)},debounce:function(s,r,o){var a,u;return function(){var t=this,e=arguments,n=function(){a=null,o||(u=s.apply(t,e))},i=o&&!a;return clearTimeout(a),a=setTimeout(n,r),u=i?s.apply(t,e):u}},throttle:function(n,i){var s,r,o,a,u=0,c=function(){u=new Date,o=null,a=n.apply(s,r)};return function(){var t=new Date,e=i-(t-u);return s=this,r=arguments,e<=0?(clearTimeout(o),o=null,u=t,a=n.apply(s,r)):o=o||setTimeout(c,e),a}},stringify:function(t){return h.isString(t)?t:JSON.stringify(t)},guid:function(){function t(t){var e=(Math.random().toString(16)+"000000000").substr(2,8);return t?"-"+e.substr(0,4)+"-"+e.substr(4,4):e}return"tt-"+t()+t(!0)+t(!0)+t()},noop:function(){}}}(),n=function(){"use strict";function t(t){return(t=h.toStr(t))?t.split(/\s+/):[]}function e(t){return(t=h.toStr(t))?t.split(/\W+/):[]}function n(t){t=h.toStr(t);var e=[],n="";return h.each(t.split(""),function(t){t.match(/\s+/)?n="":(e.push(n+t),n+=t)}),e}function i(i){return function(t){return t=h.isArray(t)?t:[].slice.call(arguments,0),function(e){var n=[];return h.each(t,function(t){n=n.concat(i(h.toStr(e[t])))}),n}}}return{nonword:e,whitespace:t,ngram:n,obj:{nonword:i(e),whitespace:i(t),ngram:i(n)}}}(),i=function(){"use strict";function t(t){this.maxSize=h.isNumber(t)?t:100,this.reset(),this.maxSize<=0&&(this.set=this.get=c.noop)}function e(){this.head=this.tail=null}function i(t,e){this.key=t,this.val=e,this.prev=this.next=null}return h.mixin(t.prototype,{set:function(t,e){var n=this.list.tail;this.size>=this.maxSize&&(this.list.remove(n),delete this.hash[n.key],this.size--),(n=this.hash[t])?(n.val=e,this.list.moveToFront(n)):(n=new i(t,e),this.list.add(n),this.hash[t]=n,this.size++)},get:function(t){t=this.hash[t];if(t)return this.list.moveToFront(t),t.val},reset:function(){this.size=0,this.hash={},this.list=new e}}),h.mixin(e.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),t}(),e=function(){"use strict";function t(t,e){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+h.escapeRegExChars(this.prefix)),this.ls=e||r,this.ls||this._noop()}function i(){return(new Date).getTime()}function s(t){return JSON.stringify(h.isUndefined(t)?null:t)}function e(t){return c.parseJSON(t)}var r;try{(r=window.localStorage).setItem("~~~","!"),r.removeItem("~~~")}catch(t){r=null}return h.mixin(t.prototype,{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=h.noop},_safeSet:function(t,e){try{this.ls.setItem(t,e)}catch(t){"QuotaExceededError"===t.name&&(this.clear(),this._noop())}},get:function(t){return this.isExpired(t)&&this.remove(t),e(this.ls.getItem(this._prefix(t)))},set:function(t,e,n){return h.isNumber(n)?this._safeSet(this._ttlKey(t),s(i()+n)):this.ls.removeItem(this._ttlKey(t)),this._safeSet(this._prefix(t),s(e))},remove:function(t){return this.ls.removeItem(this._ttlKey(t)),this.ls.removeItem(this._prefix(t)),this},clear:function(){for(var t=function(t){for(var e,n=[],i=r.length,s=0;s<i;s++)(e=r.key(s)).match(t)&&n.push(e.replace(t,""));return n}(this.keyMatcher),e=t.length;e--;)this.remove(t[e]);return this},isExpired:function(t){t=e(this.ls.getItem(this._ttlKey(t)));return!!(h.isNumber(t)&&i()>t)}}),t}(),s=function(){"use strict";function t(t){t=t||{},this.maxPendingRequests=t.maxPendingRequests||6,this.cancelled=!1,this.lastReq=null,this._send=t.transport,this._get=t.limiter?t.limiter(this._get):this._get,this._cache=!1===t.cache?new i(0):e}var a=0,u={},e=new i(10);return t.setMaxPendingRequests=function(t){this.maxPendingRequests=t},t.resetCache=function(){e.reset()},h.mixin(t.prototype,{_fingerprint:function(t){return(t=t||{}).url+t.type+c.param(t.data||{})},_get:function(t,e){function n(t){e(null,t),r._cache.set(o,t)}function i(){e(!0)}var s,r=this,o=this._fingerprint(t);this.cancelled||o!==this.lastReq||((s=u[o])?s.done(n).fail(i):a<this.maxPendingRequests?(a++,u[o]=this._send(t).done(n).fail(i).always(function(){a--,delete u[o],r.onDeckRequestArgs&&(r._get.apply(r,r.onDeckRequestArgs),r.onDeckRequestArgs=null)})):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(t,e){var n;e=e||c.noop,t=h.isString(t)?{url:t}:t||{},n=this._fingerprint(t),this.cancelled=!1,this.lastReq=n,(n=this._cache.get(n))?e(null,n):this._get(t,e)},cancel:function(){this.cancelled=!0}}),t}(),r=window.SearchIndex=function(){"use strict";function t(t){(t=t||{}).datumTokenizer&&t.queryTokenizer||c.error("datumTokenizer and queryTokenizer are both required"),this.identify=t.identify||h.stringify,this.datumTokenizer=t.datumTokenizer,this.queryTokenizer=t.queryTokenizer,this.matchAnyQueryToken=t.matchAnyQueryToken,this.reset()}function e(t){return t=h.filter(t,function(t){return!!t}),h.map(t,function(t){return t.toLowerCase()})}function o(){var t={};return t[u]=[],t[a]={},t}var a="c",u="i";return h.mixin(t.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var r=this;t=h.isArray(t)?t:[t],h.each(t,function(t){var s;r.datums[s=r.identify(t)]=t,t=e(r.datumTokenizer(t)),h.each(t,function(t){for(var e,n=r.trie,i=t.split("");e=i.shift();)(n=n[a][e]||(n[a][e]=o()))[u].push(s)})})},get:function(t){var e=this;return h.map(t,function(t){return e.datums[t]})},search:function(t){var s,r=this,t=e(this.queryTokenizer(t));return h.each(t,function(t){var e,n,i;if(s&&0===s.length&&!r.matchAnyQueryToken)return!1;for(e=r.trie,n=t.split("");e&&(i=n.shift());)e=e[a][i];if(e&&0===n.length)t=e[u].slice(0),s=s?function(t,e){var n=0,i=0,s=[];t=t.sort(),e=e.sort();for(var r=t.length,o=e.length;n<r&&i<o;)t[n]<e[i]?n++:(t[n]>e[i]||(s.push(t[n]),n++),i++);return s}(s,t):t;else if(!r.matchAnyQueryToken)return!(s=[])}),s?h.map(function(t){for(var e={},n=[],i=0,s=t.length;i<s;i++)e[t[i]]||(e[t[i]]=!0,n.push(t[i]));return n}(s),function(t){return r.datums[t]}):[]},all:function(){var t,e=[];for(t in this.datums)e.push(this.datums[t]);return e},reset:function(){this.datums={},this.trie=o()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),t}(),o=function(){"use strict";function t(t){this.url=t.url,this.ttl=t.ttl,this.cache=t.cache,this.prepare=t.prepare,this.transform=t.transform,this.transport=t.transport,this.thumbprint=t.thumbprint,this.storage=new e(t.cacheKey)}var n={data:"data",protocol:"protocol",thumbprint:"thumbprint"};return h.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(t){this.cache&&(this.storage.set(n.data,t,this.ttl),this.storage.set(n.protocol,location.protocol,this.ttl),this.storage.set(n.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var t,e={};return this.cache?(e.data=this.storage.get(n.data),e.protocol=this.storage.get(n.protocol),e.thumbprint=this.storage.get(n.thumbprint),t=e.thumbprint!==this.thumbprint||e.protocol!==location.protocol,e.data&&!t?e.data:null):null},fromNetwork:function(e){var t,n=this;e&&(t=this.prepare(this._settings()),this.transport(t).fail(function(){e(!0)}).done(function(t){e(null,n.transform(t))}))},clear:function(){return this.storage.clear(),this}}),t}(),a=function(){"use strict";function t(t){this.url=t.url,this.prepare=t.prepare,this.transform=t.transform,this.indexResponse=t.indexResponse,this.transport=new s({cache:t.cache,limiter:t.limiter,transport:t.transport,maxPendingRequests:t.maxPendingRequests})}return h.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(t,n){var i=this;if(n)return t=t||"",t=this.prepare(t,this._settings()),this.transport.get(t,function(t,e){n(t?[]:i.transform(e))})},cancelLastRequest:function(){this.transport.cancel()}}),t}(),u=function(){"use strict";function s(t){var e,n,i,s,r;if(t)return e={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:h.identity,transport:null},t=h.isString(t)?{url:t}:t,(t=h.mixin(e,t)).url||c.error("remote requires url to be set"),t.transform=t.filter||t.transform,t.prepare=(i=(n=t).prepare,s=n.replace,r=n.wildcard,i=i||(s?function(t,e){return e.url=s(e.url,t),e}:n.wildcard?function(t,e){return e.url=e.url.replace(r,encodeURIComponent(t)),e}:function(t,e){return e})),t.limiter=(n=(e=t).limiter,i=e.rateLimitBy,e=e.rateLimitWait,n=n||(/^throttle$/i.test(i)?function(e){return function(t){return h.throttle(t,e)}}:function(e){return function(t){return h.debounce(t,e)}})(e)),t.transport=t.transport?o(t.transport):c.ajax,delete t.replace,delete t.wildcard,delete t.rateLimitBy,delete t.rateLimitWait,t}function o(n){return function(t){var e=c.Deferred();return n(t,function(t){h.defer(function(){e.resolve(t)})},function(t){h.defer(function(){e.reject(t)})}),e}}return function(t){var e,n,i={initialize:!0,identify:h.stringify,datumTokenizer:null,queryTokenizer:null,matchAnyQueryToken:!1,sufficient:5,indexRemote:!1,sorter:null,local:[],prefetch:null,remote:null};return(t=h.mixin(i,t||{})).datumTokenizer||c.error("datumTokenizer is required"),t.queryTokenizer||c.error("queryTokenizer is required"),e=t.sorter,t.sorter=e?function(t){return t.sort(e)}:h.identity,t.local=h.isFunction(t.local)?t.local():t.local,t.prefetch=(n=t.prefetch)?(i={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:h.identity,transform:h.identity,transport:null},n=h.isString(n)?{url:n}:n,(n=h.mixin(i,n)).url||c.error("prefetch requires url to be set"),n.transform=n.filter||n.transform,n.cacheKey=n.cacheKey||n.url,n.thumbprint="1.2.0"+n.thumbprint,n.transport=n.transport?o(n.transport):c.ajax,n):null,t.remote=s(t.remote),t}}();return function(){"use strict";function t(t){t=u(t),this.sorter=t.sorter,this.identify=t.identify,this.sufficient=t.sufficient,this.indexRemote=t.indexRemote,this.local=t.local,this.remote=t.remote?new a(t.remote):null,this.prefetch=t.prefetch?new o(t.prefetch):null,this.index=new r({identify:this.identify,datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer}),!1!==t.initialize&&this.initialize()}var e=window&&window.Bloodhound;return t.noConflict=function(){return window&&(window.Bloodhound=e),t},t.tokenizers=n,h.mixin(t.prototype,{__ttAdapter:function(){var i=this;return this.remote?function(t,e,n){return i.search(t,e,n)}:function(t,e){return i.search(t,e)}},_loadPrefetch:function(){var t,n=this,i=c.Deferred();return this.prefetch?(t=this.prefetch.fromCache())?(this.index.bootstrap(t),i.resolve()):this.prefetch.fromNetwork(function(t,e){return t?i.reject():(n.add(e),n.prefetch.store(n.index.serialize()),void i.resolve())}):i.resolve(),i.promise()},_initialize:function(){var t=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(function(){t.add(t.local)}),this.initPromise},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){return this.index.add(t),this},get:function(t){return t=h.isArray(t)?t:[].slice.call(arguments),this.index.get(t)},search:function(t,e,i){var s,r=this;return e=e||h.noop,i=i||h.noop,s=this.sorter(this.index.search(t)),e(this.remote?s.slice():s),this.remote&&s.length<this.sufficient?this.remote.get(t,function(t){var n=[];h.each(t,function(e){h.some(s,function(t){return r.identify(e)===r.identify(t)})||n.push(e)}),r.indexRemote&&r.add(n),i(n)}):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return s.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),t}()}),function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(t.jQuery)}(this,function(f){var p=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:f.isArray,isFunction:f.isFunction,isObject:f.isPlainObject,isUndefined:function(t){return void 0===t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(t){return t instanceof f},toStr:function(t){return p.isUndefined(t)||null===t?"":t+""},bind:f.proxy,each:function(t,n){f.each(t,function(t,e){return n(e,t)})},map:f.map,filter:f.grep,every:function(n,i){var s=!0;return n?(f.each(n,function(t,e){if(!(s=i.call(null,e,t,n)))return!1}),!!s):s},some:function(n,i){var s=!1;return n?(f.each(n,function(t,e){if(s=i.call(null,e,t,n))return!1}),!!s):s},mixin:f.extend,identity:function(t){return t},clone:function(t){return f.extend(!0,{},t)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(t){return f.isFunction(t)?t:function(){return String(t)}},defer:function(t){setTimeout(t,0)},debounce:function(s,r,o){var a,u;return function(){var t=this,e=arguments,n=function(){a=null,o||(u=s.apply(t,e))},i=o&&!a;return clearTimeout(a),a=setTimeout(n,r),u=i?s.apply(t,e):u}},throttle:function(n,i){var s,r,o,a,u=0,c=function(){u=new Date,o=null,a=n.apply(s,r)};return function(){var t=new Date,e=i-(t-u);return s=this,r=arguments,e<=0?(clearTimeout(o),o=null,u=t,a=n.apply(s,r)):o=o||setTimeout(c,e),a}},stringify:function(t){return p.isString(t)?t:JSON.stringify(t)},guid:function(){function t(t){var e=(Math.random().toString(16)+"000000000").substr(2,8);return t?"-"+e.substr(0,4)+"-"+e.substr(4,4):e}return"tt-"+t()+t(!0)+t(!0)+t()},noop:function(){}}}(),n=function(){"use strict";var s={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return function(t){var n,e=p.mixin({},s,t),i={css:(t={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}},p.isMsie()&&p.mixin(t.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),t),classes:e,html:{wrapper:'<span class="'+(t=e).wrapper+'"></span>',menu:'<div role="listbox" class="'+t.menu+'"></div>'},selectors:(e=e,n={},p.each(e,function(t,e){n[e]="."+t}),n)};return{css:i.css,html:i.html,classes:i.classes,selectors:i.selectors,mixin:function(t){p.mixin(t,i)}}}}(),g=function(){"use strict";function t(t){t&&t.el||f.error("EventBus initialized without el"),this.$el=f(t.el)}var e={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"};return p.mixin(t.prototype,{_trigger:function(t,e){t=f.Event("typeahead:"+t);return this.$el.trigger.call(this.$el,t,e||[]),t},before:function(t){var e=[].slice.call(arguments,1);return this._trigger("before"+t,e).isDefaultPrevented()},trigger:function(t){this._trigger(t,[].slice.call(arguments,1)),(t=e[t])&&this._trigger(t,[].slice.call(arguments,1))}}),t}(),e=function(){"use strict";function i(t,e,n,i){var s,r,o;if(!n)return this;for(e=e.split(a),n=i?(o=i,(r=n).bind?r.bind(o):function(){r.apply(o,[].slice.call(arguments,0))}):n,this._callbacks=this._callbacks||{};s=e.shift();)this._callbacks[s]=this._callbacks[s]||{sync:[],async:[]},this._callbacks[s][t].push(n);return this}function r(i,s,r){return function(){for(var t,e=0,n=i.length;!t&&e<n;e+=1)t=!1===i[e].apply(s,r);return!t}}var a=/\s+/,o=window.setImmediate?function(t){setImmediate(function(){t()})}:function(t){setTimeout(function(){t()},0)};return{onSync:function(t,e,n){return i.call(this,"sync",t,e,n)},onAsync:function(t,e,n){return i.call(this,"async",t,e,n)},off:function(t){var e;if(!this._callbacks)return this;for(t=t.split(a);e=t.shift();)delete this._callbacks[e];return this},trigger:function(t){var e,n,i,s;if(!this._callbacks)return this;for(t=t.split(a),n=[].slice.call(arguments,1);(s=t.shift())&&(e=this._callbacks[s]);)i=r(e.sync,this,[s].concat(n)),s=r(e.async,this,[s].concat(n)),i()&&o(s);return this}}}(),o=function(o){"use strict";function u(t){return e[t.toUpperCase()]||t}var t={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1,diacriticInsensitive:!1},e={A:"[AaªÀ-Åà-åĀ-ąǍǎȀ-ȃȦȧᴬᵃḀḁẚẠ-ảₐ℀℁℻⒜Ⓐⓐ㍱-㍴㎀-㎄㎈㎉㎩-㎯㏂㏊㏟㏿Ａａ]",B:"[BbᴮᵇḂ-ḇℬ⒝Ⓑⓑ㍴㎅-㎇㏃㏈㏔㏝Ｂｂ]",C:"[CcÇçĆ-čᶜ℀ℂ℃℅℆ℭⅭⅽ⒞Ⓒⓒ㍶㎈㎉㎝㎠㎤㏄-㏇Ｃｃ]",D:"[DdĎďǄ-ǆǱ-ǳᴰᵈḊ-ḓⅅⅆⅮⅾ⒟Ⓓⓓ㋏㍲㍷-㍹㎗㎭-㎯㏅㏈Ｄｄ]",E:"[EeÈ-Ëè-ëĒ-ěȄ-ȇȨȩᴱᵉḘ-ḛẸ-ẽₑ℡ℯℰⅇ⒠Ⓔⓔ㉐㋍㋎Ｅｅ]",F:"[FfᶠḞḟ℉ℱ℻⒡Ⓕⓕ㎊-㎌㎙ﬀ-ﬄＦｆ]",G:"[GgĜ-ģǦǧǴǵᴳᵍḠḡℊ⒢Ⓖⓖ㋌㋍㎇㎍-㎏㎓㎬㏆㏉㏒㏿Ｇｇ]",H:"[HhĤĥȞȟʰᴴḢ-ḫẖℋ-ℎ⒣Ⓗⓗ㋌㍱㎐-㎔㏊㏋㏗Ｈｈ]",I:"[IiÌ-Ïì-ïĨ-İĲĳǏǐȈ-ȋᴵᵢḬḭỈ-ịⁱℐℑℹⅈⅠ-ⅣⅥ-ⅨⅪⅫⅰ-ⅳⅵ-ⅸⅺⅻ⒤Ⓘⓘ㍺㏌㏕ﬁﬃＩｉ]",J:"[JjĲ-ĵǇ-ǌǰʲᴶⅉ⒥ⒿⓙⱼＪｊ]",K:"[KkĶķǨǩᴷᵏḰ-ḵK⒦Ⓚⓚ㎄㎅㎉㎏㎑㎘㎞㎢㎦㎪㎸㎾㏀㏆㏍-㏏Ｋｋ]",L:"[LlĹ-ŀǇ-ǉˡᴸḶḷḺ-ḽℒℓ℡Ⅼⅼ⒧Ⓛⓛ㋏㎈㎉㏐-㏓㏕㏖㏿ﬂﬄＬｌ]",M:"[MmᴹᵐḾ-ṃ℠™ℳⅯⅿ⒨Ⓜⓜ㍷-㍹㎃㎆㎎㎒㎖㎙-㎨㎫㎳㎷㎹㎽㎿㏁㏂㏎㏐㏔-㏖㏘㏙㏞㏟Ｍｍ]",N:"[NnÑñŃ-ŉǊ-ǌǸǹᴺṄ-ṋⁿℕ№⒩Ⓝⓝ㎁㎋㎚㎱㎵㎻㏌㏑Ｎｎ]",O:"[OoºÒ-Öò-öŌ-őƠơǑǒǪǫȌ-ȏȮȯᴼᵒỌ-ỏₒ℅№ℴ⒪Ⓞⓞ㍵㏇㏒㏖Ｏｏ]",P:"[PpᴾᵖṔ-ṗℙ⒫Ⓟⓟ㉐㍱㍶㎀㎊㎩-㎬㎰㎴㎺㏋㏗-㏚Ｐｐ]",Q:"[Qqℚ⒬Ⓠⓠ㏃Ｑｑ]",R:"[RrŔ-řȐ-ȓʳᴿᵣṘ-ṛṞṟ₨ℛ-ℝ⒭Ⓡⓡ㋍㍴㎭-㎯㏚㏛Ｒｒ]",S:"[SsŚ-šſȘșˢṠ-ṣ₨℁℠⒮Ⓢⓢ㎧㎨㎮-㎳㏛㏜ﬆＳｓ]",T:"[TtŢ-ťȚțᵀᵗṪ-ṱẗ℡™⒯Ⓣⓣ㉐㋏㎔㏏ﬅﬆＴｔ]",U:"[UuÙ-Üù-üŨ-ųƯưǓǔȔ-ȗᵁᵘᵤṲ-ṷỤ-ủ℆⒰Ⓤⓤ㍳㍺Ｕｕ]",V:"[VvᵛᵥṼ-ṿⅣ-Ⅷⅳ-ⅷ⒱Ⓥⓥⱽ㋎㍵㎴-㎹㏜㏞Ｖｖ]",W:"[WwŴŵʷᵂẀ-ẉẘ⒲Ⓦⓦ㎺-㎿㏝Ｗｗ]",X:"[XxˣẊ-ẍₓ℻Ⅸ-Ⅻⅸ-ⅻ⒳Ⓧⓧ㏓Ｘｘ]",Y:"[YyÝýÿŶ-ŸȲȳʸẎẏẙỲ-ỹ⒴Ⓨⓨ㏉Ｙｙ]",Z:"[ZzŹ-žǱ-ǳᶻẐ-ẕℤℨ⒵Ⓩⓩ㎐-㎔Ｚｚ]"};return function(s){var r;(s=p.mixin({},t,s)).node&&s.pattern&&(s.pattern=p.isArray(s.pattern)?s.pattern:[s.pattern],r=function(t,e,n,i){for(var s=[],r=0,o=t.length;r<o;r++){var a=p.escapeRegExChars(t[r]);i&&(a=a.replace(/\S/g,u)),s.push(a)}return n=n?"\\b("+s.join("|")+")\\b":"("+s.join("|")+")",e?new RegExp(n):new RegExp(n,"i")}(s.pattern,s.caseSensitive,s.wordsOnly,s.diacriticInsensitive),function t(e,n){for(var i,s=0;s<e.childNodes.length;s++)3===(i=e.childNodes[s]).nodeType?s+=n(i)?1:0:t(i,n)}(s.node,function(t){var e,n,i;return(e=r.exec(t.data))&&(i=o.createElement(s.tagName),s.className&&(i.className=s.className),(n=t.splitText(e.index)).splitText(e[0].length),i.appendChild(n.cloneNode(!0)),t.parentNode.replaceChild(i,n)),!!e}))}}(window.document),m=function(){"use strict";function s(t,e){(t=t||{}).input||f.error("input is missing"),e.mixin(this),this.$hint=f(t.hint),this.$input=f(t.input),this.$input.attr({"aria-activedescendant":"","aria-owns":this.$input.attr("id")+"_listbox",role:"combobox","aria-readonly":"true","aria-autocomplete":"list"}),f(e.menu).attr("id",this.$input.attr("id")+"_listbox"),this.query=this.$input.val(),this.queryWhenFocused=this.hasFocus()?this.query:null,this.$overflowHelper=(e=this.$input,f('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),fontWeight:e.css("font-weight"),wordSpacing:e.css("word-spacing"),letterSpacing:e.css("letter-spacing"),textIndent:e.css("text-indent"),textRendering:e.css("text-rendering"),textTransform:e.css("text-transform")}).insertAfter(e)),this._checkLanguageDirection(),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=p.noop),this.onSync("cursorchange",this._updateDescendent)}function i(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}var r={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};return s.normalizeQuery=function(t){return p.toStr(t).replace(/^\s*/g,"").replace(/\s{2,}/g," ")},p.mixin(s.prototype,e,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query,this.trigger("focused")},_onKeydown:function(t){var e=r[t.which||t.keyCode];this._managePreventDefault(e,t),e&&this._shouldTrigger(e,t)&&this.trigger(e+"Keyed",t)},_onInput:function(){this._setQuery(this.getInputValue()),this.clearHintIfInvalid(),this._checkLanguageDirection()},_managePreventDefault:function(t,e){var n;switch(t){case"up":case"down":n=!i(e);break;default:n=!1}n&&e.preventDefault()},_shouldTrigger:function(t,e){e="tab"!==t||!i(e);return e},_checkLanguageDirection:function(){var t=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==t&&(this.dir=t,this.$hint.attr("dir",t),this.trigger("langDirChanged",t))},_setQuery:function(t,e){var n,i;n=t,i=this.query,i=!!(n=s.normalizeQuery(n)===s.normalizeQuery(i))&&this.query.length!==t.length,this.query=t,e||n?!e&&i&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},_updateDescendent:function(t,e){this.$input.attr("aria-activedescendant",e)},bind:function(){var e=this,t=p.bind(this._onBlur,this),n=p.bind(this._onFocus,this),i=p.bind(this._onKeydown,this),s=p.bind(this._onInput,this);return this.$input.on("blur.tt",t).on("focus.tt",n).on("keydown.tt",i),!p.isMsie()||9<p.isMsie()?this.$input.on("input.tt",s):this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(t){r[t.which||t.keyCode]||p.defer(p.bind(e._onInput,e,t))}),this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(t,e){this.setInputValue(t),this._setQuery(t,e)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(t){this.$input.val(t),this.clearHintIfInvalid(),this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(t){this.$hint.val(t)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var t=this.getInputValue(),e=this.getHint(),e=t!==e&&0===e.indexOf(t);""!==t&&e&&!this.hasOverflow()||this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var t=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=t},isCursorAtEnd:function(){var t=this.$input.val().length,e=this.$input[0].selectionStart;return p.isNumber(e)?e===t:!document.selection||((e=document.selection.createRange()).moveStart("character",-t),t===e.text.length)},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$overflowHelper.remove(),this.$hint=this.$input=this.$overflowHelper=f("<div>")}}),s}(),s=function(){"use strict";function t(t,e){var n,i;(t=t||{}).templates=t.templates||{},t.templates.notFound=t.templates.notFound||t.templates.empty,t.source||f.error("missing source"),t.node||f.error("missing node"),t.name&&!/^[_a-zA-Z0-9-]+$/.test(t.name)&&f.error("invalid dataset name: "+t.name),e.mixin(this),this.highlight=!!t.highlight,this.name=p.toStr(t.name||s()),this.limit=t.limit||5,this.displayFn=(i=(i=t.display||t.displayKey)||p.stringify,p.isFunction(i)?i:function(t){return t[i]}),this.templates=(e=t.templates,n=this.displayFn,{notFound:e.notFound&&p.templatify(e.notFound),pending:e.pending&&p.templatify(e.pending),header:e.header&&p.templatify(e.header),footer:e.footer&&p.templatify(e.footer),suggestion:e.suggestion||function(t){return f('<div role="option">').attr("id",p.guid()).text(n(t))}}),this.source=t.source.__ttAdapter?t.source.__ttAdapter():t.source,this.async=p.isUndefined(t.async)?2<this.source.length:!!t.async,this._resetLastSuggestion(),this.$el=f(t.node).attr("role","presentation").addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}var r={dataset:"tt-selectable-dataset",val:"tt-selectable-display",obj:"tt-selectable-object"},s=p.getIdGenerator();return t.extractData=function(t){t=f(t);return t.data(r.obj)?{dataset:t.data(r.dataset)||"",val:t.data(r.val)||"",obj:t.data(r.obj)||null}:null},p.mixin(t.prototype,e,{_overwrite:function(t,e){(e=e||[]).length?this._renderSuggestions(t,e):this.async&&this.templates.pending?this._renderPending(t):!this.async&&this.templates.notFound?this._renderNotFound(t):this._empty(),this.trigger("rendered",e,!1,this.name)},_append:function(t,e){(e=e||[]).length&&this.$lastSuggestion.length?this._appendSuggestions(t,e):e.length?this._renderSuggestions(t,e):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(t),this.trigger("rendered",e,!0,this.name)},_renderSuggestions:function(t,e){var n=this._getSuggestionsFragment(t,e);this.$lastSuggestion=n.children().last(),this.$el.html(n).prepend(this._getHeader(t,e)).append(this._getFooter(t,e))},_appendSuggestions:function(t,e){t=this._getSuggestionsFragment(t,e),e=t.children().last();this.$lastSuggestion.after(t),this.$lastSuggestion=e},_renderPending:function(t){var e=this.templates.pending;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_renderNotFound:function(t){var e=this.templates.notFound;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_empty:function(){this.$el.empty(),this._resetLastSuggestion()},_getSuggestionsFragment:function(n,t){var i=this,s=document.createDocumentFragment();return p.each(t,function(t){var e=i._injectQuery(n,t),t=f(i.templates.suggestion(e)).data(r.dataset,i.name).data(r.obj,t).data(r.val,i.displayFn(t)).addClass(i.classes.suggestion+" "+i.classes.selectable);s.appendChild(t[0])}),this.highlight&&o({className:this.classes.highlight,node:s,pattern:n}),f(s)},_getFooter:function(t,e){return this.templates.footer?this.templates.footer({query:t,suggestions:e,dataset:this.name}):null},_getHeader:function(t,e){return this.templates.header?this.templates.header({query:t,suggestions:e,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=f()},_injectQuery:function(t,e){return p.isObject(e)?p.mixin({_query:t},e):e},update:function(n){function t(t){e||(e=!0,t=(t||[]).slice(0,i.limit),r=t.length,i._overwrite(n,t),r<i.limit&&i.async&&i.trigger("asyncRequested",n,i.name))}var i=this,s=!1,e=!1,r=0;this.cancel(),this.cancel=function(){s=!0,i.cancel=f.noop,i.async&&i.trigger("asyncCanceled",n,i.name)},this.source(n,t,function(t){var e;t=t||[],!s&&r<i.limit&&(i.cancel=f.noop,e=Math.abs(r-i.limit),r+=e,i._append(n,t.slice(0,e)),i.async&&i.trigger("asyncReceived",n,i.name))}),e||t([])},cancel:f.noop,clear:function(){this._empty(),this.cancel(),this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=f("<div>")}}),t}(),y=function(){"use strict";function t(t,n){var i=this;(t=t||{}).node||f.error("node is required"),n.mixin(this),this.$node=f(t.node),this.query=null,this.datasets=p.map(t.datasets,function(t){var e=i.$node.find(t.node).first();return t.node=e.length?e:f("<div>").appendTo(i.$node),new s(t,n)})}return p.mixin(t.prototype,e,{_onSelectableClick:function(t){this.trigger("selectableClicked",f(t.currentTarget))},_onRendered:function(t,e,n,i){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetRendered",e,n,i)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){return p.every(this.datasets,p.bind(function(t){t=t.isEmpty();return this.$node.attr("aria-expanded",!t),t},this))},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var t=this.getActiveSelectable();t&&t.removeClass(this.classes.cursor)},_ensureVisible:function(t){var e=t.position().top,n=e+t.outerHeight(!0),i=this.$node.scrollTop(),t=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10);e<0?this.$node.scrollTop(i+e):t<n&&this.$node.scrollTop(i+(n-t))},bind:function(){var e=this,t=p.bind(this._onSelectableClick,this);return this.$node.on("click.tt",this.selectors.selectable,t),this.$node.on("mouseover",this.selectors.selectable,function(){e.setCursor(f(this))}),this.$node.on("mouseleave",function(){e._removeCursor()}),p.each(this.datasets,function(t){t.onSync("asyncRequested",e._propagate,e).onSync("asyncCanceled",e._propagate,e).onSync("asyncReceived",e._propagate,e).onSync("rendered",e._onRendered,e).onSync("cleared",e._onCleared,e)}),this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.scrollTop(0),this.$node.addClass(this.classes.open)},close:function(){this.$node.attr("aria-expanded",!1),this.$node.removeClass(this.classes.open),this._removeCursor()},setLanguageDirection:function(t){this.$node.attr("dir",t)},selectableRelativeToCursor:function(t){var e=this.getActiveSelectable(),n=this._getSelectables(),t=(e?n.index(e):-1)+t;return-1===(t=(t=(t+1)%(n.length+1)-1)<-1?n.length-1:t)?null:n.eq(t)},setCursor:function(t){this._removeCursor(),(t=t&&t.first())&&(t.addClass(this.classes.cursor),this._ensureVisible(t))},getSelectableData:function(t){return t&&t.length?s.extractData(t):null},getActiveSelectable:function(){var t=this._getSelectables().filter(this.selectors.cursor).first();return t.length?t:null},getTopSelectable:function(){var t=this._getSelectables().first();return t.length?t:null},update:function(e){var t=e!==this.query;return t&&(this.query=e,p.each(this.datasets,function(t){t.update(e)})),t},empty:function(){p.each(this.datasets,function(t){t.clear()}),this.query=null,this.$node.addClass(this.classes.empty)},destroy:function(){this.$node.off(".tt"),this.$node=f("<div>"),p.each(this.datasets,function(t){t.destroy()})}}),t}(),v=function(){"use strict";function t(t){this.$el=f("<span></span>",{role:"status","aria-live":"polite"}).css({position:"absolute",padding:"0",border:"0",height:"1px",width:"1px","margin-bottom":"-1px","margin-right":"-1px",overflow:"hidden",clip:"rect(0 0 0 0)","white-space":"nowrap"}),t.$input.after(this.$el),p.each(t.menu.datasets,p.bind(function(t){t.onSync&&(t.onSync("rendered",p.bind(this.update,this)),t.onSync("cleared",p.bind(this.cleared,this)))},this))}return p.mixin(t.prototype,{update:function(t,e){var n=e.length,e=1===n?{result:"result",is:"is"}:{result:"results",is:"are"};this.$el.text(n+" "+e.result+" "+e.is+" available, use up and down arrow keys to navigate.")},cleared:function(){this.$el.text("")}}),t}(),_=function(){"use strict";function t(){y.apply(this,[].slice.call(arguments,0))}var e=y.prototype;return p.mixin(t.prototype,y.prototype,{open:function(){return this._allDatasetsEmpty()||this._show(),e.open.apply(this,[].slice.call(arguments,0))},close:function(){return this._hide(),e.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),e._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),e._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(t){return this.$node.css("ltr"===t?this.css.ltr:this.css.rtl),e.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}}),t}(),b=function(){"use strict";function t(t,e){var n,i,s,r,o,a,u,c,h;(t=t||{}).input||f.error("missing input"),t.menu||f.error("missing menu"),t.eventBus||f.error("missing event bus"),e.mixin(this),this.eventBus=t.eventBus,this.minLength=p.isNumber(t.minLength)?t.minLength:1,this.input=t.input,this.menu=t.menu,this.enabled=!0,this.autoselect=!!t.autoselect,this.active=!1,this.input.hasFocus()&&this.activate(),this.dir=this.input.getLangDir(),this._hacks(),this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this),n=l(this,"activate","open","_onFocused"),i=l(this,"deactivate","_onBlurred"),s=l(this,"isActive","isOpen","_onEnterKeyed"),r=l(this,"isActive","isOpen","_onTabKeyed"),o=l(this,"isActive","_onEscKeyed"),a=l(this,"isActive","open","_onUpKeyed"),u=l(this,"isActive","open","_onDownKeyed"),c=l(this,"isActive","isOpen","_onLeftKeyed"),h=l(this,"isActive","isOpen","_onRightKeyed"),e=l(this,"_openIfActive","_onQueryChanged"),t=l(this,"_openIfActive","_onWhitespaceChanged"),this.input.bind().onSync("focused",n,this).onSync("blurred",i,this).onSync("enterKeyed",s,this).onSync("tabKeyed",r,this).onSync("escKeyed",o,this).onSync("upKeyed",a,this).onSync("downKeyed",u,this).onSync("leftKeyed",c,this).onSync("rightKeyed",h,this).onSync("queryChanged",e,this).onSync("whitespaceChanged",t,this).onSync("langDirChanged",this._onLangDirChanged,this)}function l(n){var t=[].slice.call(arguments,1);return function(){var e=[].slice.call(arguments);p.each(t,function(t){return n[t].apply(n,e)})}}return p.mixin(t.prototype,{_hacks:function(){var i=this.input.$input||f("<div>"),s=this.menu.$node||f("<div>");i.on("blur.tt",function(t){var e=document.activeElement,n=s.is(e),e=0<s.has(e).length;p.isMsie()&&(n||e)&&(t.preventDefault(),t.stopImmediatePropagation(),p.defer(function(){i.focus()}))}),s.on("mousedown.tt",function(t){t.preventDefault()})},_onSelectableClicked:function(t,e){this.select(e)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(t,e,n,i){var s;this._updateHint(),this.autoselect&&(s=this.selectors.cursor.substr(1),this.menu.$node.find(this.selectors.suggestion).first().addClass(s)),this.eventBus.trigger("render",e,n,i)},_onAsyncRequested:function(t,e,n){this.eventBus.trigger("asyncrequest",n,e)},_onAsyncCanceled:function(t,e,n){this.eventBus.trigger("asynccancel",n,e)},_onAsyncReceived:function(t,e,n){this.eventBus.trigger("asyncreceive",n,e)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())?this.select(n)&&(e.preventDefault(),e.stopPropagation()):this.autoselect&&this.select(this.menu.getTopSelectable())&&(e.preventDefault(),e.stopPropagation())},_onTabKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())?this.select(n)&&e.preventDefault():(n=this.menu.getTopSelectable())&&this.autocomplete(n)&&e.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getActiveSelectable()||this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getActiveSelectable()||this.menu.getTopSelectable())},_onQueryChanged:function(t,e){this._minLengthMet(e)?this.menu.update(e):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(t,e){this.dir!==e&&(this.dir=e,this.menu.setLanguageDirection(e))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(t){return(t=p.isString(t)?t:this.input.getQuery()||"").length>=this.minLength},_updateHint:function(){var t=this.menu.getTopSelectable(),e=this.menu.getSelectableData(t),n=this.input.getInputValue();!e||p.isBlankString(n)||this.input.hasOverflow()?this.input.clearHint():(t=m.normalizeQuery(n),t=p.escapeRegExChars(t),(e=new RegExp("^(?:"+t+")(.+$)","i").exec(e.val))&&this.input.setHint(n+e[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){return!!this.isActive()||!(!this.isEnabled()||this.eventBus.before("active"))&&(this.active=!0,this.eventBus.trigger("active"),!0)},deactivate:function(){return!this.isActive()||!this.eventBus.before("idle")&&(this.active=!1,this.close(),this.eventBus.trigger("idle"),!0)},isOpen:function(){return this.menu.isOpen()},open:function(){return this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open")),this.isOpen()},close:function(){return this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close")),!this.isOpen()},setVal:function(t){this.input.setQuery(p.toStr(t))},getVal:function(){return this.input.getQuery()},select:function(t){t=this.menu.getSelectableData(t);return!(!t||this.eventBus.before("select",t.obj,t.dataset)||(this.input.setQuery(t.val,!0),this.eventBus.trigger("select",t.obj,t.dataset),this.close(),0))},autocomplete:function(t){var e=this.input.getQuery(),t=this.menu.getSelectableData(t);return!(!(t&&e!==t.val)||this.eventBus.before("autocomplete",t.obj,t.dataset)||(this.input.setQuery(t.val),this.eventBus.trigger("autocomplete",t.obj,t.dataset),0))},moveCursor:function(t){var e=this.input.getQuery(),n=this.menu.selectableRelativeToCursor(t),i=this.menu.getSelectableData(n),s=i?i.obj:null,r=i?i.dataset:null,t=n?n.attr("id"):null;return this.input.trigger("cursorchange",t),!(this._minLengthMet()&&this.menu.update(e))&&!this.eventBus.before("cursorchange",s,r)&&(this.menu.setCursor(n),i?this.input.setInputValue(i.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",s,r),!0)},destroy:function(){this.input.destroy(),this.menu.destroy()}}),t}();!function(){"use strict";function i(t,n){t.each(function(){var t,e=f(this);(t=e.data(d.typeahead))&&n(t,e)})}function l(t){t=p.isJQuery(t)||p.isElement(t)?f(t).first():[];return t.length?t:null}var t=f.fn.typeahead,d={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"},e={initialize:function(u,c){var h;return c=p.isArray(c)?c:[].slice.call(arguments,1),h=n((u=u||{}).classNames),this.each(function(){var t,e,n,i,s,r,o,a;p.each(c,function(t){t.highlight=!!u.highlight}),t=f(this),e=f(h.html.wrapper),n=l(u.hint),i=l(u.menu),r=!1!==u.hint&&!n,s=!1!==u.menu&&!i,r&&(a=h,n=(o=t).clone().addClass(a.classes.hint).removeData().css(a.css.hint).css({backgroundAttachment:(o=o).css("background-attachment"),backgroundClip:o.css("background-clip"),backgroundColor:o.css("background-color"),backgroundImage:o.css("background-image"),backgroundOrigin:o.css("background-origin"),backgroundPosition:o.css("background-position"),backgroundRepeat:o.css("background-repeat"),backgroundSize:o.css("background-size")}).prop({readonly:!0,required:!1}).removeAttr("id name placeholder").removeClass("required").attr({spellcheck:"false",tabindex:-1})),s&&(i=f(h.html.menu).css(h.css.menu)),n&&n.val(""),t=function(t,e){t.data(d.attrs,{dir:t.attr("dir"),autocomplete:t.attr("autocomplete"),spellcheck:t.attr("spellcheck"),style:t.attr("style")}),t.addClass(e.classes.input).attr({spellcheck:!1});try{t.attr("dir")||t.attr("dir","auto")}catch(t){}return t}(t,h),(r||s)&&(e.css(h.css.wrapper),t.css(r?h.css.input:h.css.inputWithNoHint),t.wrap(e).parent().prepend(r?n:null).append(s?i:null)),r=s?_:y,s=new g({el:t}),n=new m({hint:n,input:t},h),i=new r({node:i,datasets:c},h),new v({$input:t,menu:i}),s=new b({input:n,menu:i,eventBus:s,minLength:u.minLength,autoselect:u.autoselect},h),t.data(d.www,h),t.data(d.typeahead,s)})},isEnabled:function(){var e;return i(this.first(),function(t){e=t.isEnabled()}),e},enable:function(){return i(this,function(t){t.enable()}),this},disable:function(){return i(this,function(t){t.disable()}),this},isActive:function(){var e;return i(this.first(),function(t){e=t.isActive()}),e},activate:function(){return i(this,function(t){t.activate()}),this},deactivate:function(){return i(this,function(t){t.deactivate()}),this},isOpen:function(){var e;return i(this.first(),function(t){e=t.isOpen()}),e},open:function(){return i(this,function(t){t.open()}),this},close:function(){return i(this,function(t){t.close()}),this},select:function(t){var e=!1,n=f(t);return i(this.first(),function(t){e=t.select(n)}),e},autocomplete:function(t){var e=!1,n=f(t);return i(this.first(),function(t){e=t.autocomplete(n)}),e},moveCursor:function(e){var n=!1;return i(this.first(),function(t){n=t.moveCursor(e)}),n},val:function(e){var n;return arguments.length?(i(this,function(t){t.setVal(p.toStr(e))}),this):(i(this.first(),function(t){n=t.getVal()}),n)},destroy:function(){return i(this,function(t,e){var n,i;i=(n=e).data(d.www),e=n.parent().filter(i.selectors.wrapper),p.each(n.data(d.attrs),function(t,e){p.isUndefined(t)?n.removeAttr(e):n.attr(e,t)}),n.removeData(d.typeahead).removeData(d.www).removeData(d.attr).removeClass(i.classes.input),e.length&&(n.detach().insertAfter(e),e.remove()),t.destroy()}),this}};f.fn.typeahead=function(t){return e[t]?e[t].apply(this,[].slice.call(arguments,1)):e.initialize.apply(this,arguments)},f.fn.typeahead.noConflict=function(){return f.fn.typeahead=t,this}}()});
!function(e){"function"==typeof define&&define.amd?define(["jquery"],function(t){return e(t,window,document)}):"object"==typeof exports?module.exports=e(require("jquery"),window,document):e(jQuery,window,document)}(function(s,n,i){"use strict";var h,c,o,a,p,d,e,u,g,v,l,r,f,S,m,T,y,b,w,x,$,C,H,O,A;function t(t,e){this.el=t,this.options=e,c=c||w(),this.$el=s(this.el),this.doc=s(this.options.documentContext||i),this.win=s(this.options.windowContext||n),this.body=this.doc.find("body"),this.$content=this.$el.children("."+this.options.contentClass),this.$content.attr("tabindex",this.options.tabIndex||0),this.content=this.$content[0],this.previousPosition=0,this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}b={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",enabledClass:"has-scrollbar",flashedClass:"flashed",activeClass:"active",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null},S="scroll",e="mousedown",u="mouseenter",g="mousemove",l="mousewheel",v="mouseup",f="resize",p="drag",d="enter",T="up",o="DOMMouseScroll",a="down",m="touchmove",h="Microsoft Internet Explorer"===n.navigator.appName&&/msie 7./i.test(n.navigator.appVersion)&&n.ActiveXObject,c=null,C=n.requestAnimationFrame,y=n.cancelAnimationFrame,O=i.createElement("div").style,A=function(){for(var t,e=["t","webkitT","MozT","msT","OT"],i=t=0,s=e.length;t<s;i=++t)if(e[i],e[i]+"ransform"in O)return e[i].substr(0,e[i].length-1);return!1}(),H=function(t){return!1!==A&&(""===A?t:A+t.charAt(0).toUpperCase()+t.substr(1))}("transform"),x=!1!==H,w=function(){var t=i.createElement("div"),e=t.style;return e.position="absolute",e.width="100px",e.height="100px",e.overflow=S,e.top="-9999px",i.body.appendChild(t),e=t.offsetWidth-t.clientWidth,i.body.removeChild(t),e},$=function(){var t,e=n.navigator.userAgent;return!!(t=/(?=.+Mac OS X)(?=.+Firefox)/.test(e))&&(e=(e=/Firefox\/\d{2}\./.exec(e))&&e[0].replace(/\D+/g,""),t&&23<+e)},t.prototype.preventScrolling=function(t,e){this.isActive&&(t.type===o?(e===a&&0<t.originalEvent.detail||e===T&&t.originalEvent.detail<0)&&t.preventDefault():t.type===l&&t.originalEvent&&t.originalEvent.wheelDelta&&(e===a&&t.originalEvent.wheelDelta<0||e===T&&0<t.originalEvent.wheelDelta)&&t.preventDefault())},t.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},t.prototype.updateScrollValues=function(){var t=this.content;this.maxScrollTop=t.scrollHeight-t.clientHeight,this.prevScrollTop=this.contentScrollTop||0,this.contentScrollTop=t.scrollTop,t=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same",this.previousPosition=this.contentScrollTop,"same"!=t&&this.$el.trigger("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:t}),this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=0===this.maxScrollTop?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},t.prototype.setOnScrollStyles=function(){var t,e;x?(t={})[H]="translate(0, "+this.sliderTop+"px)":t={top:this.sliderTop},C?(y&&this.scrollRAF&&y(this.scrollRAF),this.scrollRAF=C((e=this,function(){return e.scrollRAF=null,e.slider.css(t)}))):this.slider.css(t)},t.prototype.createEvents=function(){var e,i,s,o,n,l,r,h;this.events={down:function(t){return h.isBeingDragged=!0,h.offsetY=t.pageY-h.slider.offset().top,h.slider.is(t.target)||(h.offsetY=0),h.pane.addClass(h.options.activeClass),h.doc.bind(g,h.events[p]).bind(v,h.events.up),h.body.bind(u,h.events[d]),!1},drag:function(t){return r.sliderY=t.pageY-r.$el.offset().top-r.paneTop-(r.offsetY||.5*r.sliderHeight),r.scroll(),r.contentScrollTop>=r.maxScrollTop&&r.prevScrollTop!==r.maxScrollTop?r.$el.trigger("scrollend"):0===r.contentScrollTop&&0!==r.prevScrollTop&&r.$el.trigger("scrolltop"),!1},up:function(t){return l.isBeingDragged=!1,l.pane.removeClass(l.options.activeClass),l.doc.unbind(g,l.events[p]).unbind(v,l.events.up),l.body.unbind(u,l.events[d]),!1},resize:function(t){n.reset()},panedown:function(t){return o.sliderY=(t.offsetY||t.originalEvent.layerY)-.5*o.sliderHeight,o.scroll(),o.events.down(t),!1},scroll:function(t){s.updateScrollValues(),s.isBeingDragged||(s.iOSNativeScrolling||(s.sliderY=s.sliderTop,s.setOnScrollStyles()),null!=t&&(s.contentScrollTop>=s.maxScrollTop?(s.options.preventPageScrolling&&s.preventScrolling(t,a),s.prevScrollTop!==s.maxScrollTop&&s.$el.trigger("scrollend")):0===s.contentScrollTop&&(s.options.preventPageScrolling&&s.preventScrolling(t,T),0!==s.prevScrollTop&&s.$el.trigger("scrolltop"))))},wheel:function(t){if(null!=t)return(t=t.delta||t.wheelDelta||t.originalEvent&&t.originalEvent.wheelDelta||-t.detail||t.originalEvent&&-t.originalEvent.detail)&&(i.sliderY+=-t/3),i.scroll(),!1},enter:(e=i=s=o=n=l=r=h=this,function(t){if(e.isBeingDragged)return 1!==(t.buttons||t.which)?(t=e.events).up.apply(t,arguments):void 0})}},t.prototype.addEvents=function(){var t;this.removeEvents(),t=this.events,this.options.disableResize||this.win.bind(f,t[f]),this.iOSNativeScrolling||(this.slider.bind(e,t[a]),this.pane.bind(e,t.panedown).bind(l+" "+o,t.wheel)),this.$content.bind(S+" "+l+" "+o+" "+m,t[S])},t.prototype.removeEvents=function(){var t=this.events;this.win.unbind(f,t[f]),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(S+" "+l+" "+o+" "+m,t[S])},t.prototype.generate=function(){var t,e,i=this.options,s=i.paneClass,o=i.sliderClass;i.contentClass;return(e=this.$el.children("."+s)).length||e.children("."+o).length||this.$el.append('<div class="'+s+'"><div class="'+o+'" /></div>'),this.pane=this.$el.children("."+s),this.slider=this.pane.find("."+o),0===c&&$()?t={right:-14,paddingRight:+n.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/[^0-9.]+/g,"")+14}:c&&(t={right:-c},this.$el.addClass(i.enabledClass)),null!=t&&this.$content.css(t),this},t.prototype.restore=function(){this.stopped=!1,this.iOSNativeScrolling||this.pane.show(),this.addEvents()},t.prototype.reset=function(){var t,e,i,s,o,n,l,r;return this.iOSNativeScrolling?void(this.contentHeight=this.content.scrollHeight):(this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),l=(i=(t=this.content).style).overflowY,h&&this.$content.css({height:this.$content.height()}),e=t.scrollHeight+c,0<(r=parseInt(this.$el.css("max-height"),10))&&(this.$el.height(""),this.$el.height(t.scrollHeight>r?r:t.scrollHeight)),o=(s=this.pane.outerHeight(!1))+(n=parseInt(this.pane.css("top"),10))+parseInt(this.pane.css("bottom"),10),(r=Math.round(o/e*s))<this.options.sliderMinHeight?r=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&r>this.options.sliderMaxHeight&&(r=this.options.sliderMaxHeight),l===S&&i.overflowX!==S&&(r+=c),this.maxSliderTop=o-r,this.contentHeight=e,this.paneHeight=s,this.paneOuterHeight=o,this.sliderHeight=r,this.paneTop=n,this.slider.height(r),this.events.scroll(),this.pane.show(),this.isActive=!0,t.scrollHeight===t.clientHeight||this.pane.outerHeight(!0)>=t.scrollHeight&&l!==S?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===t.scrollHeight&&l===S?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),"static"!==(l=this.$content.css("position"))&&"relative"!==l||(l=parseInt(this.$content.css("right"),10))&&this.$content.css({right:"",marginRight:l}),this)},t.prototype.scroll=function(){return this.isActive?(this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop(this.maxScrollTop*this.sliderY/this.maxSliderTop),this.iOSNativeScrolling||(this.updateScrollValues(),this.setOnScrollStyles()),this):void 0},t.prototype.scrollBottom=function(t){return this.isActive?(this.$content.scrollTop(this.contentHeight-this.$content.height()-t).trigger(l),this.stop().restore(),this):void 0},t.prototype.scrollTop=function(t){return this.isActive?(this.$content.scrollTop(+t).trigger(l),this.stop().restore(),this):void 0},t.prototype.scrollTo=function(t){return this.isActive?(this.scrollTop(this.$el.find(t).get(0).offsetTop),this):void 0},t.prototype.stop=function(){return y&&this.scrollRAF&&(y(this.scrollRAF),this.scrollRAF=null),this.stopped=!0,this.removeEvents(),this.iOSNativeScrolling||this.pane.hide(),this},t.prototype.destroy=function(){return this.stopped||this.stop(),!this.iOSNativeScrolling&&this.pane.length&&this.pane.remove(),h&&this.$content.height(""),this.$content.removeAttr("tabindex"),this.$el.hasClass(this.options.enabledClass)&&(this.$el.removeClass(this.options.enabledClass),this.$content.css({right:""})),this},t.prototype.flash=function(){return!this.iOSNativeScrolling&&this.isActive?(this.reset(),this.pane.addClass(this.options.flashedClass),setTimeout(function(){t.pane.removeClass(t.options.flashedClass)},(t=this).options.flashDelay),this):void 0;var t},r=t,s.fn.nanoScroller=function(i){return this.each(function(){var t,e;if((e=this.nanoscroller)||(t=s.extend({},b,i),this.nanoscroller=e=new r(this,t)),i&&"object"==typeof i){if(s.extend(e.options,i),null!=i.scrollBottom)return e.scrollBottom(i.scrollBottom);if(null!=i.scrollTop)return e.scrollTop(i.scrollTop);if(i.scrollTo)return e.scrollTo(i.scrollTo);if("bottom"===i.scroll)return e.scrollBottom(0);if("top"===i.scroll)return e.scrollTop(0);if(i.scroll&&i.scroll instanceof s)return e.scrollTo(i.scroll);if(i.stop)return e.stop();if(i.destroy)return e.destroy();if(i.flash)return e.flash()}return e.reset()})},s.fn.nanoScroller.Constructor=r});
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(t){var e,n,i,o,d,s,p,h,g,f,r,a,m,v,y,l,o=((e=t&&t.fn&&t.fn.mselect2&&t.fn.mselect2.amd?t.fn.mselect2.amd:e)&&e.requirejs||(e?i=e:e={},p={},h={},g={},f={},r=Object.prototype.hasOwnProperty,a=[].slice,m=/\.js$/,v=function(e,t){var n,i,o=u(e),s=o[0];return e=o[1],s&&(n=b(s=c(s,t))),s?e=n&&n.normalize?n.normalize(e,(i=t,function(e){return c(e,i)})):c(e,t):(s=(o=u(e=c(e,t)))[0],e=o[1],s&&(n=b(s))),{f:s?s+"!"+e:e,n:e,pr:s,p:n}},y={require:function(e){return w(e)},exports:function(e){var t=p[e];return void 0!==t?t:p[e]={}},module:function(e){return{id:e,uri:"",exports:p[e],config:(t=e,function(){return g&&g.config&&g.config[t]||{}})};var t}},l=function(e,t,n,i){var o,s,r,a,l,c=[],u=typeof n;if(i=i||e,"undefined"==u||"function"==u){for(t=!t.length&&n.length?["require","exports","module"]:t,a=0;a<t.length;a+=1)if("require"===(s=(r=v(t[a],i)).f))c[a]=y.require(e);else if("exports"===s)c[a]=y.exports(e),l=!0;else if("module"===s)o=c[a]=y.module(e);else if(_(p,s)||_(h,s)||_(f,s))c[a]=b(s);else{if(!r.p)throw new Error(e+" missing "+s);r.p.load(r.n,w(i,!0),function(t){return function(e){p[t]=e}}(s),{}),c[a]=p[s]}u=n?n.apply(p[e],c):void 0,e&&(o&&o.exports!==d&&o.exports!==p[e]?p[e]=o.exports:u===d&&l||(p[e]=u))}else e&&(p[e]=n)},n=i=s=function(e,t,n,i,o){if("string"==typeof e)return y[e]?y[e](t):b(v(e,t).f);if(!e.splice){if((g=e).deps&&s(g.deps,g.callback),!t)return;t.splice?(e=t,t=n,n=null):e=d}return t=t||function(){},"function"==typeof n&&(n=i,i=o),i?l(d,e,t,n):setTimeout(function(){l(d,e,t,n)},4),s},s.config=function(e){return s(e)},n._defined=p,(o=function(e,t,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),_(p,e)||_(h,e)||(h[e]=[e,t,n])}).amd={jQuery:!0},e.requirejs=n,e.require=i,e.define=o),e.define("almond",function(){}),e.define("jquery",[],function(){var e=t||$;return null==e&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),e}),e.define("select2/utils",["jquery"],function(s){function c(e){var t,n=e.prototype,i=[];for(t in n)"function"==typeof n[t]&&"constructor"!==t&&i.push(t);return i}var e={Extend:function(e,t){function n(){this.constructor=e}var i,o={}.hasOwnProperty;for(i in t)o.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e}};e.Decorate=function(i,o){function s(){var e=Array.prototype.unshift,t=o.prototype.constructor.length,n=i.prototype.constructor;0<t&&(e.call(arguments,i.prototype.constructor),n=o.prototype.constructor),n.apply(this,arguments)}var e=c(o),t=c(i);o.displayName=i.displayName,s.prototype=new function(){this.constructor=s};for(var n=0;n<t.length;n++){var r=t[n];s.prototype[r]=i.prototype[r]}for(var a=0;a<e.length;a++){var l=e[a];s.prototype[l]=function(e){var t=function(){};e in s.prototype&&(t=s.prototype[e]);var n=o.prototype[e];return function(){return Array.prototype.unshift.call(arguments,t),n.apply(this,arguments)}}(l)}return s};function t(){this.listeners={}}return t.prototype.on=function(e,t){this.listeners=this.listeners||{},e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t]},t.prototype.trigger=function(e){var t=Array.prototype.slice,n=t.call(arguments,1);this.listeners=this.listeners||{},0===(n=null==n?[]:n).length&&n.push({}),(n[0]._type=e)in this.listeners&&this.invoke(this.listeners[e],t.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},t.prototype.invoke=function(e,t){for(var n=0,i=e.length;n<i;n++)e[n].apply(this,t)},e.Observable=t,e.generateChars=function(e){for(var t="",n=0;n<e;n++)t+=Math.floor(36*Math.random()).toString(36);return t},e.bind=function(e,t){return function(){e.apply(t,arguments)}},e._convertData=function(e){for(var t in e){var n=t.split("-"),i=e;if(1!==n.length){for(var o=0;o<n.length;o++){var s=n[o];(s=s.substring(0,1).toLowerCase()+s.substring(1))in i||(i[s]={}),o==n.length-1&&(i[s]=e[t]),i=i[s]}delete e[t]}}return e},e.hasScroll=function(e,t){var n=s(t),i=t.style.overflowX,o=t.style.overflowY;return(i!==o||"hidden"!==o&&"visible"!==o)&&("scroll"===i||"scroll"===o||(n.innerHeight()<t.scrollHeight||n.innerWidth()<t.scrollWidth))},e.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof e?e:String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})},e.appendMany=function(e,t){var n;"1.7"===s.fn.jquery.substr(0,3)&&(n=s(),s.map(t,function(e){n=n.add(e)}),t=n),e.append(t)},e}),e.define("select2/results",["jquery","./utils"],function(d,e){function i(e,t,n){this.$element=e,this.data=n,this.options=t,i.__super__.constructor.call(this)}return e.Extend(i,e.Observable),i.prototype.render=function(){var e=d('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&e.attr("aria-multiselectable","true"),this.$results=e},i.prototype.clear=function(){this.$results.empty()},i.prototype.displayMessage=function(e){var t=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var n=d('<li role="treeitem" aria-live="assertive" class="select2-results__option"></li>'),i=this.options.get("translations").get(e.message);n.append(t(i(e.args))),n[0].className+=" select2-results__message",this.$results.append(n)},i.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},i.prototype.append=function(e){this.hideLoading();var t=[];if(null!=e.results&&0!==e.results.length){e.results=this.sort(e.results);for(var n=0;n<e.results.length;n++){var i=e.results[n],i=this.option(i);t.push(i)}this.$results.append(t)}else 0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"})},i.prototype.position=function(e,t){t.find(".select2-results").append(e)},i.prototype.sort=function(e){return this.options.get("sorter")(e)},i.prototype.highlightFirstItem=function(){var e=this.$results.find(".select2-results__option[aria-selected]"),t=e.filter("[aria-selected=true]");(0<t.length?t:e).first().trigger("mouseenter"),this.ensureHighlightVisible()},i.prototype.setClasses=function(){var t=this;this.data.current(function(e){var i=d.map(e,function(e){return e.id.toString()});t.$results.find(".select2-results__option[aria-selected]").each(function(){var e=d(this),t=d.data(this,"data"),n=""+t.id;null!=t.element&&t.element.selected||null==t.element&&-1<d.inArray(n,i)?e.attr("aria-selected","true"):e.attr("aria-selected","false")})})},i.prototype.showLoading=function(e){this.hideLoading();e={disabled:!0,loading:!0,text:this.options.get("translations").get("searching")(e)},e=this.option(e);e.className+=" loading-results",this.$results.prepend(e)},i.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},i.prototype.option=function(e){var t=document.createElement("li");t.className="select2-results__option";var n,i={role:"treeitem","aria-selected":"false"};for(n in e.disabled&&(delete i["aria-selected"],i["aria-disabled"]="true"),null==e.id&&delete i["aria-selected"],null!=e._resultId&&(t.id=e._resultId),e.title&&(t.title=e.title),e.children&&(i.role="group",i["aria-label"]=e.text,delete i["aria-selected"]),i){var o=i[n];t.setAttribute(n,o)}if(e.children){var s=d(t),r=document.createElement("strong");r.className="select2-results__group",d(r),this.template(e,r);for(var a=[],l=0;l<e.children.length;l++){var c=e.children[l],c=this.option(c);a.push(c)}var u=d("<ul></ul>",{class:"select2-results__options select2-results__options--nested"});u.append(a),s.append(r),s.append(u)}else this.template(e,t);return d.data(t,"data",e),t},i.prototype.bind=function(t,e){var o=this,n=t.id+"-results";this.$results.attr("id",n),t.on("results:all",function(e){o.clear(),o.append(e.data),t.isOpen()&&(o.setClasses(),o.highlightFirstItem())}),t.on("results:append",function(e){o.append(e.data),t.isOpen()&&o.setClasses()}),t.on("query",function(e){o.hideMessages(),o.showLoading(e)}),t.on("select",function(){t.isOpen()&&(o.setClasses(),o.highlightFirstItem())}),t.on("unselect",function(){t.isOpen()&&(o.setClasses(),o.highlightFirstItem())}),t.on("open",function(){o.$results.attr("aria-expanded","true"),o.$results.attr("aria-hidden","false"),o.setClasses(),o.ensureHighlightVisible()}),t.on("close",function(){o.$results.attr("aria-expanded","false"),o.$results.attr("aria-hidden","true"),o.$results.removeAttr("aria-activedescendant")}),t.on("results:toggle",function(){var e=o.getHighlightedResults();0!==e.length&&e.trigger("mouseup")}),t.on("results:select",function(){var e,t=o.getHighlightedResults();0!==t.length&&(e=t.data("data"),"true"==t.attr("aria-selected")?o.trigger("close",{}):o.trigger("select",{data:e}))}),t.on("results:previous",function(){var e,t=o.getHighlightedResults(),n=o.$results.find("[aria-selected]"),i=n.index(t);0!==i&&(e=i-1,0===t.length&&(e=0),(i=n.eq(e)).trigger("mouseenter"),t=o.$results.offset().top,n=i.offset().top,i=o.$results.scrollTop()+(n-t),0===e?o.$results.scrollTop(0):n-t<0&&o.$results.scrollTop(i))}),t.on("results:next",function(){var e,t=o.getHighlightedResults(),n=o.$results.find("[aria-selected]"),i=n.index(t)+1;i>=n.length||((e=n.eq(i)).trigger("mouseenter"),t=o.$results.offset().top+o.$results.outerHeight(!1),n=e.offset().top+e.outerHeight(!1),e=o.$results.scrollTop()+n-t,0===i?o.$results.scrollTop(0):t<n&&o.$results.scrollTop(e))}),t.on("results:focus",function(e){e.element.addClass("select2-results__option--highlighted")}),t.on("results:message",function(e){o.displayMessage(e)}),d.fn.mousewheel&&this.$results.on("mousewheel",function(e){var t=o.$results.scrollTop(),n=o.$results.get(0).scrollHeight-t+e.deltaY,t=0<e.deltaY&&t-e.deltaY<=0,n=e.deltaY<0&&n<=o.$results.height();t?(o.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):n&&(o.$results.scrollTop(o.$results.get(0).scrollHeight-o.$results.height()),e.preventDefault(),e.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(e){var t=d(this),n=t.data("data");return"true"===t.attr("aria-selected")?void(o.options.get("multiple")?o.trigger("unselect",{originalEvent:e,data:n}):o.trigger("close",{})):void o.trigger("select",{originalEvent:e,data:n})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(e){var t=d(this).data("data");o.getHighlightedResults().removeClass("select2-results__option--highlighted"),o.trigger("results:focus",{data:t,element:d(this)})})},i.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},i.prototype.destroy=function(){this.$results.remove()},i.prototype.ensureHighlightVisible=function(){var e,t,n,i,o=this.getHighlightedResults();0!==o.length&&(e=this.$results.find("[aria-selected]").index(o),i=this.$results.offset().top,t=o.offset().top,n=this.$results.scrollTop()+(t-i),i=t-i,n-=2*o.outerHeight(!1),e<=2?this.$results.scrollTop(0):(i>this.$results.outerHeight()||i<0)&&this.$results.scrollTop(n))},i.prototype.template=function(e,t){var n=this.options.get("templateResult"),i=this.options.get("escapeMarkup"),e=n(e,t);null==e?t.style.display="none":"string"==typeof e?t.innerHTML=i(e):d(t).append(e)},i}),e.define("select2/keys",[],function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}}),e.define("select2/selection/base",["jquery","../utils","../keys"],function(n,e,o){function i(e,t){this.$element=e,this.options=t,i.__super__.constructor.call(this)}return e.Extend(i,e.Observable),i.prototype.render=function(){var e=n('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),e.attr("title",this.$element.attr("title")),e.attr("tabindex",this._tabindex),this.$selection=e},i.prototype.bind=function(e,t){var n=this,i=(e.id,e.id+"-results");this.container=e,this.$selection.on("focus",function(e){n.trigger("focus",e)}),this.$selection.on("blur",function(e){n._handleBlur(e)}),this.$selection.on("keydown",function(e){n.trigger("keypress",e),e.which===o.SPACE&&e.preventDefault()}),e.on("results:focus",function(e){n.$selection.attr("aria-activedescendant",e.data._resultId)}),e.on("selection:update",function(e){n.update(e.data)}),e.on("open",function(){n.$selection.attr("aria-expanded","true"),n.$selection.attr("aria-owns",i),n._attachCloseHandler(e)}),e.on("close",function(){n.$selection.attr("aria-expanded","false"),n.$selection.removeAttr("aria-activedescendant"),n.$selection.removeAttr("aria-owns"),n.$selection.focus(),n._detachCloseHandler(e)}),e.on("enable",function(){n.$selection.attr("tabindex",n._tabindex)}),e.on("disable",function(){n.$selection.attr("tabindex","-1")})},i.prototype._handleBlur=function(e){var t=this;window.setTimeout(function(){document.activeElement==t.$selection[0]||n.contains(t.$selection[0],document.activeElement)||t.trigger("blur",e)},1)},i.prototype._attachCloseHandler=function(e){n(document.body).on("mousedown.select2."+e.id,function(e){var t=n(e.target).closest(".select2");n(".select2.select2-container--open").each(function(){var e=n(this);this!=t[0]&&e.data("element").mselect2("close")})})},i.prototype._detachCloseHandler=function(e){n(document.body).off("mousedown.select2."+e.id)},i.prototype.position=function(e,t){t.find(".selection").append(e)},i.prototype.destroy=function(){this._detachCloseHandler(this.container)},i.prototype.update=function(e){throw new Error("The `update` method must be defined in child classes.")},i}),e.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,t,n,i){function o(){o.__super__.constructor.apply(this,arguments)}return n.Extend(o,t),o.prototype.render=function(){var e=o.__super__.render.call(this);return e.addClass("select2-selection--single"),e.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),e},o.prototype.bind=function(t,e){var n=this;o.__super__.bind.apply(this,arguments);var i=t.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",i),this.$selection.attr("aria-labelledby",i),this.$selection.on("mousedown",function(e){1===e.which&&n.trigger("toggle",{originalEvent:e})}),this.$selection.on("focus",function(e){}),this.$selection.on("blur",function(e){}),t.on("focus",function(e){t.isOpen()||n.$selection.focus()}),t.on("selection:update",function(e){n.update(e.data)})},o.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},o.prototype.display=function(e,t){var n=this.options.get("templateSelection");return this.options.get("escapeMarkup")(n(e,t))},o.prototype.selectionContainer=function(){return e("<span></span>")},o.prototype.update=function(e){var t,n;0!==e.length?(t=e[0],n=this.$selection.find(".select2-selection__rendered"),e=this.display(t,n),n.empty().append(e),n.prop("title",t.title||t.text)):this.clear()},o}),e.define("select2/selection/multiple",["jquery","./base","../utils"],function(i,e,a){function o(e,t){o.__super__.constructor.apply(this,arguments)}return a.Extend(o,e),o.prototype.render=function(){var e=o.__super__.render.call(this);return e.addClass("select2-selection--multiple"),e.html('<ul class="select2-selection__rendered"></ul>'),e},o.prototype.bind=function(e,t){var n=this;o.__super__.bind.apply(this,arguments),this.$selection.on("click",function(e){n.trigger("toggle",{originalEvent:e})}),this.$selection.on("click",".select2-selection__choice__remove",function(e){var t;n.options.get("disabled")||(t=i(this).parent().data("data"),n.trigger("unselect",{originalEvent:e,data:t}))})},o.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},o.prototype.display=function(e,t){var n=this.options.get("templateSelection");return this.options.get("escapeMarkup")(n(e,t))},o.prototype.selectionContainer=function(){return i('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>')},o.prototype.update=function(e){if(this.clear(),0!==e.length){for(var t=[],n=0;n<e.length;n++){var i=e[n],o=this.selectionContainer(),s=this.display(i,o);o.append(s),o.prop("title",i.title||i.text),o.data("data",i),t.push(o)}var r=this.$selection.find(".select2-selection__rendered");a.appendMany(r,t)}},o}),e.define("select2/selection/placeholder",["../utils"],function(e){function t(e,t,n){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n)}return t.prototype.normalizePlaceholder=function(e,t){return t="string"==typeof t?{id:"",text:t}:t},t.prototype.createPlaceholder=function(e,t){var n=this.selectionContainer();return n.html(this.display(t)),n.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),n},t.prototype.update=function(e,t){var n=1==t.length&&t[0].id!=this.placeholder.id;if(1<t.length||n)return e.call(this,t);this.clear();t=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(t)},t}),e.define("select2/selection/allowClear",["jquery","../keys"],function(n,i){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(e){i._handleClear(e)}),t.on("keypress",function(e){i._handleKeyboardClear(e,t)})},e.prototype._handleClear=function(e,t){if(!this.options.get("disabled")){var n=this.$selection.find(".select2-selection__clear");if(0!==n.length){t.stopPropagation();for(var i=n.data("data"),o=0;o<i.length;o++){var s={data:i[o]};if(this.trigger("unselect",s),s.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle",{})}}},e.prototype._handleKeyboardClear=function(e,t,n){n.isOpen()||t.which!=i.DELETE&&t.which!=i.BACKSPACE||this._handleClear(t)},e.prototype.update=function(e,t){e.call(this,t),0<this.$selection.find(".select2-selection__placeholder").length||0===t.length||((e=n('<span class="select2-selection__clear">&times;</span>')).data("data",t),this.$selection.find(".select2-selection__rendered").prepend(e))},e}),e.define("select2/selection/search",["jquery","../utils","../keys"],function(n,e,s){function t(e,t,n){e.call(this,t,n)}return t.prototype.render=function(e){var t=n('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" aria-autocomplete="list" /></li>');this.$searchContainer=t,this.$search=t.find("input");e=e.call(this);return this._transferTabIndex(),e},t.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("open",function(){i.$search.trigger("focus")}),t.on("close",function(){i.$search.val(""),i.$search.removeAttr("aria-activedescendant"),i.$search.trigger("focus")}),t.on("enable",function(){i.$search.prop("disabled",!1),i._transferTabIndex()}),t.on("disable",function(){i.$search.prop("disabled",!0)}),t.on("focus",function(e){i.$search.trigger("focus")}),t.on("results:focus",function(e){i.$search.attr("aria-activedescendant",e.id)}),this.$selection.on("focusin",".select2-search--inline",function(e){i.trigger("focus",e)}),this.$selection.on("focusout",".select2-search--inline",function(e){i._handleBlur(e)}),this.$selection.on("keydown",".select2-search--inline",function(e){var t;e.stopPropagation(),i.trigger("keypress",e),i._keyUpPrevented=e.isDefaultPrevented(),e.which!==s.BACKSPACE||""!==i.$search.val()||0<(t=i.$searchContainer.prev(".select2-selection__choice")).length&&(t=t.data("data"),i.searchRemoveChoice(t),e.preventDefault())});var t=document.documentMode,o=t&&t<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(e){return o?void i.$selection.off("input.search input.searchcheck"):void i.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(e){var t;o&&"input"===e.type?i.$selection.off("input.search input.searchcheck"):(t=e.which)!=s.SHIFT&&t!=s.CTRL&&t!=s.ALT&&t!=s.TAB&&i.handleSearch(e)})},t.prototype._transferTabIndex=function(e){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},t.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)},t.prototype.update=function(e,t){var n=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),e.call(this,t),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),n&&this.$search.focus()},t.prototype.handleSearch=function(){var e;this.resizeSearch(),this._keyUpPrevented||(e=this.$search.val(),this.trigger("query",{term:e})),this._keyUpPrevented=!1},t.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t}),this.$search.val(t.text),this.handleSearch()},t.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="";e=""!==this.$search.attr("placeholder")?this.$selection.find(".select2-selection__rendered").innerWidth():.75*(this.$search.val().length+1)+"em",this.$search.css("width",e)},t}),e.define("select2/selection/eventRelay",["jquery"],function(r){function e(){}return e.prototype.bind=function(e,t,n){var i=this,o=["open","opening","close","closing","select","selecting","unselect","unselecting"],s=["opening","closing","selecting","unselecting"];e.call(this,t,n),t.on("*",function(e,t){var n;-1!==r.inArray(e,o)&&(t=t||{},n=r.Event("select2:"+e,{params:t}),i.$element.trigger(n),-1!==r.inArray(e,s)&&(t.prevented=n.isDefaultPrevented()))})},e}),e.define("select2/translation",["jquery","require"],function(t,n){function i(e){this.dict=e||{}}return i.prototype.all=function(){return this.dict},i.prototype.get=function(e){return this.dict[e]},i.prototype.extend=function(e){this.dict=t.extend({},e.all(),this.dict)},i._cache={},i.loadPath=function(e){var t;return e in i._cache||(t=n(e),i._cache[e]=t),new i(i._cache[e])},i}),e.define("select2/diacritics",[],function(){return{"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"}}),e.define("select2/data/base",["../utils"],function(n){function i(e,t){i.__super__.constructor.call(this)}return n.Extend(i,n.Observable),i.prototype.current=function(e){throw new Error("The `current` method must be defined in child classes.")},i.prototype.query=function(e,t){throw new Error("The `query` method must be defined in child classes.")},i.prototype.bind=function(e,t){},i.prototype.destroy=function(){},i.prototype.generateResultId=function(e,t){e=e.id+"-result-";return(e+=n.generateChars(4))+(null!=t.id?"-"+t.id.toString():"-"+n.generateChars(4))},i}),e.define("select2/data/select",["./base","../utils","jquery"],function(e,t,r){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,e),n.prototype.current=function(e){var t=[],n=this;this.$element.find(":selected").each(function(){var e=r(this),e=n.item(e);t.push(e)}),e(t)},n.prototype.select=function(o){var e,s=this;if(o.selected=!0,r(o.element).is("option"))return o.element.selected=!0,void this.$element.trigger("change");this.$element.prop("multiple")?this.current(function(e){var t=[];(o=[o]).push.apply(o,e);for(var n=0;n<o.length;n++){var i=o[n].id;-1===r.inArray(i,t)&&t.push(i)}s.$element.val(t),s.$element.trigger("change")}):(e=o.id,this.$element.val(e),this.$element.trigger("change"))},n.prototype.unselect=function(o){var s=this;if(this.$element.prop("multiple"))return o.selected=!1,r(o.element).is("option")?(o.element.selected=!1,void this.$element.trigger("change")):void this.current(function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n].id;i!==o.id&&-1===r.inArray(i,t)&&t.push(i)}s.$element.val(t),s.$element.trigger("change")})},n.prototype.bind=function(e,t){var n=this;(this.container=e).on("select",function(e){n.select(e.data)}),e.on("unselect",function(e){n.unselect(e.data)})},n.prototype.destroy=function(){this.$element.find("*").each(function(){r.removeData(this,"data")})},n.prototype.query=function(t,e){var n=[],i=this;this.$element.children().each(function(){var e=r(this);(e.is("option")||e.is("optgroup"))&&(e=i.item(e),null!==(e=i.matches(t,e))&&n.push(e))}),e({results:n})},n.prototype.addOptions=function(e){t.appendMany(this.$element,e)},n.prototype.option=function(e){var t;e.children?(t=document.createElement("optgroup")).label=e.text:void 0!==(t=document.createElement("option")).textContent?t.textContent=e.text:t.innerText=e.text,e.id&&(t.value=e.id),e.disabled&&(t.disabled=!0),e.selected&&(t.selected=!0),e.title&&(t.title=e.title);var n=r(t),e=this._normalizeItem(e);return e.element=t,r.data(t,"data",e),n},n.prototype.item=function(e){var t={};if(null!=(t=r.data(e[0],"data")))return t;if(e.is("option"))t={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")};else if(e.is("optgroup")){for(var t={text:e.prop("label"),children:[],title:e.prop("title")},n=e.children("option"),i=[],o=0;o<n.length;o++){var s=r(n[o]),s=this.item(s);i.push(s)}t.children=i}return(t=this._normalizeItem(t)).element=e[0],r.data(e[0],"data",t),t},n.prototype._normalizeItem=function(e){r.isPlainObject(e)||(e={id:e,text:e});return null!=(e=r.extend({},{text:""},e)).id&&(e.id=e.id.toString()),null!=e.text&&(e.text=e.text.toString()),null==e._resultId&&e.id&&null!=this.container&&(e._resultId=this.generateResultId(this.container,e)),r.extend({},{selected:!1,disabled:!1},e)},n.prototype.matches=function(e,t){return this.options.get("matcher")(e,t)},n}),e.define("select2/data/array",["./select","../utils","jquery"],function(e,c,u){function i(e,t){var n=t.get("data")||[];i.__super__.constructor.call(this,e,t),this.addOptions(this.convertToOptions(n))}return c.Extend(i,e),i.prototype.select=function(n){var e=this.$element.find("option").filter(function(e,t){return t.value==n.id.toString()});0===e.length&&(e=this.option(n),this.addOptions(e)),i.__super__.select.call(this,n)},i.prototype.convertToOptions=function(e){for(var t=this,n=this.$element.find("option"),i=n.map(function(){return t.item(u(this)).id}).get(),o=[],s=0;s<e.length;s++){var r,a,l=this._normalizeItem(e[s]);0<=u.inArray(l.id,i)?(r=n.filter(function(e){return function(){return u(this).val()==e.id}}(l)),a=this.item(r),a=u.extend(!0,{},l,a),a=this.option(a),r.replaceWith(a)):(a=this.option(l),l.children&&(l=this.convertToOptions(l.children),c.appendMany(a,l)),o.push(a))}return o},i}),e.define("select2/data/ajax",["./array","../utils","jquery"],function(e,t,s){function n(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),n.__super__.constructor.call(this,e,t)}return t.Extend(n,e),n.prototype._applyDefaults=function(e){var t={data:function(e){return s.extend({},e,{q:e.term})},transport:function(e,t,n){e=s.ajax(e);return e.then(t),e.fail(n),e}};return s.extend({},t,e,!0)},n.prototype.processResults=function(e){return e},n.prototype.query=function(t,n){function e(){var e=o.transport(o,function(e){e=i.processResults(e,t);i.options.get("debug")&&window.console&&console.error&&(e&&e.results&&s.isArray(e.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),n(e)},function(){e.status&&"0"===e.status||i.trigger("results:message",{message:"errorLoading"})});i._request=e}var i=this;null!=this._request&&(s.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var o=s.extend({type:"GET"},this.ajaxOptions);"function"==typeof o.url&&(o.url=o.url.call(this.$element,t)),"function"==typeof o.data&&(o.data=o.data.call(this.$element,t)),this.ajaxOptions.delay&&null!=t.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(e,this.ajaxOptions.delay)):e()},n}),e.define("select2/data/tags",["jquery"],function(a){function e(e,t,n){var i=n.get("tags"),o=n.get("createTag");void 0!==o&&(this.createTag=o);o=n.get("insertTag");if(void 0!==o&&(this.insertTag=o),e.call(this,t,n),a.isArray(i))for(var s=0;s<i.length;s++){var r=i[s],r=this._normalizeItem(r),r=this.option(r);this.$element.append(r)}}return e.prototype.query=function(e,c,u){var d=this;return this._removeOldTags(),null==c.term||null!=c.page?void e.call(this,c,u):void e.call(this,c,function e(t,n){for(var i=t.results,o=0;o<i.length;o++){var s=i[o],r=null!=s.children&&!e({results:s.children},!0);if(s.text===c.term||r)return!n&&(t.data=i,void u(t))}if(n)return!0;var a,l=d.createTag(c);null!=l&&((a=d.option(l)).attr("data-select2-tag",!0),d.addOptions([a]),d.insertTag(i,l)),t.results=i,u(t)})},e.prototype.createTag=function(e,t){t=a.trim(t.term);return""===t?null:{id:t,text:t}},e.prototype.insertTag=function(e,t,n){t.unshift(n)},e.prototype._removeOldTags=function(e){(this._lastTag,this.$element.find("option[data-select2-tag]")).each(function(){this.selected||a(this).remove()})},e}),e.define("select2/data/tokenizer",["jquery"],function(c){function e(e,t,n){var i=n.get("tokenizer");void 0!==i&&(this.tokenizer=i),e.call(this,t,n)}return e.prototype.bind=function(e,t,n){e.call(this,t,n),this.$search=t.dropdown.$search||t.selection.$search||n.find(".select2-search__field")},e.prototype.query=function(e,t,n){var i=this;t.term=t.term||"";var o=this.tokenizer(t,this.options,function(e){var t,n=i._normalizeItem(e);i.$element.find("option").filter(function(){return c(this).val()===n.id}).length||((t=i.option(n)).attr("data-select2-tag",!0),i._removeOldTags(),i.addOptions([t])),t=n,i.trigger("select",{data:t})});o.term!==t.term&&(this.$search.length&&(this.$search.val(o.term),this.$search.focus()),t.term=o.term),e.call(this,t,n)},e.prototype.tokenizer=function(e,t,n,i){for(var o=n.get("tokenSeparators")||[],s=t.term,r=0,a=this.createTag||function(e){return{id:e.term,text:e.term}};r<s.length;){var l=s[r];-1!==c.inArray(l,o)?(l=s.substr(0,r),null!=(l=a(c.extend({},t,{term:l})))?(i(l),s=s.substr(r+1)||"",r=0):r++):r++}return{term:s}},e}),e.define("select2/data/minimumInputLength",[],function(){function e(e,t,n){this.minimumInputLength=n.get("minimumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){return t.term=t.term||"",t.term.length<this.minimumInputLength?void this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}}):void e.call(this,t,n)},e}),e.define("select2/data/maximumInputLength",[],function(){function e(e,t,n){this.maximumInputLength=n.get("maximumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){return t.term=t.term||"",0<this.maximumInputLength&&t.term.length>this.maximumInputLength?void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}}):void e.call(this,t,n)},e}),e.define("select2/data/maximumSelectionLength",[],function(){function e(e,t,n){this.maximumSelectionLength=n.get("maximumSelectionLength"),e.call(this,t,n)}return e.prototype.query=function(t,n,i){var o=this;this.current(function(e){e=null!=e?e.length:0;return 0<o.maximumSelectionLength&&e>=o.maximumSelectionLength?void o.trigger("results:message",{message:"maximumSelected",args:{maximum:o.maximumSelectionLength}}):void t.call(o,n,i)})},e}),e.define("select2/dropdown",["jquery","./utils"],function(t,e){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return e.Extend(n,e.Observable),n.prototype.render=function(){var e=t('<span class="select2-dropdown"><span class="select2-results"></span></span>');return e.attr("dir",this.options.get("dir")),this.$dropdown=e},n.prototype.bind=function(){},n.prototype.position=function(e,t){},n.prototype.destroy=function(){this.$dropdown.remove()},n}),e.define("select2/dropdown/search",["jquery","../utils"],function(o,e){function t(){}return t.prototype.render=function(e){var t=e.call(this),e=o('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=e,this.$search=e.find("input"),t.prepend(e),t},t.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),this.$search.on("keydown",function(e){i.trigger("keypress",e),i._keyUpPrevented=e.isDefaultPrevented()}),this.$search.on("input",function(e){o(this).off("keyup")}),this.$search.on("keyup input",function(e){i.handleSearch(e)}),t.on("open",function(){i.$search.attr("tabindex",0),i.$search.focus(),window.setTimeout(function(){i.$search.focus()},0)}),t.on("close",function(){i.$search.attr("tabindex",-1),i.$search.val("")}),t.on("focus",function(){t.isOpen()&&i.$search.focus()}),t.on("results:all",function(e){null!=e.query.term&&""!==e.query.term||(i.showSearch(e)?i.$searchContainer.removeClass("select2-search--hide"):i.$searchContainer.addClass("select2-search--hide"))})},t.prototype.handleSearch=function(e){var t;this._keyUpPrevented||(t=this.$search.val(),this.trigger("query",{term:t})),this._keyUpPrevented=!1},t.prototype.showSearch=function(e,t){return!0},t}),e.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,t,n,i){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n,i)}return e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results),e.call(this,t)},e.prototype.normalizePlaceholder=function(e,t){return t="string"==typeof t?{id:"",text:t}:t},e.prototype.removePlaceholder=function(e,t){for(var n=t.slice(0),i=t.length-1;0<=i;i--){var o=t[i];this.placeholder.id===o.id&&n.splice(i,1)}return n},e}),e.define("select2/dropdown/infiniteScroll",["jquery"],function(o){function e(e,t,n,i){this.lastParams={},e.call(this,t,n,i),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return e.prototype.append=function(e,t){this.$loadingMore.remove(),this.loading=!1,e.call(this,t),this.showLoadingMore(t)&&this.$results.append(this.$loadingMore)},e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("query",function(e){i.lastParams=e,i.loading=!0}),t.on("query:append",function(e){i.lastParams=e,i.loading=!0}),this.$results.on("scroll",function(){var e=o.contains(document.documentElement,i.$loadingMore[0]);!i.loading&&e&&(e=i.$results.offset().top+i.$results.outerHeight(!1),i.$loadingMore.offset().top+i.$loadingMore.outerHeight(!1)<=e+50&&i.loadMore())})},e.prototype.loadMore=function(){this.loading=!0;var e=o.extend({},{page:1},this.lastParams);e.page++,this.trigger("query:append",e)},e.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more},e.prototype.createLoadingMore=function(){var e=o('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"></li>'),t=this.options.get("translations").get("loadingMore");return e.html(t(this.lastParams)),e},e}),e.define("select2/dropdown/attachBody",["jquery","../utils"],function(c,r){function e(e,t,n){this.$dropdownParent=n.get("dropdownParent")||c(document.body),e.call(this,t,n)}return e.prototype.bind=function(e,t,n){var i=this,o=!1;e.call(this,t,n),t.on("open",function(){i._showDropdown(),i._attachPositioningHandler(t),o||(o=!0,t.on("results:all",function(){i._positionDropdown(),i._resizeDropdown()}),t.on("results:append",function(){i._positionDropdown(),i._resizeDropdown()}))}),t.on("close",function(){i._hideDropdown(),i._detachPositioningHandler(t)}),this.$dropdownContainer.on("mousedown",function(e){e.stopPropagation()})},e.prototype.destroy=function(e){e.call(this),this.$dropdownContainer.remove()},e.prototype.position=function(e,t,n){t.attr("class",n.attr("class")),t.removeClass("select2"),t.addClass("select2-container--open"),t.css({position:"absolute",top:-999999}),this.$container=n},e.prototype.render=function(e){var t=c("<span></span>"),e=e.call(this);return t.append(e),this.$dropdownContainer=t},e.prototype._hideDropdown=function(e){this.$dropdownContainer.detach()},e.prototype._attachPositioningHandler=function(e,t){var n=this,i="scroll.select2."+t.id,o="resize.select2."+t.id,s="orientationchange.select2."+t.id,t=this.$container.parents().filter(r.hasScroll);t.each(function(){c(this).data("select2-scroll-position",{x:c(this).scrollLeft(),y:c(this).scrollTop()})}),t.on(i,function(e){var t=c(this).data("select2-scroll-position");c(this).scrollTop(t.y)}),c(window).on(i+" "+o+" "+s,function(e){n._positionDropdown(),n._resizeDropdown()})},e.prototype._detachPositioningHandler=function(e,t){var n="scroll.select2."+t.id,i="resize.select2."+t.id,t="orientationchange.select2."+t.id;this.$container.parents().filter(r.hasScroll).off(n),c(window).off(n+" "+i+" "+t)},e.prototype._positionDropdown=function(){var e=c(window),t=this.$dropdown.hasClass("select2-dropdown--above"),n=this.$dropdown.hasClass("select2-dropdown--below"),i=null,o=this.$container.offset();o.bottom=o.top+this.$container.outerHeight(!1);var s={height:this.$container.outerHeight(!1)};s.top=o.top,s.bottom=o.top+s.height;var r=this.$dropdown.outerHeight(!1),a=e.scrollTop(),l=e.scrollTop()+e.height(),e=a<o.top-r,a=l>o.bottom+r,l={left:o.left,top:s.bottom},o=this.$dropdownParent,o=(o="static"===o.css("position")?o.offsetParent():o).offset();l.top-=o.top,l.left-=o.left,t||n||(i="below"),a||!e||t?!e&&a&&t&&(i="below"):i="above",("above"==i||t&&"below"!==i)&&(l.top=s.top-o.top-r),null!=i&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+i),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+i)),this.$dropdownContainer.css(l)},e.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.position="relative",e.width="auto"),this.$dropdown.css(e)},e.prototype._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},e}),e.define("select2/dropdown/minimumResultsForSearch",[],function(){function e(e,t,n,i){this.minimumResultsForSearch=n.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),e.call(this,t,n,i)}return e.prototype.showSearch=function(e,t){return!(function e(t){for(var n=0,i=0;i<t.length;i++){var o=t[i];o.children?n+=e(o.children):n++}return n}(t.data.results)<this.minimumResultsForSearch)&&e.call(this,t)},e}),e.define("select2/dropdown/selectOnClose",[],function(){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("close",function(e){i._handleSelectOnClose(e)})},e.prototype._handleSelectOnClose=function(e,t){if(t&&null!=t.originalSelect2Event){var n=t.originalSelect2Event;if("select"===n._type||"unselect"===n._type)return}n=this.getHighlightedResults();n.length<1||(null!=(n=n.data("data")).element&&n.element.selected||null==n.element&&n.selected||this.trigger("select",{data:n}))},e}),e.define("select2/dropdown/closeOnSelect",[],function(){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("select",function(e){i._selectTriggered(e)}),t.on("unselect",function(e){i._selectTriggered(e)})},e.prototype._selectTriggered=function(e,t){var n=t.originalEvent;n&&n.ctrlKey||this.trigger("close",{originalEvent:n,originalSelect2Event:t})},e}),e.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum,e="Please delete "+t+" character";return 1!=t&&(e+="s"),e},inputTooShort:function(e){return"Please enter "+(e.minimum-e.input.length)+" or more characters"},loadingMore:function(){return"Loading more results…"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";return 1!=e.maximum&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching…"}}}),e.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(u,d,p,h,f,g,m,v,y,_,w,t,$,b,x,A,C,S,O,E,D,T,q,j,L,k,P,I,e){function n(){this.reset()}return n.prototype.apply=function(t){var e,n;if(null==(t=u.extend(!0,{},this.defaults,t)).dataAdapter&&(null!=t.ajax?t.dataAdapter=x:null!=t.data?t.dataAdapter=b:t.dataAdapter=$,0<t.minimumInputLength&&(t.dataAdapter=_.Decorate(t.dataAdapter,S)),0<t.maximumInputLength&&(t.dataAdapter=_.Decorate(t.dataAdapter,O)),0<t.maximumSelectionLength&&(t.dataAdapter=_.Decorate(t.dataAdapter,E)),t.tags&&(t.dataAdapter=_.Decorate(t.dataAdapter,A)),null==t.tokenSeparators&&null==t.tokenizer||(t.dataAdapter=_.Decorate(t.dataAdapter,C)),null!=t.query&&(e=d(t.amdBase+"compat/query"),t.dataAdapter=_.Decorate(t.dataAdapter,e)),null!=t.initSelection&&(e=d(t.amdBase+"compat/initSelection"),t.dataAdapter=_.Decorate(t.dataAdapter,e))),null==t.resultsAdapter&&(t.resultsAdapter=p,null!=t.ajax&&(t.resultsAdapter=_.Decorate(t.resultsAdapter,j)),null!=t.placeholder&&(t.resultsAdapter=_.Decorate(t.resultsAdapter,q)),t.selectOnClose&&(t.resultsAdapter=_.Decorate(t.resultsAdapter,P))),null==t.dropdownAdapter&&(t.multiple?t.dropdownAdapter=D:(n=_.Decorate(D,T),t.dropdownAdapter=n),0!==t.minimumResultsForSearch&&(t.dropdownAdapter=_.Decorate(t.dropdownAdapter,k)),t.closeOnSelect&&(t.dropdownAdapter=_.Decorate(t.dropdownAdapter,I)),null==t.dropdownCssClass&&null==t.dropdownCss&&null==t.adaptDropdownCssClass||(n=d(t.amdBase+"compat/dropdownCss"),t.dropdownAdapter=_.Decorate(t.dropdownAdapter,n)),t.dropdownAdapter=_.Decorate(t.dropdownAdapter,L)),null==t.selectionAdapter&&(t.multiple?t.selectionAdapter=f:t.selectionAdapter=h,null!=t.placeholder&&(t.selectionAdapter=_.Decorate(t.selectionAdapter,g)),t.allowClear&&(t.selectionAdapter=_.Decorate(t.selectionAdapter,m)),t.multiple&&(t.selectionAdapter=_.Decorate(t.selectionAdapter,v)),null==t.containerCssClass&&null==t.containerCss&&null==t.adaptContainerCssClass||(l=d(t.amdBase+"compat/containerCss"),t.selectionAdapter=_.Decorate(t.selectionAdapter,l)),t.selectionAdapter=_.Decorate(t.selectionAdapter,y)),"string"==typeof t.language&&(0<t.language.indexOf("-")?(c=t.language.split("-")[0],t.language=[t.language,c]):t.language=[t.language]),u.isArray(t.language)){var i=new w;t.language.push("en");for(var o=t.language,s=0;s<o.length;s++){var r=o[s],a={};try{a=w.loadPath(r)}catch(e){try{r=this.defaults.amdLanguageBase+r,a=w.loadPath(r)}catch(e){t.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+r+'" could not be automatically loaded. A fallback will be used instead.');continue}}i.extend(a)}t.translations=i}else{var l=w.loadPath(this.defaults.amdLanguageBase+"en"),c=new w(t.language);c.extend(l),t.translations=c}return t},n.prototype.reset=function(){function a(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return t[e]||e})}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:_.escapeMarkup,language:e,matcher:function e(t,n){if(""===u.trim(t.term))return n;if(n.children&&0<n.children.length){for(var i=u.extend(!0,{},n),o=n.children.length-1;0<=o;o--)null==e(t,n.children[o])&&i.children.splice(o,1);return 0<i.children.length?i:e(t,i)}var s=a(n.text).toUpperCase(),r=a(t.term).toUpperCase();return-1<s.indexOf(r)?n:null},minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}},n.prototype.set=function(e,t){var n={};n[u.camelCase(e)]=t;n=_._convertData(n);u.extend(this.defaults,n)},new n}),e.define("select2/options",["require","jquery","./defaults","./utils"],function(n,s,i,r){function e(e,t){this.options=e,null!=t&&this.fromElement(t),this.options=i.apply(this.options),t&&t.is("input")&&(t=n(this.get("amdBase")+"compat/inputData"),this.options.dataAdapter=r.Decorate(this.options.dataAdapter,t))}return e.prototype.fromElement=function(e){var t=["select2"];null==this.options.multiple&&(this.options.multiple=e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=e.prop("disabled")),null==this.options.language&&(e.prop("lang")?this.options.language=e.prop("lang").toLowerCase():e.closest("[lang]").prop("lang")&&(this.options.language=e.closest("[lang]").prop("lang"))),null==this.options.dir&&(e.prop("dir")?this.options.dir=e.prop("dir"):e.closest("[dir]").prop("dir")?this.options.dir=e.closest("[dir]").prop("dir"):this.options.dir="ltr"),e.prop("disabled",this.options.disabled),e.prop("multiple",this.options.multiple),e.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),e.data("data",e.data("select2Tags")),e.data("tags",!0)),e.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),e.attr("ajax--url",e.data("ajaxUrl")),e.data("ajax--url",e.data("ajaxUrl")));var n,i=s.fn.jquery&&"1."==s.fn.jquery.substr(0,2)&&e[0].dataset?s.extend(!0,{},e[0].dataset,e.data()):e.data(),o=s.extend(!0,{},i);for(n in o=r._convertData(o))-1<s.inArray(n,t)||(s.isPlainObject(this.options[n])?s.extend(this.options[n],o[n]):this.options[n]=o[n]);return this},e.prototype.get=function(e){return this.options[e]},e.prototype.set=function(e,t){this.options[e]=t},e}),e.define("select2/core",["jquery","./options","./utils","./keys"],function(o,s,n,i){var r=function(e,t){null!=e.data("select2")&&e.data("select2").destroy(),this.$element=e,this.id=this._generateId(e),t=t||{},this.options=new s(t,e),r.__super__.constructor.call(this);var n=e.attr("tabindex")||0;e.data("old-tabindex",n),e.attr("tabindex","-1");t=this.options.get("dataAdapter");this.dataAdapter=new t(e,this.options);n=this.render();this._placeContainer(n);t=this.options.get("selectionAdapter");this.selection=new t(e,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,n);t=this.options.get("dropdownAdapter");this.dropdown=new t(e,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,n);n=this.options.get("resultsAdapter");this.results=new n(e,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var i=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(e){i.trigger("selection:update",{data:e})}),e.addClass("select2-hidden-accessible"),e.attr("aria-hidden","true"),this._syncAttributes(),e.data("select2",this)};return n.Extend(r,n.Observable),r.prototype._generateId=function(e){return"select2-"+(null!=e.attr("id")?e.attr("id"):null!=e.attr("name")?e.attr("name")+"-"+n.generateChars(2):n.generateChars(4)).replace(/(:|\.|\[|\]|,)/g,"")},r.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));null!=t&&e.css("width",t)},r.prototype._resolveWidth=function(e,t){var n=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==t){var i=this._resolveWidth(e,"style");return null!=i?i:this._resolveWidth(e,"element")}if("element"==t){i=e.outerWidth(!1);return i<=0?"auto":i+"px"}if("style"!=t)return t;e=e.attr("style");if("string"!=typeof e)return null;for(var o=e.split(";"),s=0,r=o.length;s<r;s+=1){var a=o[s].replace(/\s/g,"").match(n);if(null!==a&&1<=a.length)return a[1]}return null},r.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},r.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",function(){t.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})}),this.$element.on("focus.select2",function(e){t.trigger("focus",e)}),this._syncA=n.bind(this._syncAttributes,this),this._syncS=n.bind(this._syncSubtree,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._syncA);var e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=e?(this._observer=new e(function(e){o.each(e,t._syncA),o.each(e,t._syncS)}),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&(this.$element[0].addEventListener("DOMAttrModified",t._syncA,!1),this.$element[0].addEventListener("DOMNodeInserted",t._syncS,!1),this.$element[0].addEventListener("DOMNodeRemoved",t._syncS,!1))},r.prototype._registerDataEvents=function(){var n=this;this.dataAdapter.on("*",function(e,t){n.trigger(e,t)})},r.prototype._registerSelectionEvents=function(){var n=this,i=["toggle","focus"];this.selection.on("toggle",function(){n.toggleDropdown()}),this.selection.on("focus",function(e){n.focus(e)}),this.selection.on("*",function(e,t){-1===o.inArray(e,i)&&n.trigger(e,t)})},r.prototype._registerDropdownEvents=function(){var n=this;this.dropdown.on("*",function(e,t){n.trigger(e,t)})},r.prototype._registerResultsEvents=function(){var n=this;this.results.on("*",function(e,t){n.trigger(e,t)})},r.prototype._registerEvents=function(){var n=this;this.on("open",function(){n.$container.addClass("select2-container--open")}),this.on("close",function(){n.$container.removeClass("select2-container--open")}),this.on("enable",function(){n.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){n.$container.addClass("select2-container--disabled")}),this.on("blur",function(){n.$container.removeClass("select2-container--focus")}),this.on("query",function(t){n.isOpen()||n.trigger("open",{}),this.dataAdapter.query(t,function(e){n.trigger("results:all",{data:e,query:t})})}),this.on("query:append",function(t){this.dataAdapter.query(t,function(e){n.trigger("results:append",{data:e,query:t})})}),this.on("keypress",function(e){var t=e.which;t===i.ENTER&&(e.ctrlKey||e.metaKey)&&(n.close()||MapSVG.formBuilder.save()),t!==i.ESC||n.isOpen()||n.close()||MapSVG.formBuilder.close(),n.isOpen()?t===i.ESC||t===i.TAB||t===i.UP&&e.altKey?(n.close(),e.preventDefault()):t!==i.ENTER||e.ctrlKey||e.metaKey?t===i.SPACE&&e.ctrlKey?(n.trigger("results:toggle",{}),e.preventDefault()):t===i.UP?(n.trigger("results:previous",{}),e.preventDefault()):t===i.DOWN&&(n.trigger("results:next",{}),e.preventDefault()):(n.trigger("results:select",{}),e.preventDefault()):(t===(i.ENTER&&!e.ctrlKey&&!e.metaKey)||t===i.SPACE||t===i.DOWN&&e.altKey)&&(n.open(),e.preventDefault())})},r.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},r.prototype._syncSubtree=function(e,t){var n=!1,i=this;if(!e||!e.target||"OPTION"===e.target.nodeName||"OPTGROUP"===e.target.nodeName){if(t)if(t.addedNodes&&0<t.addedNodes.length)for(var o=0;o<t.addedNodes.length;o++)t.addedNodes[o].selected&&(n=!0);else t.removedNodes&&0<t.removedNodes.length&&(n=!0);else n=!0;n&&this.dataAdapter.current(function(e){i.trigger("selection:update",{data:e})})}},r.prototype.trigger=function(e,t){var n=r.__super__.trigger,i={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(void 0===t&&(t={}),e in i){var o=i[e],i={prevented:!1,name:e,args:t};if(n.call(this,o,i),i.prevented)return void(t.prevented=!0)}n.call(this,e,t)},r.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},r.prototype.open=function(){this.isOpen()||this.trigger("query",{})},r.prototype.close=function(){this.isOpen()&&this.trigger("close",{})},r.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},r.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},r.prototype.focus=function(e){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},r.prototype.enable=function(e){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.');e=!(e=null==e||0===e.length?[!0]:e)[0];this.$element.prop("disabled",e)},r.prototype.data=function(){this.options.get("debug")&&0<arguments.length&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var t=[];return this.dataAdapter.current(function(e){t=e}),t},r.prototype.val=function(e){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==e||0===e.length)return this.$element.val();e=e[0];o.isArray(e)&&(e=o.map(e,function(e){return e.toString()})),this.$element.val(e).trigger("change")},r.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._syncA),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener("DOMAttrModified",this._syncA,!1),this.$element[0].removeEventListener("DOMNodeInserted",this._syncS,!1),this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,!1)),this._syncA=null,this._syncS=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},r.prototype.render=function(){var e=o('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return e.attr("dir",this.options.get("dir")),this.$container=e,this.$container.addClass("select2-container--"+this.options.get("theme")),e.data("element",this.$element),e},r}),e.define("select2/compat/utils",["jquery"],function(r){return{syncCssClasses:function(e,t,n){var i,o=[],s=r.trim(e.attr("class"));s&&r((s=""+s).split(/\s+/)).each(function(){0===this.indexOf("select2-")&&o.push(this)}),(s=r.trim(t.attr("class")))&&r((s=""+s).split(/\s+/)).each(function(){0!==this.indexOf("select2-")&&(null!=(i=n(this))&&o.push(i))}),e.attr("class",o.join(" "))}}}),e.define("select2/compat/containerCss",["jquery","./utils"],function(s,r){function a(e){return null}function e(){}return e.prototype.render=function(e){var t=e.call(this),n=this.options.get("containerCssClass")||"";s.isFunction(n)&&(n=n(this.$element));var i,o=this.options.get("adaptContainerCssClass");o=o||a,-1!==n.indexOf(":all:")&&(n=n.replace(":all:",""),i=o,o=function(e){var t=i(e);return null!=t?t+" "+e:e});e=this.options.get("containerCss")||{};return s.isFunction(e)&&(e=e(this.$element)),r.syncCssClasses(t,this.$element,o),t.css(e),t.addClass(n),t},e}),e.define("select2/compat/dropdownCss",["jquery","./utils"],function(s,r){function a(e){return null}function e(){}return e.prototype.render=function(e){var t=e.call(this),n=this.options.get("dropdownCssClass")||"";s.isFunction(n)&&(n=n(this.$element));var i,o=this.options.get("adaptDropdownCssClass");o=o||a,-1!==n.indexOf(":all:")&&(n=n.replace(":all:",""),i=o,o=function(e){var t=i(e);return null!=t?t+" "+e:e});e=this.options.get("dropdownCss")||{};return s.isFunction(e)&&(e=e(this.$element)),r.syncCssClasses(t,this.$element,o),t.css(e),t.addClass(n),t},e}),e.define("select2/compat/initSelection",["jquery"],function(i){function e(e,t,n){n.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `initSelection` option has been deprecated in favor of a custom data adapter that overrides the `current` method. This method is now called multiple times instead of a single time when the instance is initialized. Support will be removed for the `initSelection` option in future versions of Select2"),this.initSelection=n.get("initSelection"),this._isInitialized=!1,e.call(this,t,n)}return e.prototype.current=function(e,t){var n=this;return this._isInitialized?void e.call(this,t):void this.initSelection.call(null,this.$element,function(e){n._isInitialized=!0,i.isArray(e)||(e=[e]),t(e)})},e}),e.define("select2/compat/inputData",["jquery"],function(s){function e(e,t,n){this._currentData=[],this._valueSeparator=n.get("valueSeparator")||",","hidden"===t.prop("type")&&n.get("debug")&&console&&console.warn&&console.warn("Select2: Using a hidden input with Select2 is no longer supported and may stop working in the future. It is recommended to use a `<select>` element instead."),e.call(this,t,n)}return e.prototype.current=function(e,t){for(var n=[],i=0;i<this._currentData.length;i++){var o=this._currentData[i];n.push.apply(n,function e(t,n){var i=[];return t.selected||-1!==s.inArray(t.id,n)?(t.selected=!0,i.push(t)):t.selected=!1,t.children&&i.push.apply(i,e(t.children,n)),i}(o,this.$element.val().split(this._valueSeparator)))}t(n)},e.prototype.select=function(e,t){var n;this.options.get("multiple")?(n=this.$element.val(),n+=this._valueSeparator+t.id,this.$element.val(n)):(this.current(function(e){s.map(e,function(e){e.selected=!1})}),this.$element.val(t.id)),this.$element.trigger("change")},e.prototype.unselect=function(e,o){var s=this;o.selected=!1,this.current(function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];o.id!=i.id&&t.push(i.id)}s.$element.val(t.join(s._valueSeparator)),s.$element.trigger("change")})},e.prototype.query=function(e,t,n){for(var i=[],o=0;o<this._currentData.length;o++){var s=this._currentData[o],s=this.matches(t,s);null!==s&&i.push(s)}n({results:i})},e.prototype.addOptions=function(e,t){t=s.map(t,function(e){return s.data(e[0],"data")});this._currentData.push.apply(this._currentData,t)},e}),e.define("select2/compat/matcher",["jquery"],function(r){return function(s){return function(e,t){var n=r.extend(!0,{},t);if(null==e.term||""===r.trim(e.term))return n;if(t.children){for(var i=t.children.length-1;0<=i;i--){var o=t.children[i];s(e.term,o.text,o)||n.children.splice(i,1)}if(0<n.children.length)return n}return s(e.term,t.text,t)?n:null}}}),e.define("select2/compat/query",[],function(){function e(e,t,n){n.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `query` option has been deprecated in favor of a custom data adapter that overrides the `query` method. Support will be removed for the `query` option in future versions of Select2."),e.call(this,t,n)}return e.prototype.query=function(e,t,n){t.callback=n,this.options.get("query").call(null,t)},e}),e.define("select2/dropdown/attachContainer",[],function(){function e(e,t,n){e.call(this,t,n)}return e.prototype.position=function(e,t,n){n.find(".dropdown-wrapper").append(t),t.addClass("select2-dropdown--below"),n.addClass("select2-container--below")},e}),e.define("select2/dropdown/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,t,n){e.call(this,t,n);this.$dropdown.on(["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"].join(" "),function(e){e.stopPropagation()})},e}),e.define("select2/selection/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,t,n){e.call(this,t,n);this.$selection.on(["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"].join(" "),function(e){e.stopPropagation()})},e}),o=function(u){function t(e){var t,n=e||window.event,i=g.call(arguments,1),o=0,s=0,r=0,a=0,l=0,c=0;if((e=u.event.fix(n)).type="mousewheel","detail"in n&&(r=-1*n.detail),"wheelDelta"in n&&(r=n.wheelDelta),"wheelDeltaY"in n&&(r=n.wheelDeltaY),"wheelDeltaX"in n&&(s=-1*n.wheelDeltaX),"axis"in n&&n.axis===n.HORIZONTAL_AXIS&&(s=-1*r,r=0),o=0===r?s:r,"deltaY"in n&&(o=r=-1*n.deltaY),"deltaX"in n&&(s=n.deltaX,0===r&&(o=-1*s)),0!==r||0!==s){1===n.deltaMode?(o*=t=u.data(this,"mousewheel-line-height"),r*=t,s*=t):2===n.deltaMode&&(o*=t=u.data(this,"mousewheel-page-height"),r*=t,s*=t);var a=Math.max(Math.abs(r),Math.abs(s));return f&&!(a<f)||p(n,f=a)&&(f/=40),p(n,a)&&(o/=40,s/=40,r/=40),o=Math[1<=o?"floor":"ceil"](o/f),s=Math[1<=s?"floor":"ceil"](s/f),r=Math[1<=r?"floor":"ceil"](r/f),m.settings.normalizeOffset&&this.getBoundingClientRect&&(a=this.getBoundingClientRect(),l=e.clientX-a.left,c=e.clientY-a.top),e.deltaX=s,e.deltaY=r,e.deltaFactor=f,e.offsetX=l,e.offsetY=c,e.deltaMode=0,i.unshift(e,o,s,r),h&&clearTimeout(h),h=setTimeout(d,200),(u.event.dispatch||u.event.handle).apply(this,i)}}function d(){f=null}function p(e,t){return m.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}var h,f,e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],n="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],g=Array.prototype.slice;if(u.event.fixHooks)for(var i=e.length;i;)u.event.fixHooks[e[--i]]=u.event.mouseHooks;var m=u.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var e=n.length;e;)this.addEventListener(n[--e],t,!1);else this.onmousewheel=t;u.data(this,"mousewheel-line-height",m.getLineHeight(this)),u.data(this,"mousewheel-page-height",m.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=n.length;e;)this.removeEventListener(n[--e],t,!1);else this.onmousewheel=null;u.removeData(this,"mousewheel-line-height"),u.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var t=u(e),e=t["offsetParent"in u.fn?"offsetParent":"parent"]();return e.length||(e=u("body")),parseInt(e.css("fontSize"),10)||parseInt(t.css("fontSize"),10)||16},getPageHeight:function(e){return u(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};u.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})},"function"==typeof e.define&&e.define.amd?e.define("jquery-mousewheel",["jquery"],o):"object"==typeof exports?module.exports=o:o(t),e.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults"],function(o,e,s,t){var r;return null==o.fn.mselect2&&(r=["open","close","destroy"],o.fn.mselect2=function(t){if("object"==typeof(t=t||{}))return this.each(function(){var e=o.extend(!0,{},t);new s(o(this),e)}),this;if("string"!=typeof t)throw new Error("Invalid arguments for Select2: "+t);var n,i=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=o(this).data("select2");null==e&&window.console&&console.error&&console.error("The select2('"+t+"') method was called on an element that is not using Select2."),n=e[t].apply(e,i)}),-1<o.inArray(t,r)?this:n}),null==o.fn.mselect2.defaults&&(o.fn.mselect2.defaults=t),s}),{define:e.define,require:e.require}),e=o.require("jquery.select2");function _(e,t){return r.call(e,t)}function c(e,t){var n,i,o,s,r,a,l,c,u,d,p=t&&t.split("/"),h=g.map,f=h&&h["*"]||{};if(e&&"."===e.charAt(0))if(t){for(t=(e=e.split("/")).length-1,g.nodeIdCompat&&m.test(e[t])&&(e[t]=e[t].replace(m,"")),e=p.slice(0,p.length-1).concat(e),c=0;c<e.length;c+=1)if("."===(d=e[c]))e.splice(c,1),--c;else if(".."===d){if(1===c&&(".."===e[2]||".."===e[0]))break;0<c&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((p||f)&&h){for(c=(n=e.split("/")).length;0<c;--c){if(i=n.slice(0,c).join("/"),p)for(u=p.length;0<u;--u)if(o=(o=h[p.slice(0,u).join("/")])&&o[i]){s=o,r=c;break}if(s)break;!a&&f&&f[i]&&(a=f[i],l=c)}!s&&a&&(s=a,r=l),s&&(n.splice(0,r,s),e=n.join("/"))}return e}function w(t,n){return function(){var e=a.call(arguments,0);return"string"!=typeof e[0]&&1===e.length&&e.push(null),s.apply(d,e.concat([t,n]))}}function b(e){var t;if(_(h,e)&&(t=h[e],delete h[e],f[e]=!0,l.apply(d,t)),!_(p,e)&&!_(f,e))throw new Error("No "+e);return p[e]}function u(e){var t,n=e?e.indexOf("!"):-1;return-1<n&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}return t.fn.mselect2.amd=o,e});